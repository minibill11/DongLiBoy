<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css">
<style>
    tr {
        height: 22px;
        font-size: 14px;
        text-align: center;
    }
    input {
        max-width: none;
    }
    td {
        border: 1px solid black;
    }
    .form-control {
        padding: 0;
    }
</style>
</head>

<body>
	
    <div id="save"></div>
    <table id="tableApp" style="margin:0 auto;border-collapse:collapse;table-layout:fixed;">
        <caption style="text-align: left">惠州市健和光电有限公司</caption>
        <colgroup>
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
        </colgroup>
        <thead>
            <tr>
                <td colspan="3" style="border-left: none;border-right: none;border-bottom:none;text-align:left" class="changeContent">物料编号：</td>
                <td colspan="6" style="border-left: none;border-right: none;border-bottom:none;text-align:left"><b style="font-size:28px">进料检验报告</b><b>--通用</b></td>
            </tr>
            <tr>
                <td colspan="9" style="border:none"><span style="float: left">物料需要符合RoHS、REACH要求：<input type="checkbox">是<input type="checkbox">否</span></td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td for="Provider">供应商</td>
                <td colspan="2" class="changeContent" id="Provider"></td>
                <td>物料名称</td>
                <td colspan="2" class="changeContent" id=""></td>
                <td>型号</td>
                <td colspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td>规格</td>
                <td colspan="2" class="changeContent" id=""></td>
                <td>来料数量</td>
                <td colspan="2" class="changeContent" id=""></td>
                <td>来料日期</td>
                <td colspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td>请购单号</td>
                <td colspan="2" class="changeContent" id=""></td>
                <td>批号</td>
                <td colspan="2" class="changeContent" id=""></td>
                <td>检验日期</td>
                <td colspan="2" class="changeContent" id=""></td>
            </tr>
            <tr style="height: 40px">
                <td>抽样方案</td>
                <td colspan="4"><input type="checkbox">全检 &nbsp;<input type="checkbox">加严 &nbsp;<input type="checkbox">正常 &nbsp;<input type="checkbox">放宽</td>
                <td colspan="2">承认书或图纸号/版本</td>
                <td colspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td rowspan="2">检验内容</td>
                <td rowspan="2">检验水平</td>
                <td rowspan="2">抽样数量</td>
                <td colspan="3">判定标准</td>
                <td colspan="3" rowspan="2">检验判定</td>
            </tr>
            <tr>
                <td>严重缺陷<br>AQL：0</td>
                <td>一般缺陷<br>AQL：0.4</td>
                <td>轻微缺陷<br>AQL：0.65</td>
            </tr>
            <tr>
                <td rowspan="2">标识</td>
                <td rowspan="2" class="changeContent" id=""></td>
                <td rowspan="2" class="changeContent" id=""></td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td colspan="3" rowspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>

            </tr>
            <tr>
                <td rowspan="2">包装、外观</td>
                <td rowspan="2" class="changeContent"></td>
                <td rowspan="2" class="changeContent"></td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td colspan="3" rowspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>

            </tr>
            <tr>
                <td rowspan="2">尺寸</td>
                <td rowspan="2" class="changeContent"></td>
                <td rowspan="2" class="changeContent"></td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td colspan="3" rowspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
            </tr>
            <tr>
                <td rowspan="2">性能/参数</td>
                <td rowspan="2" class="changeContent"></td>
                <td rowspan="2" class="changeContent"></td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">AC：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td colspan="3" rowspan="2" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
                <td>
                    <span style="width:30%;float:left">Re：</span>
                    <span style="width:70%;height:21px;float:left" class="changeContent" id=""></span>
                </td>
            </tr>
            <tr>
                <td>不良项目<br>(检测项目)</td>
                <td>规格要求</td>
                <td colspan="7">检验结果描述</td>
            </tr>
            <tr>
                <td id="AM0">尺寸</td>
                <td id="AM1">亮度 IV</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM11"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM12"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM13"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td id="AM0">我司实测值</td>
                <td id="AM1">亮度 IV</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM11"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM12"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM13"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" id="AM">我司测试条件R=G=B=8MA</td>
            </tr>
            <tr>
                <td id="AM0">我司实测值</td>
                <td id="AM1">亮度 IV</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM11"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM12"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM13"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" id="AM">我司测试条件R=G=B=8MA</td>
            </tr>
            <tr>
                <td id="AM0">我司实测值</td>
                <td id="AM1">亮度 IV</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM11"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM12"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM13"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td id="AM2">信率</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM21"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM22"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM23"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td id="AM3">波长 WD</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM31"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM32"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM33"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td id="AM4">电压 VF</td>
                <td colspan="2" style="border-right:none" class="changeContent" id="AM41"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM42"></td>
                <td colspan="2" style="border-left:none;border-right:none" class="changeContent" id="AM43"></td>
                <td style="border-left:none"></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>
            <tr>
                <td class="changeContent" id=""></td>
                <td class="changeContent" id=""></td>
                <td colspan="7" class="changeContent" id=""></td>
            </tr>            
            <tr>
                <td rowspan="3">总不良数</td>
                <td>严重缺陷</td>
                <td class="changeContent" id="NG1"></td>
                <td colspan="6" rowspan="3" id="NGD">最终判定：&nbsp;<input type="checkbox">允收（AC） &nbsp;<input type="checkbox">拒收（Re）</td>
            </tr>
            <tr>
                <td>一般缺陷</td>
                <td class="changeContent" id="NG2"></td>
            </tr>
            <tr>
                <td>轻微缺陷</td>
                <td class="changeContent" id="NG3"></td>
            </tr>

            <tr>
                <td colspan="9" id="NGHandle">不合格批处理：&nbsp;&nbsp;<input type="checkbox">退货； &nbsp;&nbsp;<input type="checkbox">挑选； &nbsp;&nbsp;<input type="checkbox">特采； &nbsp;&nbsp;<input type="checkbox">维修； &nbsp;&nbsp;<input type="checkbox">其他； </td>
            </tr>
            <tr style="text-align: left;height: 40px">
                <td style="text-align:right;border-right: none">备注：</td>
                <td colspan="8" style="border-left:none" class="changeContent" id="ReportRemark"></td>
            </tr>
            <tr style="text-align: left;">
                <td style="text-align:right;border-right: none">批准：</td>
                <td colspan="2" style="border-left: none;border-right: none" class="changeContent" id="Approve"></td>
                <td style="text-align:right;border-left: none;border-right: none">审核：</td>
                <td colspan="2" style="border-left: none;border-right: none" class="changeContent" id="Assessor"></td>
                <td style="text-align:right;border-left: none;border-right: none">检验：</td>
                <td colspan="2" style="border-left: none" class="changeContent" id="Inspector"></td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="9" style="text-align: right;border: none">表单编号：QD-007-B</td>
            </tr>
        </tfoot>
    </table>
    
    <div>
        <a id="print-click">导出表格</a>
        <input type="button" onclick="printout()" value="打印">
    </div>


<script>
    // 使用outerHTML属性获取整个table元素的HTML代码（包括<table>标签），然后包装成一个完整的HTML文档，设置charset为urf-8以防止中文乱码
    var html = "<html><head><meta charset='utf-8' /></head><body>" + document.getElementById("tableApp").outerHTML + "</body></html>";
    // 实例化一个Blob对象，其构造函数的第一个参数是包含文件内容的数组，第二个参数是包含文件类型属性的对象
    var blob = new Blob([html], {
        type: "application/vnd.ms-excel"
    });
    var a = document.getElementById("print-click");
    // 利用URL.createObjectURL()方法为a元素生成blob URL
    a.href = URL.createObjectURL(blob);
    // 设置文件名，目前只有Chrome和FireFox支持此属性
    a.download = "检验报告.xls";

    //打印具体实现代码
    function printout() {
        debugger;
        var newWindow;
        //打开一个新的窗口
        newWindow = window.open();
        // 是新窗口获得焦点
        newWindow.focus();
        //保存写入内容
        var newContent = "<html><head><meta charset='utf-8'/><title>打印</title></head><body>"
        newContent += document.getElementById("tableApp").outerHTML;
        newContent += "</body></html>"
        // 将HTML代码写入新窗口中
        newWindow.document.write(newContent);
        newWindow.print();
        // close layout stream
        newWindow.document.close();
        //关闭打开的临时窗口
        newWindow.close();
        return false;
    };


    $(document).ready(function() {
        $(".changeContent").each(function(){
            $(this).click(function () {
                //$(this).dblclick(function(){
                var inputTD=$(this);
                //var inputParent=$(this).parents("tr");
                console.log(inputTD);
                var tdInputId=$(this).attr("id");
                //inputParent.css("backgroundColor","yellow");
                console.log(tdInputId);

                if(inputTD.children("input").length>0){
                    return false;
                }

                var inputIns = $("<input id=\"" + tdInputId + "\" name=\"" + tdInputId + "\" class=\"form-control text-box single-line\" style=\"text-align:center\"  type=\"text\">"); //需要插入的输入框代码
                inputIns.width(inputTD[0].clientWidth-2);//设置input与td宽度一致
                inputIns.height(inputTD[0].clientHeight-2);
                inputIns.val(inputTD.html());//将本来单元格td内容copy到插入的文本框input中

                inputTD.html(""); //删除原来单元格td内容
                inputIns.appendTo(inputTD).focus().select(); //将需要插入的输入框代码插入dom节点中

                inputIns.click(function(){
                    return false;
                });

                //处理Enter和Esc事件
                inputIns.blur(function(){
                    inputTD.html($(this).val());
                    //inputIns.attr('type', 'hidden').appendTo($("#save"));
                    $("input[id="+tdInputId+"]").remove();
                    inputIns.appendTo($("#save"));

                    //inputParent.css("background-color","white");
                    //alert(tdInputId);
                    //$.ajax({
                    //    type:"post",
                    //    url:"/KongYaHT/KongYa/HTChartsLeft",
                    //    data:{
                    //        "loginName":inputTD.html(),
                    //        "id":tdInputId
                    //    },
                    //    success:function(data){
                    //        alert(data);
                    //    },
                    //    error : function() {
                    //        //alert("通讯有问题,请稍候刷新...");
                    //    }
                    //});
                });
                inputIns.keydown(function (e) {
                    if(e.keyCode=='13'){
                        inputTD.html($(this).val());
                        inputIns.attr('type', 'hidden').appendTo($("#save"));
                        $.ajax({
                            type:"post",
                            url: "/IQCReports/ajaxForm",
                            data:{
                                "content":inputTD.html(),
                                "id":tdInputId
                            },
                            success:function(data){
                                alert(data);
                            },
                            error : function() {
                                //alert("通讯有问题,请稍候刷新...");
                            }
                        });
                    }
                })
            });
        });
    });

</script>
</body>
</html>