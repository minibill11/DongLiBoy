
@{
    ViewBag.Title = "设备点检记录";
    Layout = "~/Views/Shared/_Layout2.cshtml";
}

@* css放置处 *@
@section cssStyle {
    <link rel="stylesheet/less" type="text/css" href="~/Content/Equipment/equipment_index.less" />
    <style>
        .check-box {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 14px;
            font-size: 14px;
        }

        .check-item-box {
            display: flex;
            align-items: center;
        }

        .check-box-item {
            margin-right: 35px;
            display: flex;
            align-items: center;
        }

            .check-box-item span {
                font-weight: bold;
            }

/*        表格*/
        table tr th, table tr td {
            text-align: center;
        }

        .bottomcontainer {

        }
        .changeSize > td {
            font-size: 11px;
            text-align: inherit;
        }

        .color {
            color: red;
        }

        table tbody tr td {
            height: 23px;
        }

        .green {
            color: blue;
        }

        .red {
            color: red;
        }

        .el-upload__input {
            display: none !important;
        }

        .upload-demo {
            margin-left: 15px;
        }

        .huise {
            background-color: #e3e3e3;
        }

        .point {
            cursor: pointer;
        }
    </style>
}
<el-container id="app" v-cloak>
    <el-header class="text-center">
        <div class="eq-title">设备点检保养记录表</div>
    </el-header>
    <el-main class="main-box">
        @* 筛选框s *@
        <div class="check-box">
            <div class="check-item-box">
                <div class="check-box-item">
                    <span>设备名称：</span>{{EquipmentName}}
                </div>
                <div class="check-box-item">
                    <span>部门：</span>{{UserDepartment}}
                </div>
                <div class="check-box-item">
                    <span>线别：</span>{{LineNum}}
                </div>
                <div class="check-box-item">
                    <span>设备编号：</span>{{EquipmentNumber}}
                </div>
                <div class="check-box-item">
                    <span>时间：</span>
                    <el-date-picker v-model="select_date"
                                    disabled
                                    size="mini"
                                    type="month"
                                    style="width:130px;"
                                    placeholder="选择年月">
                    </el-date-picker>
                </div>
            </div>
            <el-button size="mini" type="primary" plain>查看对应月保养</el-button>
        </div>
        @*表格*@
        <div class="bottomcontainer">
            <table style="width:100%" border="1">
                <thead>
                    <tr>
                        <th style="width:28px" rowspan="2">
                            周期
                        </th>
                        <th style="width:248px" rowspan="2">
                            项目
                        </th>
                        <th style="width:300px" rowspan="2">
                            操作方法
                        </th>
                        <th colspan="31">
                            日期
                        </th>
                    </tr>
                    <tr>
                        <th v-on:click="checkAllDay(i)" v-for="i in 31" v-bind:class="todayNum==i?'point':'huise'" style="width:28px">{{i}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td v-bind:rowspan="dailyPlan.length + 3">日保养</td>
                    </tr>
                    <tr class="changeSize" v-for="(item,index) in dailyPlan">
                        <td @@click.stop.prevent="editText($event,item,index,'dailyPlan','Dproject')">{{item.Dproject}}</td>
                        <td @@click.stop.prevent="editText($event,item,index,'dailyPlan','DOpera')">{{item.DOpera}}</td>
                        <td v-for="i in 31">
                            <select v-model="item[`Day${i}`]" 
                                    v-bind:disabled="todayNum==i && (totalOnfos[`Day_Mainte_${i}`]==''||totalOnfos[`Day_Mainte_${i}`]==null)?false:true" 
                                    class="testSelect" 
                                    v-bind:class="todayNum==i && (totalOnfos[`Day_Mainte_${i}`]==''||totalOnfos[`Day_Mainte_${i}`]==null)?'point':'huise'">
                                @*<option></option>*@
                                <option>√</option>
                                <option>×</option>
                                <option>/</option>
                            </select>
                        </td>
                    </tr>
                    <tr class="changeSize">
                        <td style="text-align:center;font-size:14px;" colspan="2">
                            保养人
                        </td>
                        <td v-for="i in 31" v-on:click="dayCheck(i)" v-text="totalOnfos[`Day_Mainte_${i}`]!=''?totalOnfos[`Day_Mainte_${i}`]:'待审'" v-bind:class="totalOnfos[`Day_Mainte_${i}`]!=''?'green':'red'"></td>
                    </tr>
                    <tr class="changeSize">
                        <td style="text-align:center;font-size:14px;" colspan="2">
                            组长确认
                        </td>
                        <td v-for="i in 31" v-on:click="dayGroupComfirm(i)" v-text="totalOnfos[`Day_group_${i}`]!=''?totalOnfos[`Day_group_${i}`]:'待审'" v-bind:class="totalOnfos[`Day_group_${i}`]!=''?'green':'red'"></td>
                    </tr>


                    <tr>
                        <td v-bind:rowspan="weekPlan.length + 3">周保养</td>
                    </tr>
                    <tr class="changeSize" v-for="(item,index) in weekPlan">
                        <td @@click.stop.prevent="editText($event,item,index,'weekPlan','weekObject')">{{item.weekObject}}</td>
                        <td @@click.stop.prevent="editText($event,item,index,'weekPlan','weekOpera')">{{item.weekOpera}}</td>
                        <td v-show="index==0?true:false" colspan="8" style="text-align:center;" v-on:click="weekContentOpera('weekone','weekProveOne')" v-bind:rowspan="weekPlan.length">{{item.weekProveOne}}</td>
                        <td v-show="index==0?true:false" colspan="8" style="text-align:center;" v-on:click="weekContentOpera('weektwo','weekProveTwo')" v-bind:rowspan="weekPlan.length">{{item.weekProveTwo}}</td>
                        <td v-show="index==0?true:false" colspan="8" style="text-align:center;" v-on:click="weekContentOpera('weekthree','weekProveThree')" v-bind:rowspan="weekPlan.length">{{item.weekProveThree}}</td>
                        <td v-show="index==0?true:false" colspan="7" style="text-align:center;" v-on:click="weekContentOpera('weekfour','weekProveFour')" v-bind:rowspan="weekPlan.length">{{item.weekProveFour}}</td>
                    </tr>
                    <tr>
                        <td colspan="2">保养人</td>
                        <td colspan="8" v-on:click="weekComfirm('weekone')">{{totalOnfos.Week_Main_1}}</td>
                        <td colspan="8" v-on:click="weekComfirm('weektwo')">{{totalOnfos.Week_Main_2}}</td>
                        <td colspan="8" v-on:click="weekComfirm('weekthree')">{{totalOnfos.Week_Main_3}}</td>
                        <td colspan="7" v-on:click="weekComfirm('weekfour')">{{totalOnfos.Week_Main_4}}</td>
                    </tr>
                    <tr>
                        <td colspan="2">工程师确认</td>
                        <td colspan="8" v-on:click="weekMEComfirm('weekone')">{{totalOnfos.Week_engineer_1}}</td>
                        <td colspan="8" v-on:click="weekMEComfirm('weektwo')">{{totalOnfos.Week_engineer_2}}</td>
                        <td colspan="8" v-on:click="weekMEComfirm('weekthree')">{{totalOnfos.Week_engineer_3}}</td>
                        <td colspan="7" v-on:click="weekMEComfirm('weekfour')">{{totalOnfos.Week_engineer_4}}</td>
                    </tr>

                    <tr>
                        <td v-bind:rowspan="monthPlan.length + 4">月保养</td>
                    </tr>
                    <tr class="changeSize" v-for="(item,index) in monthPlan">
                        <td @@click.stop.prevent="editText($event,item,index,'monthPlan','monthObject')">{{item.monthObject}}</td>
                        <td @@click.stop.prevent="editText($event,item,index,'monthPlan','monthOpera')">{{item.monthOpera}}</td>
                        <td v-on:click="monthContentOpera(item.monthObject,index,'dataNum')" style="text-align:center;font-size:14px;" colspan="31">{{item.dataNum}}</td>
                    </tr>
                    <tr>
                        <td colspan="2">保养人</td>
                        <td colspan="31" v-on:click="monthWorkerConfirm()">{{totalOnfos.Month_main_1}}</td>
                    </tr>
                    <tr>
                        <td colspan="2">生产确认</td>
                        <td colspan="31" v-on:click="monthGroupConfirm()">{{totalOnfos.Month_productin_2}}</td>
                    </tr>
                    <tr>
                        <td colspan="2">部长确认</td>
                        <td colspan="31" v-on:click="monthDeparConfirm()">{{totalOnfos.Month_minister_3}}</td>
                    </tr>


                    <tr>
                        <td rowspan="4">说明</td>
                        <td style="text-align:left" colspan="33">1.完成情况标记符号：“√”正常已完成  “×”异常、待处理  “/”休息及计划停机中.以上保养项目必须切实执行并如实记录.</td>
                    </tr>
                    <tr>
                        <td style="text-align:left" colspan="33">2.其中日保养由生产操作员执行,生产组长监督执行结果.周保养项目由设备技术员执行,设备工程师监督执行结果.月保养由设备工程师主导，设备技术员配合完成.</td>
                    </tr>
                    <tr>
                        <td style="text-align:left" colspan="33">3.每天早上9点之前完成日保养，周六、日做周保养，月保养根据月保养计划表执行.</td>
                    </tr>
                    <tr>
                        <td style="text-align:left" colspan="33">4.如有更换配件请注明配件名称和配件编号</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </el-main>
</el-container>
@* 分部页放置处 *@
@section renderPage {
}
@* js放置处 *@
@section jsScript {
    <script>
        const app = {
            data: {
                select_date: '',
                //设备信息
                EquipmentName: '',   //设备名称
                UserDepartment: '',  //部门
                EquipmentNumber: '',  //设备编号
                LineNum: '',   //线别
                //表格
                todayNum: '',
                totalOnfos:'',
                dailyPlan: [],
                weekPlan: [],
                monthPlan: [],
            },
            mounted() {
                //获取地址传参
                this.EquipmentNumber = getUrlParam('num');
                this.select_date = new Date(getUrlParam('date'));
                console.log(this.EquipmentNumber);
                this.getMachineInfos(getUrlParam('num'));
                // 页面加载时获取点检表的数据
                this.getDefultInfos();
            },
            watch: {

            },
            methods: {
                // 根据设备编号获取设备信息
                getMachineInfos() {
                    axios.post("/Equipment/Particulars", { equipmentNumber: this.EquipmentNumber }).then(res => {
                        console.log(res.data)
                        this.EquipmentName = res.data[0].EquipmentName;
                        this.UserDepartment = res.data[0].UserDepartment;
                        this.LineNum = res.data[0].LineNum;
                    })
                },
                // 页面加载时获取点检表的数据
                getDefultInfos() {
                    let dd = new Date(this.select_date);
                    let year = dd.getFullYear();
                    let month = dd.getMonth() + 1;
                    axios.post("/Equipment/Equipment_Query_Tally", { equipmentNumber: this.EquipmentNumber, year:year, month:month }).then(res => {
                        console.log(res.data,00)
                        if (JSON.stringify(res.data) != '{}') {
                            this.dailyPlan = []
                            this.weekPlan = []
                            this.monthPlan = []
                            this.totalOnfos = res.data
                            this.UserDepartment = res.data["UserDepartment"]
                            this.EquipmentName = res.data.EquipmentName
                            this.lineName = res.data.LineName

                            // 获取每段数据的行数
                            let dailyTrNums = this.reverseData(res.data, "Day_project"); // 返回正确的次数--以确定for的行数
                            let weekTrNums = this.reverseData(res.data, "Week_Check");
                            let monthTrNums = this.reverseData(res.data, "Month_Project");
                            console.log(dailyTrNums + "---" + weekTrNums + '------' + monthTrNums)
                            // 处理上数据
                            this.makeDataCanUes(res.data, "Day_project", dailyTrNums, this.dailyPlan,555);
                            this.changeSelectView(this.dailyPlan);
                            // 处理中数据
                            this.makeDataCanUes(res.data, "Week_Check", weekTrNums, this.weekPlan)
                            // 处理下数据
                            this.makeDataCanUes(res.data, "Month_Project", monthTrNums, this.monthPlan)
                            console.log(this.dailyPlan);
                        } else {
                            this.$message({
                                message: "此时间段暂无点检记录",
                                type: "warning"
                            });
                        }
                    }).catch(err => {
                        this.$message({
                            message: "获取点检表信息失败",
                            type: "warning"
                        })
                    })
                },
                // 日保养确认
                checkAllDay(index) {
                    if (this.todayNum != index) {
                        return false;
                    };
                    //console.log(index)
                    let dd = `Day${index}`
                    this.dailyPlan.forEach(item => {
                        if (item[dd] == "√") {
                            item[dd] = " "
                        } else if (item[dd] = " ") {
                            item[dd] = "√"
                        }

                    });
                    this.addSave();

                }
            },
            // 返回特定数据的行数
            reverseData(dataObj, kw) {
                let kwArr = [];
                let count = 0;
                for (let key in dataObj) {
                    kwArr.push(key);
                };
                kwArr.forEach(item => {
                    if (item.indexOf(kw) != -1) {
                        count++
                    }
                });
                return count
            },
            // 重组数据--新增过滤空数据功能
            makeDataCanUes(dataObj, kw, nums, containerArr) {
                if (kw == "Day_project") {
                    let arr = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L'];
                    let arrs = []
                    for (let i = 1; i <= nums; i++) {
                        let keyleft = `Day_project${i}`
                        let dailyOpera = `Day_opera${i}`
                        let baoyangTime = `Day_MainteTime_${i}`
                        let obj = { Dproject: dataObj[keyleft], DOpera: dataObj[dailyOpera], baoyangTime: dataObj[baoyangTime] }; // 添加操作时间
                        let works = arr[i - 1]
                        for (let j = 1; j < 32; j++) {
                            let ketright = `Day_${works}_${j}`
                            let Days = `Day${j}`;
                            obj[Days] = dataObj[ketright];
                        };
                        if (dataObj[keyleft] == "" || dataObj[keyleft] == null) {
                        } else {
                            containerArr.push(obj);
                        }

                    };
                    //console.log(containerArr)
                } else if (kw == "Week_Check") {
                    for (let i = 1; i <= nums; i++) {
                        let keyLeft = `Week_Check${i}`;
                        let ketLeftTwo = `Week_Inspe${i}`;
                        let obj = {
                            weekObject: dataObj[keyLeft],
                            weekOpera: dataObj[ketLeftTwo],
                            weekProveOne: dataObj.Week_1,
                            weekProveTwo: dataObj.Week_2,
                            weekProveThree: dataObj.Week_3,
                            weekProveFour: dataObj.Week_4
                        };
                        if (dataObj[keyLeft] == "" || dataObj[keyLeft] == null) {
                        } else {
                            containerArr.push(obj);
                        }
                    };
                } else {
                    for (let i = 1; i <= nums; i++) {
                        let keyLeft = `Month_Project${i}`;
                        let keyLeftTwo = `Month_Approach${i}`;
                        let dataKey = `Month_${i}`;
                        let obj = { monthObject: dataObj[keyLeft], monthOpera: dataObj[keyLeftTwo], dataNum: dataObj[dataKey] }
                        if (dataObj[keyLeft] == "" || dataObj[keyLeft] == null) {
                        } else {
                            containerArr.push(obj);
                        }
                    }
                }

            },
            //编辑
            editText(e, item, index, name, text) {
                //console.log(e, item, index, name, text);
                if (this.adddianjian && e.target.localName == 'td') {
                    e.target.innerHTML = `<input id='inputText' style="width:100%;height:40px;" onkeyup="app.keyupText(${index},'${name}','${text}')" onBlur="app.blurText(${index},'${name}','${text}')" value="${item[text]}" />`;
                    let _thisinput = document.getElementById('inputText');
                    _thisinput.focus();
                    _thisinput.selectionStart = _thisinput.selectionEnd = _thisinput.value.length;
                };
                //`<textarea value='${text}' style='width:100%;height:40px;'>${text}</textarea>`
            },
            //编辑失焦
            blurText(index, name, text) {
                //console.log(index, name, text, event);
                this[name][index][text] = event.target.value;
                event.target.outerHTML = event.target.value;
            },
            //编辑回车
            keyupText(index, name, text) {
                //console.log(index, name, text, event);
                if (event.keyCode == 13) {
                    this[name][index][text] = event.target.value;
                    event.target.outerHTML = event.target.value;
                };
            },
            // 日计划保养人审批---需要判断
            dayCheck(index) {
                //this.checkAllDay(index)
                this.byTimeIndex = index
                let day = `Day${index}`
                let flag = true
                let dataindex = `Day_Mainte_${index}`;
                this.timeFlagForDaily = true;
                if (flag) {
                    if (this.totalOnfos[dataindex] == '' || this.totalOnfos[dataindex] == null) {
                        if (checkRoles(roles, '日保养人确认')) {
                            this.showComfirmDialog = true;
                            this.kw = dataindex;
                            this.chiosingDayIndex = index;
                        } else {
                            this.$notify({
                                message: "无权限进行此操作",
                                type: "warning"
                            })
                        }
                    } else {
                        this.$notify({
                            message: "已审批，不可重复操作",
                            type: "warning"
                        })
                    }
                } else {
                    this.$notify({
                        message: "有未确认保养设备，不可审批",
                        type: "warning"
                    })
                }

            },
            // 日计划组长确认
            dayGroupComfirm(index) {
                let repiamanComfirm = `Day_Mainte_${index}`
                let groupComfirm = `Day_group_${index}`
                this.groupComfirmTimeIndex = index;
                this.timeFlagForDaily = false;
                //this.totalOnfos[repiamanComfirm] != '' &&
                if (this.totalOnfos[groupComfirm] == '') {
                    if (checkRoles(roles, '日保养组长确认')) {
                        this.kw = groupComfirm
                        this.showComfirmDialog = true;
                    } else {
                        this.$notify({
                            message: "无权限进行此操作",
                            type: "warning"
                        })
                    }
                } else {
                    this.$notify({
                        message: "保养人未确认或组长已审核,不可操作",
                        type: "warning"
                    })
                }
                //alert(`第${index}天组长确认`)
            },
            // 周保养计划内容
            weekContentOpera(kw, datakw) {
                this.kwforweek = kw;
                this.kwdataforweek = datakw;
                this.showWeekComfirmDialog = true;
            },
            // 周计划保养内容-----2
            weekComfirms() {
                if (this.kwforweek == "weekone") {
                    if (this.totalOnfos.Week_Main_1 == '' || this.totalOnfos.Week_Main_1 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;

                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }

                } else if (this.kwforweek == "weektwo") {
                    if (this.totalOnfos.Week_Main_2 == '' || this.totalOnfos.Week_Main_2 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;
                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }
                } else if (this.kwforweek == "weekthree") {
                    if (this.totalOnfos.Week_Main_3 == '' || this.totalOnfos.Week_Main_3 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;
                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }
                } else {
                    if (this.totalOnfos.Week_Main_4 == '' || this.totalOnfos.Week_Main_4 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;
                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }
                }

            },
            // 周计划保养内容-----2
            weekComfirms() {
                if (this.kwforweek == "weekone") {
                    if (this.totalOnfos.Week_Main_1 == '' || this.totalOnfos.Week_Main_1 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;

                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }

                } else if (this.kwforweek == "weektwo") {
                    if (this.totalOnfos.Week_Main_2 == '' || this.totalOnfos.Week_Main_2 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;
                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }
                } else if (this.kwforweek == "weekthree") {
                    if (this.totalOnfos.Week_Main_3 == '' || this.totalOnfos.Week_Main_3 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;
                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }
                } else {
                    if (this.totalOnfos.Week_Main_4 == '' || this.totalOnfos.Week_Main_4 == null) {
                        if (this.weekComfirmContent == '' || this.weekComfirmContent == null) {
                            this.$notify({
                                message: "无对应内容，此次修改无效",
                                type: "warning"
                            })
                        } else {
                            this.weekPlan[0][this.kwdataforweek] = this.weekComfirmContent;
                            this.addSave();
                            this.showWeekComfirmDialog = false;
                        }
                    } else {
                        this.$notify({
                            message: "已审核，不可重复操作",
                            type: "warning"
                        })
                    }
                }

            },
            // 周保养人确认
            weekComfirm(kw) {
                if (kw == "weekone") {
                    //this.weekPlan[0].weekProveOne != '' && this.weekPlan[0].weekProveOne != null
                    if (true) {
                        if (this.totalOnfos.Week_Main_1 == '' || this.totalOnfos.Week_Main_1 == null) {
                            if (checkRoles(roles, '周保养人确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_Main_1 = this.UserName;
                                    this.totalOnfos.Week_MainTime_1 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有内容，不可重复操作",
                                type: "warning"
                            })
                        }
                    } else {
                        this.$notify({
                            message: "请先完善前面的内容",
                            type: "warning"
                        })
                    }

                } else if (kw == "weektwo") {
                    //this.weekPlan[0].weekProveTwo != '' && this.weekPlan[0].weekProveTwo != null
                    if (true) {
                        if (this.totalOnfos.Week_Main_2 == '' || this.totalOnfos.Week_Main_2 == null) {
                            if (checkRoles(roles, '周保养人确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_Main_2 = this.UserName;
                                    this.totalOnfos.Week_MainTime_2 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有内容，不可重复操作",
                                type: "warning"
                            })
                        }
                    } else {
                        this.$notify({
                            message: "请先完善前面的内容",
                            type: "warning"
                        })
                    }
                } else if (kw == "weekthree") {
                    //this.weekPlan[0].weekProveThree != '' && this.weekPlan[0].weekProveThree != null
                    if (true) {
                        if (this.totalOnfos.Week_Main_3 == '' || this.totalOnfos.Week_Main_3 == null) {
                            if (checkRoles(roles, '周保养人确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_Main_3 = this.UserName;
                                    this.totalOnfos.Week_MainTime_3 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有内容，不可重复操作",
                                type: "warning"
                            })
                        }
                    } else {
                        this.$notify({
                            message: "请先完善前面的内容",
                            type: "warning"
                        })
                    }
                } else {
                    //this.weekPlan[0].weekProveFour != '' && this.weekPlan[0].weekProveFour != null
                    if (true) {
                        if (this.totalOnfos.Week_Main_4 == '' || this.totalOnfos.Week_Main_4 == null) {
                            if (checkRoles(roles, '周保养人确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_Main_4 = this.UserName;
                                    this.totalOnfos.Week_MainTime_4 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有内容，不可重复操作",
                                type: "warning"
                            })
                        }
                    } else {
                        this.$notify({
                            message: "请先完善前面的内容",
                            type: "warning"
                        })
                    }
                }
            },
            // 周保养工程师确认
            weekMEComfirm(kw) {
                if (kw == "weekone") {
                    //this.totalOnfos.Week_Main_1 == '' || this.totalOnfos.Week_Main_1==null
                    if (false) {
                        this.$notify({
                            message: "周保养人未确认",
                            type: "warning"
                        })
                    } else {
                        if (this.totalOnfos.Week_engineer_1 == '' || this.totalOnfos.Week_engineer_1 == null) {
                            if (checkRoles(roles, '周保养工程师确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_engineer_1 = this.UserName;
                                    this.totalOnfos.Week_engTime_1 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有数据，不可重复操作",
                                type: "warning"
                            })
                        }
                    }
                } else if (kw == "weektwo") {
                    //this.totalOnfos.Week_Main_2 == '' || this.totalOnfos.Week_Main_2 == null
                    if (false) {
                        this.$notify({
                            message: "周保养人未确认",
                            type: "warning"
                        })
                    } else {
                        if (this.totalOnfos.Week_engineer_2 == '' || this.totalOnfos.Week_engineer_2 == null) {
                            if (checkRoles(roles, '周保养工程师确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_engineer_2 = this.UserName;
                                    this.totalOnfos.Week_engTime_2 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有数据，不可重复操作",
                                type: "warning"
                            })
                        }
                    }
                } else if (kw == "weekthree") {
                    //this.totalOnfos.Week_Main_3 == '' || this.totalOnfos.Week_Main_3 == null
                    if (false) {
                        this.$notify({
                            message: "周保养人未确认",
                            type: "warning"
                        })
                    } else {
                        if (this.totalOnfos.Week_engineer_3 == '' || this.totalOnfos.Week_engineer_3 == null) {
                            if (checkRoles(roles, '周保养工程师确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_engineer_3 = this.UserName;
                                    this.totalOnfos.Week_engTime_3 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有数据，不可重复操作",
                                type: "warning"
                            })
                        }
                    }
                } else {
                    //this.totalOnfos.Week_Main_4 == '' || this.totalOnfos.Week_Main_4 == null
                    if (false) {
                        this.$notify({
                            message: "周保养人未确认",
                            type: "warning"
                        })
                    } else {
                        if (this.totalOnfos.Week_engineer_4 == '' || this.totalOnfos.Week_engineer_4 == null) {
                            if (checkRoles(roles, '周保养工程师确认')) {
                                let comfirm = confirm("确认保养情况")
                                if (comfirm) {
                                    this.totalOnfos.Week_engineer_4 = this.UserName;
                                    this.totalOnfos.Week_engTime_4 = new Date();
                                    this.addSave();
                                }
                            } else {
                                this.$notify({
                                    message: "无操作权限",
                                    type: "warning"
                                })
                            }
                        } else {
                            this.$notify({
                                message: "已有数据，不可重复操作",
                                type: "warning"
                            })
                        }
                    }
                }
            },
            // 月保养计划内容确认
            monthContentOpera(item, index, kw) {
                //this.totalOnfos.Week_engineer_4 != '' && this.totalOnfos.Week_engineer_4 != null
                if (true) {
                    if (this.monthPlan[index][kw] == null || this.monthPlan[index][kw] == '') {
                        let val = prompt("请输入内容")
                        this.monthPlan[index][kw] = val;
                        this.addSave();
                    } else {
                        this.$notify({
                            message: "已有数据，不可重复操作",
                            type: "warning"
                        })
                    }
                } else {
                    this.$notify({
                        message: "周项目确认未完善，不可操作",
                        type: "warning"
                    })
                }
            },
            // 月保养人确认
            monthWorkerConfirm() {
                //this.monthPlan[this.monthPlan.length - 1].dataNum != '' && this.monthPlan[this.monthPlan.length - 1].dataNum != null
                if (true) {
                    if (this.totalOnfos.Month_main_1 != '' && this.totalOnfos.Month_main_1 != null) {
                        this.$notify({
                            message: "已确认，不可重复操作",
                            type: "warning"
                        })
                    } else {
                        if (checkRoles(roles, '月保养人确认')) {
                            let comfirm = confirm("确认月保养项目情况");
                            if (comfirm) {
                                this.totalOnfos.Month_main_1 = this.UserName;
                                this.totalOnfos.Month_mainTime_1 = new Date;
                                this.addSave();
                            }
                        } else {
                            this.$notify({
                                message: "无操作权限",
                                type: "warning"
                            })
                        }
                    }
                } else {
                    this.$notify({
                        message: "月计划保养项目未填写完整,不可操作",
                        type: "warning"
                    })
                }
            },
            // 月生产确认
            monthGroupConfirm() {
                //this.totalOnfos.Month_main_1 != '' && this.totalOnfos.Month_main_1 != null
                if (true) {
                    if (this.totalOnfos.Month_productin_2 != '' && this.totalOnfos.Month_productin_2 != null) {
                        this.$notify({
                            message: "不可重复操作",
                            type: "warning"
                        })
                    } else {
                        if (checkRoles(roles, '月保养生产确认')) {
                            let comfirm = confirm("确认月保养项目情况");
                            if (comfirm) {
                                this.totalOnfos.Month_productin_2 = this.UserName;
                                this.totalOnfos.Month_produTime_2 = new Date();
                                this.addSave();
                            }
                        } else {
                            this.$notify({
                                message: "无操作权限",
                                type: "warning"
                            })
                        }
                    }
                } else {
                    this.$notify({
                        message: "保养人未确认",
                        type: "warning"
                    })
                }
            },
            // 月部长确认
            monthDeparConfirm() {
                //this.totalOnfos.Month_productin_2 != '' && this.totalOnfos.Month_productin_2 != null
                if (true) {
                    if (this.totalOnfos.Month_minister_3 != '' && this.totalOnfos.Month_minister_3 != null) {
                        this.$notify({
                            message: "不可重复操作",
                            type: "warning"
                        })
                    } else {
                        if (checkRoles(roles, '月保养部长确认')) {
                            let comfirm = confirm("确认月保养项目情况");
                            if (comfirm) {
                                this.totalOnfos.Month_minister_3 = this.UserName;
                                this.totalOnfos.Month_minisime_3 = new Date();
                                this.addSave();
                            }
                        } else {
                            this.$notify({
                                message: "无操作权限",
                                type: "warning"
                            })
                        }
                    }
                } else {
                    this.$notify({
                        message: "生产未确认",
                        type: "warning"
                    })
                }
            },
        }
        // 解析地址栏参数
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]); return '';
        }
    </script>
}