
<script type="text/template" id="KPI_Efficiency_Daily_Component">
    <div class="KPI_Efficiency_Daily">
        <h1>效率指标日报表</h1>
        <el-select v-model="department"
                   placeholder="请选择部门">
            <el-option v-for="item in departmentlist"
                       :key="item.value"
                       :label="item.value"
                       :value="item.value">
            </el-option>
        </el-select>
        <el-select v-model="group"
                   placeholder="请选择班组">
            <el-option v-for="item in grouplist"
                       :key="item.value"
                       :label="item.value"
                       :value="item.value">
            </el-option>
        </el-select>
        <el-date-picker v-model="monthDate"
                        placeholder="选择月"
                        type="month">
        </el-date-picker>
        <el-button type="primary" @@click="onQuerySubmit">查询</el-button>
        <el-button type="primary" @@click="onQuerySubmit" plain>录入数据</el-button>
        <el-button type="success" @@click="onQuerySubmit" plain>导出EXCEL表</el-button>


        <el-table :data="Table.dcl"
                  max-height="600"
                  size="medium"
                  stripe
                  border>
            <el-table-column type="index" label="序号"></el-table-column>
            <el-table-column prop="" label="部门"></el-table-column>
            <el-table-column prop="" label="班组"></el-table-column>
            <el-table-column prop="" label="考核指标名称"></el-table-column>
            <el-table-column prop="" label="目标值"></el-table-column>
            <el-table-column prop="" label="数据来源"></el-table-column>
            <el-table-column prop="" label="达成率（实际产量/计划产量）">
                <el-table-column v-for="(i,index) in Table.dcl[0].ActualValue.length" prop="" :label="index+'日'">{{i}}</el-table-column>
            </el-table-column>
            <el-table-column prop="" label="月达成率（月实际产量/月计划产量）"></el-table-column>
            <el-table-column prop="" label="实际得分"></el-table-column>
            <el-table-column prop="" label="与目标值差异"></el-table-column>
            <el-table-column prop="" label="得分小计"></el-table-column>
        </el-table>
        <el-table :data="Table.jsl"
                  max-height="600"
                  size="medium"
                  stripe
                  border>
            <el-table-column type="index" label="序号"></el-table-column>
            <el-table-column prop="" label="部门"></el-table-column>
            <el-table-column prop="" label="班组"></el-table-column>
            <el-table-column prop="" label="考核指标名称"></el-table-column>
            <el-table-column prop="" label="目标值"></el-table-column>
            <el-table-column prop="" label="数据来源"></el-table-column>
            <el-table-column prop="" label="及时率（及时检验批次/总检验批次）">
                <el-table-column v-for="i in 30" prop="" :label="i+'日'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="月及时率（月及时检验批次/月总检验批次）"></el-table-column>
            <el-table-column prop="" label="实际得分"></el-table-column>
            <el-table-column prop="" label="与目标值差异"></el-table-column>
            <el-table-column prop="" label="得分小计"></el-table-column>
        </el-table>
        <el-table :data="Table.shcs"
                  max-height="600"
                  size="medium"
                  stripe
                  border>
            <el-table-column type="index" label="序号"></el-table-column>
            <el-table-column prop="" label="部门"></el-table-column>
            <el-table-column prop="" label="班组"></el-table-column>
            <el-table-column prop="" label="考核指标名称"></el-table-column>
            <el-table-column prop="" label="目标值"></el-table-column>
            <el-table-column prop="" label="数据来源"></el-table-column>
            <el-table-column prop="" label="总审核次数">
                <el-table-column v-for="i in 12" prop="" :label="i+'月'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="及时应审次数">
                <el-table-column v-for="i in 12" prop="" :label="i+'月'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="第三方管理体系认证、产品认证审核及时率"></el-table-column>
            <el-table-column prop="" label="实际得分"></el-table-column>
            <el-table-column prop="" label="与目标值差异"></el-table-column>
            <el-table-column prop="" label="得分小计"></el-table-column>
        </el-table>
        <el-table :data="Table.wlwjsffs"
                  max-height="600"
                  size="medium"
                  stripe
                  border>
            <el-table-column type="index" label="序号"></el-table-column>
            <el-table-column prop="" label="部门"></el-table-column>
            <el-table-column prop="" label="班组"></el-table-column>
            <el-table-column prop="" label="考核指标名称"></el-table-column>
            <el-table-column prop="" label="目标值"></el-table-column>
            <el-table-column prop="" label="数据来源"></el-table-column>
            <el-table-column prop="" label="物料未及时发放数">
                <el-table-column v-for="i in 30" prop="" :label="i+'日'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="月度物料未及时发放数"></el-table-column>
            <el-table-column prop="" label="实际得分"></el-table-column>
            <el-table-column prop="" label="与目标值差异"></el-table-column>
            <el-table-column prop="" label="得分小计"></el-table-column>
        </el-table>
        <el-table :data="Table.ddchlfcfs"
                  max-height="600"
                  size="medium"
                  stripe
                  border>
            <el-table-column type="index" label="序号"></el-table-column>
            <el-table-column prop="" label="部门"></el-table-column>
            <el-table-column prop="" label="班组"></el-table-column>
            <el-table-column prop="" label="考核指标名称"></el-table-column>
            <el-table-column prop="" label="目标值"></el-table-column>
            <el-table-column prop="" label="数据来源"></el-table-column>
            <el-table-column prop="" label="订单出货漏发错发数">
                <el-table-column v-for="i in 30" prop="" :label="i+'日'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="月度物料未及时发放数"></el-table-column>
            <el-table-column prop="" label="实际得分"></el-table-column>
            <el-table-column prop="" label="与目标值差异"></el-table-column>
            <el-table-column prop="" label="得分小计"></el-table-column>
        </el-table>
        <el-table :data="Table.jfdds"
                  max-height="600"
                  size="medium"
                  stripe
                  border>
            <el-table-column type="index" label="序号"></el-table-column>
            <el-table-column prop="" label="部门"></el-table-column>
            <el-table-column prop="" label="班组"></el-table-column>
            <el-table-column prop="" label="考核指标名称"></el-table-column>
            <el-table-column prop="" label="目标值"></el-table-column>
            <el-table-column prop="" label="数据来源"></el-table-column>
            <el-table-column prop="" label="按时交付订单数">
                <el-table-column v-for="i in 12" prop="" :label="i+'月'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="实际需交付订单数量">
                <el-table-column v-for="i in 12" prop="" :label="i+'月'"></el-table-column>
            </el-table-column>
            <el-table-column prop="" label="订单交付及时率"></el-table-column>
            <el-table-column prop="" label="实际得分"></el-table-column>
            <el-table-column prop="" label="与目标值差异"></el-table-column>
            <el-table-column prop="" label="得分小计"></el-table-column>
        </el-table>
    </div>


</script>
<script>
    Vue.component('kpi-efficiency-daily-component', {
        props: ['departmentlist', 'grouplist'],
        template: document.getElementById("KPI_Efficiency_Daily_Component"),
        data: function () {
            return {
                department: null,
                group: null,
                monthDate: null,
                Table: {
                    dcl: [{ aa: '123' }, { aa: '123' }, { aa: '123' }, { aa: '123' }, { aa: '123' }],
                    jsl: [{ aa: '123' }, { aa: '123' }, { aa: '123' }],
                    shcs: [{ aa: '123' }, { aa: '123' }, { aa: '123' }],
                    wlwjsffs: [{ aa: '123' }, { aa: '123' }, { aa: '123' }],
                    ddchlfcfs: [{ aa: '123' }, { aa: '123' }, { aa: '123' }],
                    jfdds: [{ aa: '123' }, { aa: '123' }, { aa: '123' }],
                },
                excelJson: [],
                test: {
                    DayArray: //按日划分
                        [{
                            Department: 1,//部门
                            Group: 2,//班组
                            IndicatorsName: 3,//指标名
                            IndicatorsValue: 4,//目标值
                            SourceDepartment: 5,//来源部门
                            PlanTotalValue: 6,//月总计划值
                            ActualValue: ["98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)"], //31天详细数据
                            ActualTotalValue: 2,//月总实际值
                            ActualScore: 3,//实际得分
                            DifferencesValue: 'sss',//与目标值差异
                            Goal: 3, //得分小计
                        }],
                    MouthArray:  //按月划分
                        [{
                            Department: 1,//部门
                            Group: 2,//班组
                            IndicatorsName: 3,//指标名
                            IndicatorsValue: 4,//目标值
                            SourceDepartment: 5,//来源部门
                            PlanTotalValue: 6,//月总计划值ActualValue:["98%(98/100)","xxx"], //12个月详细数据
                            ActualTotalValue: 2,//月总实际值
                            ActualScore: 3,//实际得分
                            DifferencesValue: 'sss',//与目标值差异
                            Goal: 3, //得分小计
                        }],
                }
            }
        },
        mounted: function () {
            this.Table.dcl = [{
                Department: 1,//部门
                Group: 2,//班组
                IndicatorsName: 3,//指标名
                IndicatorsValue: 4,//目标值
                SourceDepartment: 5,//来源部门
                PlanTotalValue: 6,//月总计划值
                ActualValue: ["98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)", "98%(98/100)"], //31天详细数据
                ActualTotalValue: 2,//月总实际值
                ActualScore: 3,//实际得分
                DifferencesValue: 'sss',//与目标值差异
                Goal: 3, //得分小计
            }];
        },
        methods: {
            onQuerySubmit() {
                axios.post('/KPI/DiasplyEfficiency', { time: this.monthDate.toLocaleDateString(), stuta: '效率' }).then(res => {
                    this.excelJson = res.data;
                }).catch(err => {

                });
            },

            EfficiencyQualityOutputExcel() {
                axios.post('/KPI/EfficiencyQualityOutputExcel', { value: this.excelJson, year: '', mounth: '', state: '效率' }).then(res => {
                    //返回文件

                    @*<a : href="'/Packagings/OutputPackagingDatatoExcel?ordernum='+orderDetails.OrderNum">
                        <el-button type="success" size="mini" style="margin-top:15px;">导出excel</el-button></a >*@

                    //let a = document.createElement('a')
                    //a.href = "/user/downloadExcel"
                    //a.click();
                }).catch(err => {

                });
            },
        },
        watch: {
            monthDate(v) {
                console.log(v)
                console.log(v.toLocaleDateString())
            }
        },
    });
</script>

