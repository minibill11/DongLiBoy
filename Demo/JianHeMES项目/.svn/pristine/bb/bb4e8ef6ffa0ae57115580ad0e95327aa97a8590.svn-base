@model JianHeMES.Models.Small_Sample

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/Content/styleFile/packaging/index.css" rel="stylesheet" />
<script src="~/Content/styleFile/packaging/index.js"></script>
<script src="~/Scripts/axios.min.js"></script>

<style>
    table td {
        font-size: 13px;
        text-align: center;
        line-height: 28px;
    }

    .tdco {
        border-left: solid 1px #ffffff;
        border-right: solid 1px #ffffff;
    }
    .el-upload__input {
        display: none !important;
    }
   
</style>
<div id="app">
    <div style="display:flex" v-for="io in tableList">
        <h2 style="margin:0 auto;margin-top:20px;margin-bottom:15px;position:relative">小样光电参数测试报告</h2>       
        <el-upload class="upload-demo"
                   v-bind:on-change="testchange"
                   ref="upload"
                   action="https://jsonplaceholder.typicode.com/posts/"
                   v-bind:on-preview="handlePreview"
                   v-bind:on-remove="handleRemove"
                   v-bind:file-list="fileList"
                   v-bind:auto-upload="false" style="margin-top:2px;position:absolute;right:500px">
            <el-button slot="trigger" size="small" type="primary" style="margin-top:5px">选取文件</el-button>
            <el-button style="margin-left: 10px; margin-top:5px" size="small" type="success" v-on:click="submitUpload" >上传</el-button>          
        </el-upload>
    </div>
    <table border="1" cellspacing="0" style="margin:0 auto">
        <colgroup>
            <col width="35">
            <col width="38">
            <col width="60">
            <col width="55">
            <col width="60">
            <col width="70">
            <col width="70">
            <col width="80">
            <col width="100">
            <col width="70">
            <col width="70">
            <col width="90">
        </colgroup>
        <tr v-for="io in tableList">
            <td colspan="2">客户名称</td>
            <td colspan="2">{{io.Customer}}</td>
            <td>生产单号</td>
            <td colspan="2">{{io.OrderNumber}}</td>
            <td>规格型号</td>
            <td>{{io.Mo1}}</td>
            <td colspan="2">模块数量(单位：PCS)</td>
            <td>{{io.Module_Number}}</td>
        </tr>
        <tr>
            <td colspan="12" class="tdco">&nbsp</td>
        </tr>

        <tr v-for="io in tableList">
            <td colspan="7" style="text-align:left">&nbsp;测试目的：</td>
            <td>实际点间距</td>
            <td>{{io.Actual_point}}</td>
            <td colspan="3"></td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="8" style="text-align:left">&nbsp;测试工具：</td>
            <td>订单接收卡：</td>
            <td colspan="3">{{io.ReceivingCard}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">模块型号：</td>
            <td colspan="2">{{io.Mo2}}</td>
            <td>点数：</td>
            <td>{{io.Points}}</td>
            <td>扫描数</td>
            <td>{{io.Scanningway}}</td>
            <td>调试系统</td>
            <td colspan="3" v-bind:class="4>io.system>2?'class':''">{{io.system}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">测试条件</td>
            <td>外界环境</td>
            <td>固定值</td>
            <td colspan="2">驱动板电压(V)</td>
            <td>{{io.Driveplate}}</td>
            <td colspan="5">电源型号</td>
        </tr>

        <tr>
            <td colspan="12" class="tdco">样品参数实测值</td>
        </tr>
        <tr>
            <td colspan="2">角度</td>
            <td>颜色</td>
            <td colspan="2">R</td>
            <td colspan="2">G</td>
            <td colspan="2">B</td>
            <td colspan="3">W</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2" rowspan="2">0°</td>
            <td>亮度</td>
            <td colspan="2">{{io.Angle_R1}}</td>
            <td colspan="2">{{io.Angle_G1}}</td>
            <td colspan="2">{{io.Angle_B1}}</td>
            <td colspan="3">{{io.Angle_W1}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td>坐标</td>
            <td>{{io.Angle_R2}}</td>
            <td>{{io.Angle_R3}}</td>
            <td>{{io.Angle_G2}}</td>
            <td>{{io.Angle_G3}}</td>
            <td>{{io.Angle_B2}}</td>
            <td>{{io.Angle_B3}}</td>
            <td colspan="2">{{io.Angle_W2}}</td>
            <td>{{io.Angle_W3}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2" rowspan="2">客户要求</td>
            <td>亮度</td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2">{{io.Client_W1}}</td>
            <td>{{io.Client_W2}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td>坐标</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td colspan="2">{{io.Client_W3}}</td>
            <td>{{io.Client_W4}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">分压电/排阻阻值(欧)</td>
            <td colspan="2">{{io.Points_R}}</td>
            <td colspan="2">/</td>
            <td colspan="2">/</td>
            <td colspan="3">/</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">可调用电阻阻值(欧)</td>
            <td colspan="2">{{io.Adju_R}}</td>
            <td colspan="2">{{io.Adju_G}}</td>
            <td colspan="2">{{io.Adju_B}}</td>
            <td colspan="3">/</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">单IC引脚电流(mA)</td>
            <td colspan="2">{{io.IC_R1}}</td>
            <td colspan="2">{{io.IC_G1}}</td>
            <td colspan="2">{{io.IC_B1}}</td>
            <td colspan="3"></td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">IC   VDS</td>
            <td colspan="2">{{io.IC_R2}}</td>
            <td colspan="2">{{io.IC_G2}}</td>
            <td colspan="2">{{io.IC_B2}}</td>
            <td colspan="3"></td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">模 块 电 流(A)</td>
            <td colspan="4">{{io.Module_current}}</td>
            <td colspan="2">IC 型号</td>
            <td colspan="3">{{io.IC3}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">刷新频率</td>
            <td colspan="2">{{io.R1}}</td>
            <td colspan="2">接收卡Data包</td>
            <td colspan="5">{{io.R2}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">接收卡带载点数</td>
            <td colspan="2">{{io.R3}}</td>
            <td colspan="2">LCT版本</td>
            <td colspan="5">{{io.LCT}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">亮度有效率(%)</td>
            <td colspan="2">{{io.De1}}</td>
            <td colspan="2">灰度等级</td>
            <td colspan="2">{{io.De2}}</td>
            <td>DCLK</td>
            <td colspan="2">{{io.DCLK}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">电源带载率(%)</td>
            <td colspan="2">{{io.Load}}</td>
            <td colspan="2">每平方最大功耗(W/m²)</td>
            <td colspan="2">{{io.Per}}</td>
            <td>GCLK</td>
            <td colspan="2">{{io.GCLK}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="3">MOS管型号</td>
            <td colspan="2">{{io.MOS1}}</td>
            <td colspan="2">MOS压降(V)</td>
            <td colspan="2">{{io.MOS2}}</td>
            <td>电流增益</td>
            <td colspan="2">{{io.Current}}</td>
        </tr>

        <tr>
            <td colspan="12" class="tdco">小样灯管及参数(供应商测试值)</td>
        </tr>
        <tr>
            <td colspan="3">LED厂家及型号</td>
            <td colspan="2"></td>
            <td colspan="2">IV(mcd)</td>
            <td colspan="2">WD(nm)</td>
            <td colspan="2">正向电压（vf）</td>
            <td>IV@IF(mA)</td>
        </tr>
        <tr v-for="io in tableList">
            <td rowspan="2">R</td>
            <td colspan="2" rowspan="2">{{io.LED_R1}}</td>
            <td colspan="2">实际范围</td>
            <td>{{io.LED_R2}}</td>
            <td>{{io.LED_R4}}</td>
            <td>{{io.LED_R6}}</td>
            <td>{{io.LED_R7}}</td>
            <td rowspan="2">{{io.LED_R9}}</td>
            <td rowspan="2">{{io.LED_R10}}</td>
            <td rowspan="2">{{io.LED_R11}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">Min:Max</td>
            <td>{{io.LED_R3}}</td>
            <td>{{io.LED_R5}}</td>
            <td colspan="2">{{io.LED_R8}}</td>
        </tr>

        <tr v-for="io in tableList">
            <td rowspan="2">G</td>
            <td colspan="2" rowspan="2">{{io.LED_G1}}</td>
            <td colspan="2">实际范围</td>
            <td>{{io.LED_G2}}</td>
            <td>{{io.LED_G4}}</td>
            <td>{{io.LED_G6}}</td>
            <td>{{io.LED_G7}}</td>
            <td rowspan="2">{{io.LED_G9}}</td>
            <td rowspan="2">{{io.LED_G10}}</td>
            <td rowspan="2">{{io.LED_G11}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">Min:Max</td>
            <td>{{io.LED_G3}}</td>
            <td>{{io.LED_G5}}</td>
            <td colspan="2">{{io.LED_G8}}</td>
        </tr>

        <tr v-for="io in tableList">
            <td rowspan="2">B</td>
            <td colspan="2" rowspan="2">{{io.LED_B1}}</td>
            <td colspan="2">实际范围</td>
            <td>{{io.LED_B2}}</td>
            <td>{{io.LED_B4}}</td>
            <td>{{io.LED_B6}}</td>
            <td>{{io.LED_B7}}</td>
            <td rowspan="2">{{io.LED_B9}}</td>
            <td rowspan="2">{{io.LED_B10}}</td>
            <td rowspan="2">{{io.LED_B11}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">Min:Max</td>
            <td>{{io.LED_B3}}</td>
            <td>{{io.LED_B5}}</td>
            <td colspan="2">{{io.LED_B8}}</td>
        </tr>

        <tr>
            <td colspan="12" class="tdco">小样灯管及参数(联建测试值)</td>
        </tr>
        <tr>
            <td colspan="3">LED厂家及型号</td>
            <td colspan="2"></td>
            <td colspan="2">IV(mcd)</td>
            <td colspan="2">WD(nm)</td>
            <td colspan="2">正向电压（vf）</td>
            <td>IV@IF(mA)</td>
        </tr>
        <tr v-for="io in tableList">
            <td rowspan="2">R</td>
            <td colspan="2" rowspan="2">{{io.Small_R1}}</td>
            <td colspan="2">实际范围</td>
            <td>{{io.Small_R2}}</td>
            <td>{{io.Small_R4}}</td>
            <td>{{io.Small_R6}}</td>
            <td>{{io.Small_R7}}</td>
            <td rowspan="2">{{io.Small_R9}}</td>
            <td rowspan="2">{{io.Small_R10}}</td>
            <td rowspan="2">{{io.Small_R11}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">Min:Max</td>
            <td>{{io.Small_R3}}</td>
            <td>{{io.Small_R5}}</td>
            <td colspan="2">{{io.Small_R8}}</td>
        </tr>

        <tr v-for="io in tableList">
            <td rowspan="2">G</td>
            <td colspan="2" rowspan="2">{{io.Small_G1}}</td>
            <td colspan="2">实际范围</td>
            <td>{{io.Small_G2}}</td>
            <td>{{io.Small_G4}}</td>
            <td>{{io.Small_G6}}</td>
            <td>{{io.Small_G7}}</td>
            <td rowspan="2">{{io.Small_G9}}</td>
            <td rowspan="2">{{io.Small_G10}}</td>
            <td rowspan="2">{{io.Small_G11}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">Min:Max</td>
            <td>{{io.Small_G3}}</td>
            <td>{{io.Small_G5}}</td>
            <td colspan="2">{{io.Small_G8}}</td>
        </tr>

        <tr v-for="io in tableList">
            <td rowspan="2">B</td>
            <td colspan="2" rowspan="2">{{io.Small_B1}}</td>
            <td colspan="2">实际范围</td>
            <td>{{io.Small_B2}}</td>
            <td>{{io.Small_B4}}</td>
            <td>{{io.Small_B6}}</td>
            <td>{{io.Small_B7}}</td>
            <td rowspan="2">{{io.Small_B9}}</td>
            <td rowspan="2">{{io.Small_B10}}</td>
            <td rowspan="2">{{io.Small_B11}}</td>
        </tr>
        <tr v-for="io in tableList">
            <td colspan="2">Min:Max</td>
            <td>{{io.Small_B3}}</td>
            <td>{{io.Small_B5}}</td>
            <td colspan="2">{{io.Small_B8}}</td>
        </tr>

        <tr v-for="io in tableList">
            <td colspan="12" style="text-align:left">备注：{{io.ReportRemark}}</td>
        </tr>
    </table>
    <br>
    <div style="float:inherit">
        <span style="margin-left:180px" v-for="io in tableList">
            核准：{{io.Approved}}
        </span>
        <span style="margin-left:240px" v-for="io in tableList">
            审核：{{io.Assessor}}
        </span>
        <span style="margin-left:240px" v-for="io in tableList">
            测试：{{io.Tester}}
        </span>
    </div>
</div>
<script>
    var app = new Vue({
        el: "#app",
        data: {
            tableList: [{}],
            fileList: [],
            file: null
        },
        methods: {
            submitUpload() {
                //this.$refs.upload.submit();
                let form = new FormData();
                form.append("file", this.file)
                axios.post('/Small_Sample/Create', {
                    small_Sample: form
                }).then(res => {
                    console.log("ok")
                }).catch(err => {
                    console.log("no")
                })
            },
            handleRemove(file, fileList) {             
                console.log(file, fileList);
            },
            handlePreview(file) {
                console.log(file);
            },
            testchange(file, fileList) {
                console.log(file.raw);
                this.file = file.raw
                console.log(fileList)
            }
        }
    });
</script>