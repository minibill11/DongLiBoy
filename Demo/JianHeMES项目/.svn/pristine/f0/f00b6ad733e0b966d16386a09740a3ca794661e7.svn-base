
@{
    ViewBag.Title = "UploadExcelFile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>UploadExcelFile</h2>

@{
    Layout = null;
}
<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    @*<script src="~/Scripts/jquery-3.2.1.min.js"></script>*@
    <script src="~/Scripts/jquery-1.11.3.min.js"></script>
    <script src="~/Scripts/vue.js"></script>
    <script src="~/Scripts/axios.min.js"></script>
    <style>
        td {
            padding: 1rem;
        }
    </style>
</head>
<div id="app">
    <form id="myform">
        <table border="1">
            <tr>
                <td>导入</td>
                <td>
                    <input type="file" name="fileup" id="fileup" v-on:change="fileChange()" style="display:none" />
                    <img src="~/Content/Images/upload.png" width="50" v-on:click="upclick()">
                </td>
            </tr>
        </table>
    </form>
    <table>
        <tr v-for="item in list">
            <td>{{item.No}}</td>
            <td>{{item.Name}}</td>
            <td>{{item.Age}}</td>
            <td>{{item.Sex}}</td>
        </tr>
    </table>
    <br />
    @*<a href="/test/OutputExcelFile">转成excel</a>*@
</div>

<style>
    table td {
        font-size: 14px;
        text-align: center;
        line-height: 15px;
    }
</style>
<div>
    <h2>小样光电参数测试报告</h2>
    <table border="1" cellspacing="0">
        <colgroup>
            <col width="60 ">
            <col width="60 ">
            <col width="90 ">
            <col width="90 ">
            <col width="90 ">
            <col width="100 ">
            <col width="100 ">
            <col width="105 ">
            <col width="120 ">
            <col width="90 ">
            <col width="90 ">
            <col width="100 ">
        </colgroup>
        <tr>
            <td colspan="2">客户名称</td>
            <td colspan="2"></td>
            <td>生产单号</td>
            <td colspan="2"></td>
            <td>规格型号</td>
            <td></td>
            <td colspan="2">模块数量(单位：PCS)</td>
            <td></td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            <td colspan="7">测试目的：确认样品的亮度、色度和电阻值。</td>
            <td>实际点间距</td>
            <td></td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td colspan="8">测试工具：CS-150A亮度测试仪、万用表、计算器、探头温度计</td>
            <td>订单接收卡：</td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td colspan="2">模块型号：</td>
            <td colspan="2"></td>
            <td>点数：</td>
            <td></td>
            <td>扫描数</td>
            <td></td>
            <td>调试系统</td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td colspan="2">测试条件</td>
            <td>外界环境</td>
            <td>固定值</td>
            <td colspan="2">驱动板电压(V)</td>
            <td></td>
            <td colspan="5">电源型号</td>
        </tr>
        <tr>
            <td colspan="12">样品参数实测值</td>
        </tr>
        <tr>
            <td colspan="2">角度</td>
            <td>颜色</td>
            <td colspan="2">R</td>
            <td colspan="2">G</td>
            <td colspan="2">B</td>
            <td colspan="3">W</td>
        </tr>
        <tr>
            <td colspan="2" rowspan="2">0°</td>
            <td>亮度</td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td>坐标</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
            <td></td>
        </tr>
        <tr>
            <td colspan="2" rowspan="2">客户要求</td>
            <td>亮度</td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td>坐标</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
            <td></td>
        </tr>
        <tr>
            <td colspan="3">分压电/排阻阻值(欧)</td>
            <td colspan="2"></td>
            <td colspan="2">/</td>
            <td colspan="2">/</td>
            <td colspan="3">/</td>
        </tr>
        <tr>
            <td colspan="3">可调用电阻阻值(欧)</td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="3">/</td>
        </tr>
        <tr>
            <td colspan="3">单IC引脚电流(mA)</td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td colspan="3">IC   VDS</td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td colspan="3">模 块 电 流(A)</td>
            <td colspan="4"></td>
            <td colspan="2">IC 型号</td>
            <td colspan="3"></td>
        </tr>
        <tr>
            <td colspan="3">刷新频率</td>
            <td colspan="2"></td>
            <td colspan="2">接收卡Data包</td>
            <td colspan="5"></td>
        </tr>
        <tr>
            <td colspan="3">亮度有效率(%)</td>
            <td colspan="2"></td>
            <td colspan="2">灰度等级</td>
            <td colspan="2"></td>
            <td>DCLK</td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="3">电源带载率(%)</td>
            <td colspan="2"></td>
            <td colspan="2">每平方最大功耗(W/m²)</td>
            <td colspan="2"></td>
            <td>GCLK</td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="3">MOS管型号</td>
            <td colspan="2"></td>
            <td colspan="2">MOS压降(V)</td>
            <td colspan="2"></td>
            <td>电流增益</td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="12">小样灯管及参数(供应商测试值)</td>
        </tr>
        <tr>
            <td colspan="3">LED厂家及型号</td>
            <td colspan="2"></td>
            <td colspan="2">IV(mcd)</td>
            <td colspan="2">WD(nm)</td>
            <td colspan="2">正向电压（vf）</td>
            <td>IV@IF(mA)</td>
        </tr>
        <tr>
            <td rowspan="2">R</td>
            <td colspan="2" rowspan="2"></td>
            <td colspan="2">实际范围</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
        </tr>
        <tr>
            <td colspan="2">Min:Max</td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td rowspan="2">G</td>
            <td colspan="2" rowspan="2"></td>
            <td colspan="2">实际范围</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
        </tr>
        <tr>
            <td colspan="2">Min:Max</td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td rowspan="2">B</td>
            <td colspan="2" rowspan="2"></td>
            <td colspan="2">实际范围</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
        </tr>
        <tr>
            <td colspan="2">Min:Max</td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="12">小样灯管及参数(联建测试值)</td>
        </tr>

        <tr>
            <td colspan="3">LED厂家及型号</td>
            <td colspan="2"></td>
            <td colspan="2">IV(mcd)</td>
            <td colspan="2">WD(nm)</td>
            <td colspan="2">正向电压（vf）</td>
            <td>IV@IF(mA)</td>
        </tr>
        <tr>
            <td rowspan="2">R</td>
            <td colspan="2" rowspan="2"></td>
            <td colspan="2">实际范围</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
        </tr>
        <tr>
            <td colspan="2">Min:Max</td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td rowspan="2">G</td>
            <td colspan="2" rowspan="2"></td>
            <td colspan="2">实际范围</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
        </tr>
        <tr>
            <td colspan="2">Min:Max</td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td rowspan="2">B</td>
            <td colspan="2" rowspan="2"></td>
            <td colspan="2">实际范围</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
            <td rowspan="2"></td>
        </tr>
        <tr>
            <td colspan="2">Min:Max</td>
            <td></td>
            <td></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="12" style="text-align:center"></td>
        </tr>
    </table>
    <br>
    <div style="display:flex">
        <span>
            核准：
        </span>
        <span>
            审核：
        </span>
        <span>
            测试：
        </span>
    </div>
</div>

<script>
    var app = new Vue({
        el: "#app",
        data: {
            list: [],
        },
        methods: {
            downExcel: function () {
                $.post("", {}, function (res) {

                });
            },
            upclick: function () {
                document.getElementById("fileup").click();
            },
            fileChange: function () {
                if (!document.getElementById("fileup").files[0].size) return;
                var obj = new FormData(document.getElementById("myform"));
                obj.append("name", "wzh");
                var _this = this;
                $.ajax({
                    type: 'post',
                    url: '/test/UploadExcelFile1',
                    data: obj,
                    cache: false,
                    processData: false, // 不处理发送的数据，因为data值是Formdata对象，不需要对数据做处理
                    contentType: false, // 不设置Content-type请求头
                    success: function (data) {
                        if (data != "no") {
                            _this.list = data;
                        } else {
                            alert(data);
                        }
                    },
                });
            },
        }
    })
</script>
