@model IEnumerable<JianHeMES.Models.Personnel_Framework>

@{
    ViewBag.Title = "Index";
}
<script src="~/Scripts/Bootstraps/Element-ui.js"></script>
<script src="~/Scripts/axios.min.js"></script>
<link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
<link href="~/Scripts/orgchart.css" rel="stylesheet" />
<link href="~/Scripts/Scripts/font-awesome.min.css" rel="stylesheet" />
<script src="~/Scripts/orgchart.js"></script>
<style>
    .container ,.body-content{
        position:relative;
        left:-110px;
    }
    .el-tabs__nav-wrap{
        width:122%;
    }
    .el-tabs__content{
        width:123%;
    }
    .el-tabs,el-tabs--top{
        width:74.5% !important;
    }
    .el-table__header-wrapper{
        width:103%;
    }
    .top-container{
        display:flex;
        justify-content:flex-start;
        margin-top:25px;
    }
    .app-container{
        margin-top:15px;
    }
    .filter-tree{
        margin-top:10px;
        width:100%;
    }
    .bottom-container{
        width:22%;
        height:650px;
        overflow:auto;
    }
    .gottable{
        width:100%;
        /*border:1px solid green;*/
    }
    .gottable>table{
        text-align:center;
    }
    .button-container{
        width:120px;
        display:flex;
        justify-content:flex-start;
    }
    .button-container>button{
        padding:5px;
        margin:0;
    }
    .formedia{
        display:flex;
        width:110%;
        justify-content:flex-start;
    }
    @@media (max-width:450px){
    .formedia{
        display:block;
    }
    .bottom-container{
        width:100%;
        height:auto;
    }
    .gottable{
        width:837px;
    }
    }


.orgchart{
    background-image:none !important;
    width:100%;
}
.orgchart table{
    width:100%;
}
.orgchart .node .title{
    background-color:#993366;
}

#chart-container{
    width:100%;
}
.second-menu-icon {
        position: absolute;
        top: 0;
        right: 0px;
        color: rgba(68, 157, 68, 0.5);
      }

      .gearteDiv {
        position: absolute;
        top: 100%;
        left: 0;
        z-index: 999;
        width: 120px;
        height: 80px;
        background-color: #aaa;
        opacity: 0.8;
        border: none;
        border-radius: 5px;
        box-shadow: 0 0 0.1rem #c2c2c2;
      }

</style>

<div class="top-container" id="app">
    <h4>组织架构</h4>
    @*<p>
            @Html.ActionLink("Create New", "Create")
        </p>*@
    <div id='chart-container'></div>
</div>


    <script>
        var datas;
        var vm = new Vue({
            el: "#app",
            data: {
                defaultInfos:"",
            },
            mounted() {
                this.getDefultInfos();
            },
            methods: {
                getDefultInfos() {
                    axios.post("/Personnel_Framework/Framework").then(res=> {
                        datas = res.data;
                        orgchart = new OrgChart({
                            'chartContainer': '#chart-container',
                            'data': datas, //数据源
                            'nodeContent': 'title', //标签body的内容
                            //'verticalLevel': 0,
                            'depth': 2, // 默认展开的层数
                            'nodeId': 'name', //设置一个node的唯一标识符
                            'direction': 't2b', // 树图展开的方向
                            'toggleSiblingsResp': true, //是否可点击箭头展开或者收缩相邻节点
                            'createNode': function (node, data) {
                                //console.log(node);
                                //console.log(data);
                                let secondMenuIcon = document.createElement('i'),
                                  secondMenu = document.createElement('div');
                                secondMenuIcon.setAttribute('class', 'fa fa-info-circle second-menu-icon edge');
                                secondMenuIcon.addEventListener('click', (event) => {
                                    event.target.nextElementSibling.classList.toggle('hidden');
                                });
                                secondMenu.setAttribute('class', 'second-menu hidden gearteDiv');
                                secondMenu.innerHTML = `<div v-for="item in 10">此处显示人员当天在岗信息--不可编辑</div>`;
                                node.appendChild(secondMenuIcon)
                                node.appendChild(secondMenu);
                            },
                            'nodeClick': function (node, data) {

                            }
                        });
                        console.log(333)
                    }).catch(err=> {
                        console.log(123)
                    })
                }
            }
        })
    </script>
