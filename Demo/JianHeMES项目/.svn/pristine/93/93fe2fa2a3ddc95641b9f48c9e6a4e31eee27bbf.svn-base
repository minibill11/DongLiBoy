
@{
    ViewBag.Title = "UploadExcelFile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>UploadExcelFile</h2>

@{
    Layout = null;
}
<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    @*<script src="~/Scripts/jquery-3.2.1.min.js"></script>*@
    <script src="~/Scripts/jquery-1.11.3.min.js"></script>
    <script src="~/Scripts/vue.js"></script>
    <script src="~/Scripts/axios.min.js"></script>
    <style>
        td {
            padding: 1rem;
        }
    </style>
</head>
    <div id="app">
        <form id="myform">
            <table border="1">
                <tr>
                    <td>导入</td>
                    <td>
                        <input type="file" name="fileup" id="fileup" v-on:change="fileChange()" style="display:none" />
                        <img src="~/Content/Images/upload.png" width="50" v-on:click="upclick()">
                    </td>
                </tr>
            </table>
        </form>
        <table>
            <tr v-for="item in list">
                <td>{{item.No}}</td>
                <td>{{item.Name}}</td>
                <td>{{item.Age}}</td>
                <td>{{item.Sex}}</td>
            </tr>
        </table>
        <br />
        @*<a href="/test/OutputExcelFile">转成excel</a>*@
    </div>

    <script>
        var app = new Vue({
            el: "#app",
            data: {
                list: [],
            },
            methods: {
                downExcel: function () {
                    $.post("", {},function (res) {

                    });
                },
                upclick:function(){
                    document.getElementById("fileup").click();
                },
                fileChange: function () {
                    if (!document.getElementById("fileup").files[0].size) return;
                    var obj = new FormData(document.getElementById("myform"));
                    obj.append("name", "wzh");
                    var _this = this;
                    $.ajax({
                        type: 'post',
                        url: '/test/UploadExcelFile1',
                        data: obj,
                        cache: false,
                        processData: false, // 不处理发送的数据，因为data值是Formdata对象，不需要对数据做处理
                        contentType: false, // 不设置Content-type请求头
                        success: function (data) {
                            if (data != "no") {
                                _this.list = data;
                            } else {
                                alert(data);
                            }
                        },
                    });
                },
            }
        })
    </script>
