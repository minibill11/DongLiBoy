@{
    ViewBag.Title = "销售部";
}
<link href="~/Content/styleFile/packaging/index.css" rel="stylesheet" />
<script src="~/Content/styleFile/packaging/index.js"></script>
<style>
    /*全局样式*/
    *, body, .el-main, .el-header {
        padding: 0;
    }

    .body-content, .container {
        padding-left: 0px;
        padding-right: 0px;
    }

    #app {
        padding: 50px 0 0;
    }

    .el-header {
        height: auto !important;
    }

    .el-main {
        min-height: 600px;
    }

    [v-cloak] {
        display: none;
    }

    .inputframe {
        width: 320px;
        text-align: left;
        margin: 1px auto;
        min-height: 25px;
    }

        .inputframe > span:first-child {
            display: inline-block;
            width: 106px;
            text-align: right;
            font-weight: 500;
            font-size: 14px;
        }

        .el-input, .el-progress, .inputframe > div {
            width: 210px;
            display: inline-block;
        }

    .el-progress-bar {
        margin-right: -60px;
        width: 90%;
    }

    .rightDiv {
        text-align: left;
        font-weight: 500;
        font-size: 15px;
        padding-left: 5px;
    }

    .fordiv {
        border-top: 1px solid #555;
        width: 320px;
        margin: 10px auto 0;
    }
</style>
<div id="app" v-cloak>
    <el-container>
        <el-header class="text-center">
            <div v-show="screenSize>=768">
                <h2 class="text-center">@ViewBag.Title</h2>
            </div>
            <div v-show="screenSize<768">
                <h3>@ViewBag.Title</h3>
            </div>
        </el-header>
        <el-main v-loading="loading">
            <el-row>
                <div class="inputframe">
                    <span>订单号：</span>
                    <el-input placeholder="请输入订单号"
                              v-model.trim="selectVal"
                              style="width:160px"
                              size="small"
                              minlength="9"
                              clearable>
                    </el-input>
                    <el-button @@click="selectHandle(selectVal)" type="primary" size="small" style="padding:9px 10px;">查询</el-button>
                </div>
            </el-row>
            <el-row v-if="tablelist!=''" v-loading="loading">
                <div v-for="item in tablelist" class="fordiv">
                    <div class="inputframe">
                        <span>订单号：</span>
                        <div class="rightDiv" style="font-weight:600;">{{item.ordernum}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.Estimated.name}}：</span>
                        <div class="rightDiv">{{item.Estimated.value}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.CompleteTime.name}}：</span>
                        <div class="rightDiv">{{item.CompleteTime.value}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.SMT.name}}：</span>
                        <div class="rightDiv" :style="{color:bgcolor(item.SMT.valuename)}">{{divtext(item.SMT.valuename,item.SMT.value)}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.Model.name}}：</span>
                        <div class="rightDiv" :style="{color:bgcolor(item.Model.valuename)}">{{divtext(item.Model.valuename,item.Model.value)}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.Burnin.name}}：</span>
                        <div class="rightDiv" :style="{color:bgcolor(item.Burnin.valuename)}">{{divtext(item.Burnin.valuename,item.Burnin.value)}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.package.name}}：</span>
                        <div class="rightDiv" :style="{color:bgcolor(item.package.valuename)}">{{divtext(item.package.valuename,item.package.value)}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.warehousejoin.name}}：</span>
                        <div class="rightDiv" :style="{color:bgcolor(item.warehousejoin.valuename)}">{{divtext(item.warehousejoin.valuename,item.warehousejoin.value)}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.warehouseout.name}}：</span>
                        <div class="rightDiv" :style="{color:bgcolor(item.warehouseout.valuename)}">{{divtext(item.warehouseout.valuename,item.warehouseout.value)}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.Transportation.name}}：</span>
                        <div class="rightDiv">{{item.Transportation.value}}</div>
                    </div>
                    <div class="inputframe">
                        <span>{{item.WarehouseOutDocuments.name}}：</span>
                        <div class="rightDiv">{{item.WarehouseOutDocuments.value}}</div>
                    </div>
                </div>
            </el-row>
        </el-main>
    </el-container>
</div>
<script>
    var app = new Vue({
        el: "#app",
        data: {
            loading: false,
            screenSize: document.body.clientWidth,
            selectVal: '',
            tablelist: []
        },
        created: function () {
            window.onresize = function () {
                app.screenSize = document.body.clientWidth;
            };
        },
        methods: {
            selectHandle: function (v) {
                if (v.length >= 9) {
                    this.loading = true;
                    //localStorage.setItem('Order', v);
                    axios.post('/Query/SelectOrderInfoFromBusiness', { ordernum: v }).then(res => {
                        console.log(res.data);
                        console.log(JSON.parse(JSON.stringify(res.data)));
                        this.tablelist = res.data;
                        this.loading = false;
                    }).catch(err => {
                        console.warn("获取选择列表失败")
                        this.loading = false;
                    });
                };
            },
            bgcolor(v) {
                return v === '已完成' ? '#0a0' : v === '进行中' ? 'rgb(0, 125, 255)' : '';
            },
            divtext(vn, v) {
                if (vn === '已完成') {
                    return `${vn} - ${v}`;
                } else {
                    return `${vn} - (${v})`;
                };
            }
        },
        watch: {
            selectVal(v) {
                this.tablelist = [];
            }
        }
    });
</script>