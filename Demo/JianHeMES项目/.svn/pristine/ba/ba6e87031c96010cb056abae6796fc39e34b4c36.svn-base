
@{
    ViewBag.Title = "汇总表";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
<script src="~/Scripts/Bootstraps/Element-ui.js"></script>
<script src="~/Scripts/axios.min.js"></script>

<style>

        table .cell,table td {
        text-align: center;
        padding:2px !important;
    }
        .timeinputcontainer{
            margin:12px auto;
            text-align:center;
        }

</style>

@*<h3>汇总表</h3>*@

<div id="app">
    <div class="timeinputcontainer">
        <el-date-picker size="mini"
                        v-model="times"
                        type="month"
                        placeholder="选择月">
        </el-date-picker>
        月度优秀班组评优汇总表
        @*{{times}}*@
    </div>
    <el-table v-bind:data="tableData3"
              style="width: 100%">
        <el-table-column type="index"
                         label="序号"
                         fixed
                         width="54"
                         v-bind:index="indexMethod">
        </el-table-column>
        <el-table-column prop="name"
                         label="被考核部门"
                         fixed
                         width="130">
        </el-table-column>
        <el-table-column prop="address"
                         width="130"
                         fixed
                         label="班组">
        </el-table-column>
        <el-table-column prop="name"
                         label="效率指标35%"
                         >
            <el-table-column prop="name"
                             label="指标名称"
                             width="130">
            </el-table-column>
            <el-table-column prop="name"
                             label="目标值"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="实际完成值"
                             width="90">
            </el-table-column>
            <el-table-column prop="name"
                             label="单项得分"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="得分小计"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="数据来源和提供部门"
                             width="140">
            </el-table-column>
            
        </el-table-column>
        <el-table-column prop="name"
                         label="品质指标35%">
            <el-table-column prop="name"
                             label="指标名称"
                             width="130">
            </el-table-column>
            <el-table-column prop="name"
                             label="目标值"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="实际完成值"
                             width="90">
            </el-table-column>
            <el-table-column prop="name"
                             label="单项得分"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="得分小计"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="数据来源和提供部门"
                             width="140">
            </el-table-column>

        </el-table-column>
        
        <el-table-column prop="name"
                         label="月度流失率指标15%">
            <el-table-column prop="name"
                             label="指标名称"
                             width="130">
            </el-table-column>
            <el-table-column prop="name"
                             label="目标值"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="实际完成值"
                             width="90">
            </el-table-column>
            <el-table-column prop="name"
                             label="单项得分"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="得分小计"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="数据来源和提供部门"
                             width="140">
            </el-table-column>

        </el-table-column>
        <el-table-column prop="name"
                         label="7S评比指标15%">
            <el-table-column prop="name"
                             label="指标名称"
                             width="130">
            </el-table-column>
            <el-table-column prop="name"
                             label="目标值"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="实际完成值"
                             width="90">
            </el-table-column>
            <el-table-column prop="name"
                             label="单项得分"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="得分小计"
                             width="80">
            </el-table-column>
            <el-table-column prop="name"
                             label="数据来源和提供部门"
                             width="140">
            </el-table-column>

        </el-table-column>
        <el-table-column prop="name"
                         label="总得分"
                         width="100">
        </el-table-column>
        <el-table-column prop="name"
                         label="当月排名"
                         width="100">
        </el-table-column>
        <el-table-column prop="name"
                         label="当月积分"
                         width="100">
        </el-table-column>
        <el-table-column prop="name"
                         label="备注"
                         width="100">
        </el-table-column>

    </el-table>
</div>

<script>
    let app = new Vue({
        el: "#app",
        data: {
            tableData: [],
            times:null,
            tableData3: [{
                date: '2016-05-03',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }, {
                date: '2016-05-02',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }, {
                date: '2016-05-04',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }, {
                date: '2016-05-01',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }, {
                date: '2016-05-08',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }, {
                date: '2016-05-06',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }, {
                date: '2016-05-07',
                name: '王小虎',
                province: '上海',
                city: '普陀区',
                address: '上海市普陀区金沙江路 1518 弄',
                zip: 200333
            }]
        },
        methods: {
            indexMethod(index) {
                return index + 1;
            },
        },
        watch: {
            times() {
                if (this.times != null) {
                    let year = new Date(this.times).getFullYear();
                    let month = new Date(this.times).getMonth() + 1;
                    axios.post("/Personnel_Quality_objectives/Excellent", { year, month}).then(res=> {
                        console.log(res.data)
                        
                    }).catch(err=> {
                        this.$message({
                            message: "连接失败！",
                            type:"warning"
                        })
                    })
                }
            }
        }
    })

</script>
