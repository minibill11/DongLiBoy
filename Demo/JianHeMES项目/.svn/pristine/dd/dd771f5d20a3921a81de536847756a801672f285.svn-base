@model IEnumerable<JianHeMES.Models.Personnel_Framework>

@{
    ViewBag.Title = "Index";
}
<script src="~/Scripts/Bootstraps/Element-ui.js"></script>
<script src="~/Scripts/axios.min.js"></script>
<link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
<link href="~/Scripts/orgchart.css" rel="stylesheet" />
<link href="~/Scripts/Scripts/font-awesome.min.css" rel="stylesheet" />
<script src="~/Scripts/orgchart.js"></script>
<style>
    .container ,.body-content{
        position:relative;
        left:-110px;
    }
    .el-tabs__nav-wrap{
        width:122%;
    }
    .el-tabs__content{
        width:123%;
    }
    .el-tabs,el-tabs--top{
        width:74.5% !important;
    }
    .el-table__header-wrapper{
        width:103%;
    }
    .top-container{
        display:flex;
        justify-content:flex-start;
        margin-top:25px;
    }
    .app-container{
        margin-top:15px;
    }
    .filter-tree{
        margin-top:10px;
        width:100%;
    }
    .bottom-container{
        width:22%;
        height:650px;
        overflow:auto;
    }
    .gottable{
        width:100%;
        /*border:1px solid green;*/
    }
    .gottable>table{
        text-align:center;
    }
    .button-container{
        width:120px;
        display:flex;
        justify-content:flex-start;
    }
    .button-container>button{
        padding:5px;
        margin:0;
    }
    .formedia{
        display:flex;
        width:110%;
        justify-content:flex-start;
    }
    @@media (max-width:450px){
    .formedia{
        display:block;
    }
    .bottom-container{
        width:100%;
        height:auto;
    }
    .gottable{
        width:837px;
    }
    }


.orgchart{
    background-image:none !important;
    width:100%;
}
.orgchart table{
    width:100%;
}
.orgchart .node .title{
    background-color:#993366;
}

#chart-container{
    width:100%;
}
</style>

<div class="top-container" id="app">
    <h4>组织架构</h4>
    @*<p>
            @Html.ActionLink("Create New", "Create")
        </p>*@
    <div id='chart-container'></div>
</div>


    <script>
        var tttt = {
            'name': 'Lao Lao',
            'title': 'general manager',
            'children': [{
                'name': 'Bo Miao',
                'title': 'department manager'
            },
              {
                  'name': 'Su Miao',
                  'title': 'department manager',
                  'children': [{
                      'name': 'Tie Hua',
                      'title': 'senior engineer'
                  },
                    {
                        'name': 'Hei Hei',
                        'title': 'senior engineer',
                        'children': [{
                            'name': 'Pang Pang',
                            'title': 'engineer'
                        },
                          {
                              'name': 'Xiang Xiang',
                              'title': 'UE engineer',
                              'children': [{
                                  'name': 'Dan Dan',
                                  'title': 'Intern'
                              },
                                {
                                    'name': 'Zai Zai',
                                    'title': 'Intern',
                                    'children': [{
                                        'name': 'Mao Mao',
                                        'title': 'Intern'
                                    },
                                      {
                                          'name': 'Lv Lv',
                                          'title': 'Intern'
                                      }
                                    ]
                                }
                              ]
                          }
                        ]
                    }
                  ]
              },
              {
                  'name': 'Hong Miao',
                  'title': 'department manager'
              },
              {
                  'name': 'Chun Miao',
                  'title': 'department manager',
                  'children': [{
                      'name': 'Bing Qin',
                      'title': 'senior engineer'
                  },
                    {
                        'name': 'Yue Yue',
                        'title': 'senior engineer',
                        'children': [{
                            'name': 'Er Yue',
                            'title': 'engineer'
                        },
                          {
                              'name': 'San Yue',
                              'title': 'UE engineer'
                          }
                        ]
                    }
                  ]
              }
            ]
        }

        var datas;
        var vm = new Vue({
            el: "#app",
            data: {
                defaultInfos:"",
            },
            mounted() {
                this.getDefultInfos();
            },
            methods: {
                getDefultInfos() {
                    axios.post("/Personnel_Framework/Framework").then(res=> {
                        
                        datas = res.data;
                        orgchart = new OrgChart({
                            'chartContainer': '#chart-container',
                            'data': datas,
                            'nodeContent': `${name}()人`,
                            'verticalDepth': 8,
                            'depth': 2,
                            'direction': 't2b',
                            // 'exportButton': true,
                            //'exportFilename': 'MyOrgChart',
                            ' toggleSiblingsResp ':true, 
                            'draggable': true,
                            'dropCriteria': function (draggedNode, dragZone, dropZone) {
                                if (draggedNode.querySelector(':scope > .content').textContent.includes('manager') &&
                                  dropZone.querySelector(':scope > .content').textContent.includes('engineer')) {
                                    return false;
                                }
                                return true;
                            }
                        });
                        console.log(333)
                    }).catch(err=> {
                        console.log(123)
                    })
                }
            }
        })
      //document.addEventListener('DOMContentLoaded', function () {
      //    let datascource = datas;
      //    console.log(datas)
          

      //});

    
    </script>
