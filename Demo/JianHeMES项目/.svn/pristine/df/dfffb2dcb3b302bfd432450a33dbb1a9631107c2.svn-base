<script type="text/template" id="Eq_Echarts_Card">
    <div :class="size" :id="id"></div>
</script>
<script>
    Vue.component('eq-card-component', {
        props: {
            id: String,
            size: String,
            text: String,
            value: String,
            chart: Array,
            radius: Array,
            color: Array
        },
        template: document.getElementById("Eq_Echarts_Card"),
        data: function () {
            return {
                id: '',
                size: '',
                chart: [],
                text: '',
                value: '',
                radius:[]
            }
        },
        mounted() {
            //console.log(this.id)
            var chart = this.chart;
            var myChart = echarts.init(document.getElementById(this.id));
            var option = {
                tooltip: {
                    trigger: 'item',
                    formatter: function (a) {
                        return (a['name'] + '<br/>' + a['value'] + '/' + a['data'].per); //自定义百分比
                    }
                },
                //color: ["#22c49e", "#f7c73a","#ff8590"],
                color: this.color,
                legend: {
                    bottom: 10,
                    left: 'center',
                    data: chart.map(item => item.name)
                },
                graphic: {
                    elements: [{
                        type: 'text',
                        left: 'center', // 相对父元素居中
                        top: '40%',
                        style: {
                            fill: '#8EA0B8',
                            text: [this.value],
                            fontSize: 20,
                            fontWeight: 800
                            //font: '18px Arial Normal',
                        }
                    },
                    {
                        type: 'text',
                        left: 'center', // 相对父元素居中
                        top: '48%',  // 相对父元素上下的位置
                        style: {
                            fill: '#8EA0B8',
                            text: [this.text],
                            fontSize: 14
                            //fontWeight: bold
                            //font: '12px Arial Normal',
                        }
                    }]
                },
                series: [
                    {
                        type: 'pie',
                        radius: this.radius,
                        center: ['50%', '45%'],
                        minAngle: 20,//最小角度
                        startAngle:240, //起始角度
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        //labelLine: {
                        //    normal: {
                        //        length: 35,  // 改变标示线的长度
                        //    }
                        //},
                        label: {
                            normal: {
                                formatter: function (a) {
                                    let dd,str;
                                    chart.map(item => {
                                        if (item.name == a.name && item.value == a.value) {
                                            dd = item.per;
                                        }
                                    })
                                    if (a.name.length <4) {
                                        str = '{b|' + a.name + ':' + a.value + '}  \n {d|' + dd + '}  \n';
                                    } else {
                                        str = '{b|' + a.name + ':} \n {b|' + a.value + '}  \n {d|' + dd + '}  \n';
                                    }
                                    //str = '{b|' + a.name + ':} \n {b|' + a.value + '}  \n {d|' + dd + '}  \n';
                                    return str;
                                },
                                borderWidth: 20,
                                borderRadius: 4,
                                padding: [0, -10],
                                rich: {
                                    b: {                        //name 文字样式
                                        fontSize: 14,
                                        lineHeight: 20,
                                        color: '#293038',
                                        fontWeight: 800,
                                        display:"block"
                                    }, 
                                    d: {                   //value 文字样式
                                        fontSize: 14,
                                        lineHeight: 20,
                                        color: '#8EA0B8',
                                        align: "center",
                                        display:"block"
                                    }
                                }
                            }
                        },
                        data: chart
                    }
                ]
            };
            myChart.setOption(option);
        },
        methods: {

        },
    });
</script>
