@{
    ViewBag.Title = "Equipment_Tally";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
    <link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
    <script src="~/Scripts/axios.min.js"></script>
    <script src="~/Scripts/Bootstraps/Element-ui.js"></script>
    <style>
        .taocontainer{
            display:flex;
            justify-content:space-around;
            margin-top:25px;
        }
        .bottomContainer {
        display: flex;
        justify-content: center;
        margin-top: 15px;
    }
        table > thead > tr > th, table > tbody > tr > td {
        text-align: center !important;
    }

    </style>
</head>

<body>
    <div id="app">
        <div class="taocontainer">
            <div class="topinner">
                <el-input placeholder="请输入设备名称"
                          size="small"
                          v-model="Ename"
                          clearable>
                </el-input>
            </div>
            <div class="topinner">
                <el-input placeholder="请输入线别"
                          v-model="lineNum"
                          size="small"
                          clearable>
                </el-input>
            </div>
            <div class="topinner">
                <el-select v-model="orderNum" size="small" allow-create filterable clearable placeholder="请选择设备编号">
                    <el-option v-for="item in options"
                               v-bind:key="item.value"
                               v-bind:label="item.label"
                               v-bind:value="item.value">
                    </el-option>
                </el-select>
            </div>
            <div class="topinner">
                <el-date-picker v-model="time"
                                type="date"
                                size="small"
                                placeholder="选择日期">
                </el-date-picker>
            </div>
            <div class="topinner">
                <el-button id="search" type="success" size="small" v-on:click="query">查询</el-button>
            </div>
        </div>
        <div class="bottomContainer">
            <div style="width:71%">
                <el-table v-bind:data="tableData"
                          border
                          style="width: 100%">
                    <el-table-column prop="Customer"
                                     label="客户"
                                     width="125">
                    </el-table-column>
                    <el-table-column prop="OrderNumber"
                                     label="订单号"
                                     width="180">
                    </el-table-column>
                    <el-table-column prop="Mo1"
                                     width="120"
                                     label="规格型号">
                    </el-table-column>
                    <el-table-column prop="Mo2"
                                     width="120"
                                     label="模块型号">
                    </el-table-column>
                    <el-table-column prop="ReportDate"
                                     width="180"
                                     label="报告时间">
                    </el-table-column>
                    <el-table-column prop=""
                                     width="83"
                                     label="地址">
                        <template slot-scope="scope">
                            <el-button size="small" type="primary" v-on:click="goDetials(scope.row)">详细</el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </div>
        </div>
    </div>

    <script>
        let app = new Vue({
            el: "#app",
            data: {
                Ename: null,
                lineNum: null,
                orderNum: null,
                time: null,
                options: [],
                tableData:[]
            },
            methods: {
                query() {
                    if (this.Ename != '' || this.lineNum != '' || this.orderNum != '' || this.time != '') {
                        console.log(this.time)
                        let dd = new Date(this.time);
                        let selectYear = dd.getFullYear();
                        let selectMonth = dd.getMonth()  +1
                        axios.post("/Equipment/Equipment_Tally", { equipmentName: this.Ename, DP_Group: this.lineNum, equipmentNumber: this.orderNum, year: selectYear, month: selectMonth }).then(res=> {
                            console.log(res.data)
                        }).catch(err=> {

                        })
                    } else {
                        this.$message({
                            message: "请输入需要查询的信息",
                            type:"warning"
                        })
                    }
                },
                getEnumnbers() {
                    axios.post("/Equipment/EQNumberList").then(res=> {
                        console.log(res.data)
                        res.data.forEach(item=> {
                            let obj = { value: item, label: item }
                            this.options.push(obj)
                        })
                    }).catch(err=> {

                    })
                },
                goDetials(item) {

                }
            },
            mounted() {
                this.getEnumnbers()
            }
        })

    </script>
</body>
</html>
