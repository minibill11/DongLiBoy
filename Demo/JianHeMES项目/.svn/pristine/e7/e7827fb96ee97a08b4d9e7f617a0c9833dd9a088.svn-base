@model JianHeMES.Models.Appearance
@{
    ViewBag.Title = "外观电检工作";
}

@*  <summary>
    1.结束外观电检页面
    2.页面主要功能是为条码记录电检结束时间
    3.电检结束的同时会打印出条码，打印条码有相应的功能按钮，（可选打印机，调打印浓度，设置打印数量）
    4.进入页面的时候会自动获取模组号 （需要对应订单有提前建立模组号规则）
    5.获取模组号可选正序和倒序，可选是否使用规则生成的模组号（若不使用规则模组号，则可以手动更改 或 切换成此条码在其它工段拥有的模组号）
    6.若维修情况不正常，则可以通过异常列表选择维修异常的原因
    7.点击模组号输入框，会出现模组号规则清单下拉列表
    </summary>*@

<link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
<script src="~/Scripts/Bootstraps/Element-ui.js"></script>
@* 样式 *@
<style>
    #AbnormalTable .table > tbody > tr > th, #AbnormalTable .table > tbody > tr > td {
        padding: 2px;
        line-height: 1.2;
    }

    #AbnormalTable .table {
        margin-bottom: 0px;
    }

    #AbnormalTable .panel-title {
        text-align: center;
    }

    #AbnormalTable label {
        font-weight: normal;
    }

    #AbnormalTable {
        display: none;
    }

    .abnormalFrame {
        width: 280px;
        height: 200px;
        border: 1px solid #000000;
        overflow: auto;
    }

    @@media screen and (max-width:768px) {
        .el-message, .el-notification, .el-message-box {
            min-width: 90%;
            max-width: 90%;
        }

        .form-group, .control-label {
            margin-bottom: 0px;
        }

        h4 {
            margin-top: 0px;
            margin-bottom: 0px;
        }

        .mozuswitch {
            height: 30px;
        }

            .mozuswitch .el-switch__label * {
                font-size: 12px;
            }

        .table {
            font-size: 13px;
        }
    }

    @@media screen and (min-width:768px) {
        .labelright {
            padding-top: 7px;
        }
    }
</style>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div id="app" class="form-horizontal" v-loading="loading">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.Id)
        @Html.HiddenFor(model => model.OrderNum)
        @Html.HiddenFor(model => model.ToOrderNum)
        @Html.HiddenFor(model => model.BarCodesNum)
        @Html.HiddenFor(model => model.CustomerBarCodesNum)
        @*@Html.HiddenFor(model => model.ModuleGroupNum)*@
        @Html.HiddenFor(model => model.OQCCheckBT)
        @Html.HiddenFor(model => model.Department1)
        @Html.HiddenFor(model => model.Group)


        <div class="col-md-4">
            <h3 class="hidden-xs">@ViewBag.Title</h3>
            <h4 class="visible-xs text-center">@ViewBag.Title</h4>
            <hr class="hidden-xs" />
            <div class="form-group">
                @Html.LabelFor(model => model.OrderNum, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7 labelright">
                    @Html.DisplayFor(model => model.OrderNum)
                    @*@Html.EditorFor(model => model.OrderNum, new { htmlAttributes = new { @class = "form-control" } })*@
                    @Html.ValidationMessageFor(model => model.OrderNum, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.BarCodesNum, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7 labelright">
                    @Html.DisplayFor(model => model.BarCodesNum)
                    @Html.ValidationMessageFor(model => model.BarCodesNum, "", new { @class = "text-danger" })
                </div>
            </div>

            <div class="form-group">
                <label class="control-label col-md-4 col-xs-5">挪用条码</label>
                <div class="col-md-8 col-xs-7 labelright">
                    @ViewBag.nuoBarcode
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.ModuleGroupNum, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7 labelright">
                    @Html.DisplayFor(model => model.ModuleGroupNum, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.ModuleGroupNum, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.CustomerBarCodesNum, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7 labelright">
                    @Html.DisplayFor(model => model.CustomerBarCodesNum)
                    @Html.ValidationMessageFor(model => model.CustomerBarCodesNum, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.OQCCheckBT, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7 labelright">
                    @Html.DisplayFor(model => model.OQCCheckBT)
                    @*@Html.EditorFor(model => model.OQCCheckBT, new { htmlAttributes = new { @class = "form-control" } })*@
                    @Html.ValidationMessageFor(model => model.OQCCheckBT, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.Remark, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7">
                    @Html.EditorFor(model => model.Remark, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Remark, "", new { @class = "text-danger" })

                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.RepairCondition, htmlAttributes: new { @class = "control-label col-md-4 col-xs-5" })
                <div class="col-md-8 col-xs-7">
                    @Html.DropDownListFor(model => model.RepairCondition,
           ViewBag.RepairList as IEnumerable<SelectListItem>, new { @class = "form-control" })
                    @*@Html.EditorFor(model => model.RepairCondition, new { htmlAttributes = new { @class = "form-control" } })*@
                    @Html.ValidationMessageFor(model => model.RepairCondition, "", new { @class = "text-danger test" })
                </div>
            </div>
            @* 打印功能 *@
            <div class="form-group">
                <label class="control-label col-md-4 col-xs-5">选择打印机</label>
                <div class="col-md-8 col-xs-7">
                    <el-select v-model="printSelect" clearable placeholder="选择打印机" size="medium" style="width:100%">
                        <el-option v-for="item in printOptions"
                                   :key="item.value"
                                   :label="item.label"
                                   :value="item.value">
                        </el-option>
                    </el-select>
                </div>
            </div>
            <div class="form-group" v-show="printSelect!='0'&&printSelect!=''">
                <label class="control-label col-md-4 col-xs-5">打印浓度</label>
                <div class="col-md-8 col-xs-7">
                    <el-slider :max="30"
                               :min="-30"
                               v-model="nongDu"></el-slider>
                </div>
            </div>
            <div class="form-group" v-show="printSelect!='0'&&printSelect!=''">
                <label class="control-label col-md-4 col-xs-5">打印数量</label>
                <div class="col-md-8 col-xs-7">
                    <el-input-number v-model.trim="pageCount"
                                     size="medium"
                                     :min="1"
                                     :max="5"
                                     style="width:100%;"
                                     clearable>
                    </el-input-number>
                </div>
            </div>
            @* 模组号顺序选择开关 *@
            <div class="form-group mozushow" style="display:none">
                <label class="control-label col-md-4 col-xs-5">模组号顺序</label>
                <div class="col-md-8 col-xs-7">
                    <el-switch v-model="reverse"
                               active-text="倒序"
                               inactive-text="正序">
                    </el-switch>
                </div>
            </div>
            @* 读取模组号方式开关 *@
            <div class="form-group mozushow" style="display:none">
                <label class="control-label col-md-4 col-xs-5">读取模组号</label>
                <div class="col-md-8 col-xs-7 mozuswitch">
                    <el-switch v-model="selectModule"
                               active-text="原模组号"
                               inactive-text="规则模组号">
                    </el-switch>
                </div>
            </div>
            @* 模组号框 *@
            <div class="form-group mozushow" style="display:none">
                <label class="control-label col-md-4 col-xs-5">模组号</label>
                <div class="col-md-8 col-xs-7">
                    @*<input id="newmozu" v-model.trim="newmozu" name="ModuleGroupNum" type="text" class="form-control text-box single-line">*@
                    <el-autocomplete id="newmozu"
                                     v-model.trim="newmozu"
                                     :fetch-suggestions="querySearch"
                                     :popper-append-to-body="false"
                                     :trigger-on-focus="false"
                                     :debounce="0"
                                     name="ModuleGroupNum"
                                     placeholder="输入内容可查询"
                                     highlight-first-item
                                     size="medium"
                                     clearable></el-autocomplete>
                </div>
            </div>
            @* 是否打印 *@
            <div class="form-group mozushow" style="display:none">
                <label class="control-label col-md-4 col-xs-5">是否打印</label>
                <div class="col-md-8 col-xs-7 mozuswitch">
                    <el-switch v-model="isPrint"
                               active-text="不打印"
                               inactive-text="打印">
                    </el-switch>
                </div>
            </div>

            <div id="AbnormalShow" class="form-group" style="display:none">
                @Html.LabelFor(model => model.Appearance_OQCCheckAbnormal, htmlAttributes: new { @class = "control-label col-md-4" })
                <div class="col-md-8">
                    @*<textarea v-model="abnormalarea" style="width:280px;height:100px;"></textarea>*@
                    @Html.EditorFor(model => model.Appearance_OQCCheckAbnormal, new { htmlAttributes = new { @class = "form-control", @style = "display:none" } })
                    <div class="abnormalFrame">
                        <ol>
                            <li v-for="abnormal in abnormalarea">
                                {{abnormal}}
                            </li>
                        </ol>
                    </div>
                    @Html.ValidationMessageFor(model => model.Appearance_OQCCheckAbnormal, "", new { @class = "text-danger" })
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-offset-4 col-md-8">
                    <button class="btn btn-default" v-on:click.prevent.stop="printPost">结束外观包装</button>
                    <input id="fsubmit" type="submit" value="结束外观包装" class="btn btn-default hidden" />
                </div>
            </div>
            <div class="hidden-xs">
                @Html.ActionLink("返回", "Appearance_B")
            </div>
        </div>
        @* 异常列表 *@
        <div id="AbnormalTable" class="col-md-offset-1 col-md-7">
            <br class="hidden-xs" /><br />
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h6 class="panel-title">异常列表</h6>
                </div>
                <div class="panel-body">
                    <div class="col-md-6">
                        <table class="table">
                            <tr><th colspan="4">螺丝</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="2" value="（螺丝）-漏打" v-model="abnormalarea">
                                    <label for="2">漏打</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="3" value="（螺丝）-不到位" v-model="abnormalarea">
                                    <label for="3">不到位</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="4" value="（螺丝）-打滑" v-model="abnormalarea">
                                    <label for="4">打滑</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="5" value="（螺丝）-用错" v-model="abnormalarea">
                                    <label for="5">用错</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="4">标识/铭牌/唛头</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="9" value="（标识/铭牌/唛头）-漏贴" v-model="abnormalarea">
                                    <label for="9">漏贴</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="10" value="（标识/铭牌/唛头）-贴歪" v-model="abnormalarea">
                                    <label for="10">贴歪</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="11" value="（标识/铭牌/唛头）-贴错" v-model="abnormalarea">
                                    <label for="11">贴错</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="48" value="（标识/铭牌/唛头）-翘角" v-model="abnormalarea">
                                    <label for="48">翘角</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="3">R/G/B/W/扫描确认</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="6" value="（R/G/B/W/扫描确认）-扫描不良" v-model="abnormalarea">
                                    <label for="6">扫描不良</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="7" value="（R/G/B/W/扫描确认）-掉灯" v-model="abnormalarea">
                                    <label for="7">掉灯</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="8" value="（R/G/B/W/扫描确认）-瞎灯" v-model="abnormalarea">
                                    <label for="8">瞎灯</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="47" value="（R/G/B/W/扫描确认）-偏色" v-model="abnormalarea">
                                    <label for="47">偏色</label>
                                </td>
                                <td colspan="2">
                                    <input type="checkbox" id="46" value="（R/G/B/W/扫描确认）-暗斑" v-model="abnormalarea">
                                    <label for="46">暗斑</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="100" value="（R/G/B/W/扫描确认）-瞎条" v-model="abnormalarea">
                                    <label for="100">瞎条</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="101" value="（R/G/B/W/扫描确认）-亮点" v-model="abnormalarea">
                                    <label for="101">亮点</label>
                                </td>
                                <td colspan="2">
                                    <input type="checkbox" id="102" value="（R/G/B/W/扫描确认）-亮条" v-model="abnormalarea">
                                    <label for="102">亮条</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="103" value="（R/G/B/W/扫描确认）-色块" v-model="abnormalarea">
                                    <label for="103">色块</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="3">电源线/信号线</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="51" value="（电源线/信号线）-扎线不一致" v-model="abnormalarea">
                                    <label for="51">扎线不一致</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="52" value="（电源线/信号线）-未插到位" v-model="abnormalarea">
                                    <label for="52">未插到位</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="53" value="（电源线/信号线）-破损" v-model="abnormalarea">
                                    <label for="53">破损</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="54" value="（电源线/信号线）-端子脱落" v-model="abnormalarea">
                                    <label for="54">端子脱落</label>
                                </td>
                                <td colspan="2">
                                    <input type="checkbox" id="55" value="（电源线/信号线）-错材" v-model="abnormalarea">
                                    <label for="55">错材</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="3">门锁/箱门</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="33" value="（门锁/箱门）-方向不一致" v-model="abnormalarea">
                                    <label for="33">方向不一致</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="34" value="（门锁/箱门）-锁不牢" v-model="abnormalarea">
                                    <label for="34">锁不牢</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="35" value="（门锁/箱门）-漏装" v-model="abnormalarea">
                                    <label for="35">漏装</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="3">胶条/胶垫</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="37" value="（胶条/胶垫）-没装到位" v-model="abnormalarea">
                                    <label for="37">没装到位</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="38" value="（胶条/胶垫）-错材" v-model="abnormalarea">
                                    <label for="38">错材</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="50" value="（胶条/胶垫）-漏装" v-model="abnormalarea">
                                    <label for="50">漏装</label>
                                </td>
                            </tr>
                        </table>

                        <table class="table">
                            <tr><th colspan="3">LOGO</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="12" value="（LOGO）-刮花" v-model="abnormalarea">
                                    <label for="12">刮花</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="13" value="（LOGO）-丝印错误" v-model="abnormalarea">
                                    <label for="13">丝印错误</label>
                                </td>

                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="14" value="（LOGO）-丝印不良" v-model="abnormalarea">
                                    <label for="14">丝印不良</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="49" value="（LOGO）-颜色错误" v-model="abnormalarea">
                                    <label for="49">颜色错误</label>
                                </td>
                            </tr>
                        </table>

                        <table class="table">
                            <tr><th colspan="2">清洁</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="31" value="（清洁）-内部异物" v-model="abnormalarea">
                                    <label for="31">内部异物</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="32" value="（清洁）-外部异物" v-model="abnormalarea">
                                    <label for="32">外部异物</label>
                                </td>
                            </tr>
                            <tr><th colspan="2">三防</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="29" value="（三防）-漏刷" v-model="abnormalarea">
                                    <label for="29">漏刷</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="30" value="（三防）-气泡" v-model="abnormalarea">
                                    <label for="30">气泡</label>
                                </td>
                            </tr>

                        </table>
                    </div>
                    <div class="col-md-6">
                        <table class="table">
                            <tr><th colspan="3">电源/系统卡</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="16" value="（电源/系统卡）-错材" v-model="abnormalarea">
                                    <label for="16">错材</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="17" value="（电源/系统卡）-松动" v-model="abnormalarea">
                                    <label for="17">松动</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="15" value="（电源/系统卡）-死卡" v-model="abnormalarea">
                                    <label for="15">死卡</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="3">磁环</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="56" value="（磁环）-漏装" v-model="abnormalarea">
                                    <label for="56">漏装</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="57" value="（磁环）-错材" v-model="abnormalarea">
                                    <label for="57">错材</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="58" value="（磁环）-脱落" v-model="abnormalarea">
                                    <label for="58">脱落</label>
                                </td>
                            </tr>
                            <tr><th colspan="3">指示灯</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="59" value="（指示灯）-不一致" v-model="abnormalarea">
                                    <label for="59">不一致</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="60" value="（指示灯）-破损" v-model="abnormalarea">
                                    <label for="60">破损</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="61" value="（指示灯）-灯扭" v-model="abnormalarea">
                                    <label for="61">灯扭</label>
                                </td>
                            </tr>
                            <tr><th colspan="3">定位销</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="62" value="（定位销）-漏装" v-model="abnormalarea">
                                    <label for="62">漏装</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="63" value="（定位销）-未装到位" v-model="abnormalarea">
                                    <label for="63">未装到位</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="64" value="（定位销）-错材" v-model="abnormalarea">
                                    <label for="64">错材</label>
                                </td>
                            </tr>
                            <tr><th colspan="3">钢丝绳</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="65" value="（钢丝绳）-漏装" v-model="abnormalarea">
                                    <label for="65">漏装</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="66" value="（钢丝绳）-未装到位" v-model="abnormalarea">
                                    <label for="66">未装到位</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="67" value="（钢丝绳）-错材" v-model="abnormalarea">
                                    <label for="67">错材</label>
                                </td>
                            </tr>
                            <tr><th colspan="3">安装板/挡板</th></tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="68" value="（安装板/挡板）-漏装" v-model="abnormalarea">
                                    <label for="68">漏装</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="69" value="（安装板/挡板）-错材" v-model="abnormalarea">
                                    <label for="69">错材</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="70" value="（安装板/挡板）-松动" v-model="abnormalarea">
                                    <label for="70">松动</label>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <tr><th colspan="2">其它</th></tr>
                            <tr>
                                <td colspan="2">
                                    <input type="checkbox" id="71" value="扫码显示箱体编号与实贴箱体编号不符" v-model="abnormalarea">
                                    <label for="71">扫码显示箱体编号与实贴箱体编号不符</label>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <input type="checkbox" id="20" value="组装FQC未完成" v-model="abnormalarea">
                                    <label for="20">组装FQC未完成</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="22" value="灯面防护不良" v-model="abnormalarea">
                                    <label for="22">灯面防护不良</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="26" value="老化未完成" v-model="abnormalarea">
                                    <label for="26">老化未完成</label>
                                </td>

                                <td>
                                    <input type="checkbox" id="24" value="零器件脱落" v-model="abnormalarea">
                                    <label for="24">零器件脱落</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="19" value="校正未完成" v-model="abnormalarea">
                                    <label for="19">校正未完成</label>
                                </td>

                                <td>
                                    <input type="checkbox" id="18" value="内外箱体编号不一致" v-model="abnormalarea">
                                    <label for="18" style="font-size:12px">内外箱体编号不一致</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="72" value="划痕" v-model="abnormalarea">
                                    <label for="72">划痕</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="45" value="高低差/亮暗线/错误超标" v-model="abnormalarea">
                                    <label for="45" style="font-size:12px">高低差/亮暗线/错误超标</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="21" value="模块方向错误" v-model="abnormalarea">
                                    <label for="21">模块方向错误</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="73" value="模组颜色不一致" v-model="abnormalarea">
                                    <label for="73">模组颜色不一致</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" id="25" value="后盖压线" v-model="abnormalarea">
                                    <label for="25">后盖压线</label>
                                </td>
                                <td>
                                    <input type="checkbox" id="23" value="模块压线" v-model="abnormalarea">
                                    <label for="23">模块压线</label>
                                </td>
                            </tr>
                        </table>
                        <table></table>
                    </div>

                </div>
            </div>
        </div>
        <div class="visible-xs">
            @Html.ActionLink("返回", "Appearance_B")
        </div>
        @*//防位移*@
        <div class="form-group"><div class="col-md-offset-2 col-md-8"></div></div>
    </div>
}



@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        var app = new Vue({
            el: "#app",
            data: {
                loading: false,
                abnormalarea: [],//存储选择的异常信息
                selectrepair: "",//存储维修情况的值
                newmozu: "",//模组号值
                printOptions: printIpAddress,//打印地址下拉列表
                printSelect: '',//打印地址值
                pageCount: "2",//打印页数
                nongDu: 30,//打印浓度
                reverse: false,//读取模组规则顺序 开关
                selectModule: false,//读取模组号方式 开关
                moduleList: [],//模组号规则列表
                isPrint: false
            },
            created: function () {
                //维修默认值为正常
                $('#Appearance_OQCCheckAbnormal').attr('value', "正常");
            },
            mounted: function () {
                this.loading = true;
                //是否打印
                let localisprint = localStorage.getItem('isPrint');
                if (localisprint != null) {
                    if (localisprint == "true") {
                        this.isPrint = true;
                    } else {
                        this.isPrint = false;
                    };
                };
                //获取浏览器本地存储的打印机ip
                let printIP = localStorage.getItem('printIP');
                if (printIP != null) {
                    this.printSelect = printIP;
                };
                //获取浏览器本地存储的模组读取顺序
                let localreverse = localStorage.getItem('getMozureverse');
                if (localreverse != null) {
                    this.reverse = localreverse == 'true' ? true : false;
                };
                //获取浏览器本地存储的读取模组号方式
                let localselectModule = localStorage.getItem('getMozuselectModule');
                if (localselectModule != null) {
                    this.selectModule = localselectModule == 'true' ? true : false;
                };
                //获取浏览器本地存储的打印页数
                let localpage = localStorage.getItem('printPageCount');
                if (localpage != null) {
                    this.pageCount = localpage;
                };
                //获取浏览器本地存储的打印浓度
                let localnongdu = localStorage.getItem('printNongDuCount');
                if (localnongdu != null) {
                    this.nongDu = +localnongdu;
                };
                //执行判断是否显示模组输入框方法，获取模组号数据
                this.showmozu();
            },
            watch: {
                //监听是否打印
                isPrint(v) {
                    localStorage.setItem('isPrint', v);
                },
                //监听维修情况，显示异常列表清单方法
                selectrepair: function (val) {
                    this.loading = true;
                    if (val == "正常") {
                        $("#AbnormalShow").hide();
                        $("#AbnormalTable").hide();
                        this.abnormalarea = ["正常"];
                        this.showmozu();
                    } else {
                        $("#AbnormalShow").show();
                        $("#AbnormalTable").show();
                        this.abnormalarea = [];
                        $(".mozushow").hide();
                        this.loading = false;
                    };
                },
                //监听异常清单值
                abnormalarea: function (val) {
                    $('#Appearance_OQCCheckAbnormal').attr('value', val);
                },
                //监听打印机地址值
                printSelect: (v) => {
                    localStorage.setItem('printIP', v);
                },
                //监听读取模组规则顺序
                reverse: function (v) {
                    localStorage.setItem('getMozureverse', v);
                    this.showmozu();
                },
                //监听读取模组号方式
                selectModule: function (v) {
                    localStorage.setItem('getMozuselectModule', v);
                    this.showmozu();
                }

            },
            methods: {
                //是否显示模组框，若显示则读取模组号
                showmozu: function () {
                    //判断模组号是否为空
                    //if ($("#ModuleGroupNum").val() == "") {
                    //显示输入框
                    $(".mozushow").show();
                    //读取规则模组号
                    axios.post('/Packagings/SelectModule', {
                        ordenum: $("#OrderNum").val(),
                        barcode: $("#BarCodesNum").val(),
                        reverse: this.reverse,
                        selectModule: this.selectModule,
                    }).then(res => {
                        //console.log(res.data);
                        this.newmozu = res.data.mudule;
                        this.moduleList = res.data.moduleList == null ? [] : res.data.moduleList;
                        this.loading = false;
                        $("#newmozu").select();
                    }).catch(err => {
                        console.warn("失败");
                        this.loading = false;
                        $("#newmozu").select();
                    });
                    //} else {
                    //    this.loading = false;
                    //};
                },
                //判断是否可以结束电检方法
                printPost: function () {
                    //$("#fsubmit").click();
                    this.loading = true;
                    let pageNum = this.pageCount;
                    let nongDu = this.nongDu;
                    if (pageNum < 0 || pageNum > 5 || pageNum == "") {
                        alert("打印的数量要在0~5之间！");
                        this.loading = false;
                        return;
                    };
                    localStorage.setItem('printPageCount', pageNum);
                    localStorage.setItem('printNongDuCount', nongDu);
                    //维修情况
                    let repair = this.selectrepair;
                    //存新箱体号
                    let module = this.newmozu;
                    //if ($("#ModuleGroupNum").val() == "") {
                    if (module == "") {
                        if (!confirm("模组号为空，是否继续？")) {
                            this.loading = false;
                            return;
                        } else {
                            this.print();
                        };
                    } else {
                        if (repair == "正常" || repair == "") {
                            //记录模组号
                            //$("#ModuleGroupNum").val(module);
                            axios.post('/Appearances/AddModuleFromAppearance_F', {
                                barcodes: $("#BarCodesNum").val(),
                                mudule: module,
                            }).then(res => {
                                this.print();
                                //console.log(res.data)
                            }).catch(err => {
                                console.warn("连接失败")
                            });
                        } else {
                            this.print();
                        };
                    };
                    //} else {
                    //    this.print();
                    //};
                },
                //打印方法
                print: function () {
                    if (this.isPrint) {
                        $("#fsubmit").click();
                        return;
                    };
                    //打印和完成
                    let repair = this.selectrepair;
                    let localIP = this.printSelect;
                    if (repair == "正常" || repair == "") {
                        if (localIP != "0" && localIP != "") {  // 已选打印机
                            axios.post('/Appearances/InsideBoxLablePrint', {
                                barcode: $("#BarCodesNum").val(),
                                modulenum: this.newmozu,
                                pagecount: this.pageCount,
                                concentration: this.nongDu,
                                ip: localIP,//ip地址
                                port: 9101,//端口
                            }).then(res => {
                                //console.log(res.data)
                                if (res.data == "打印成功！") {
                                    $("#fsubmit").click();
                                } else {
                                    $("#fsubmit").click();
                                    //let r = confirm(`打印失败,是否继续结束外观包装？\n 错误提示：${res.data}`);
                                    //if (r == true) {
                                    //    $("#fsubmit").click();
                                    //};
                                };
                            }).catch(err => {
                                $("#fsubmit").click();
                                console.warn("连接失败")
                            });
                        } else {    // 未选打印机--可以完成包装但不打印
                            //let r = confirm(`打印失败,是否继续结束外观包装？\n 错误提示：未选择打印机`);
                            //if (r == true) {
                            $("#fsubmit").click();
                            //}
                        };
                    } else {
                        $("#fsubmit").click();
                    };
                },
                //模组号规则的列表搜索方法
                querySearch(queryString, cb) {
                    let restaurants = this.moduleList;
                    let results = queryString ? restaurants.filter(this.createFilter(queryString)) : restaurants;
                    // 调用 callback 返回建议列表的数据
                    cb(results);
                },
                //模组号规则的列表过滤方法
                createFilter(queryString) {
                    return (restaurant) => {
                        return (restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) > -1);
                    };
                }
            }
        });
        //维修状态值改变则赋值
        $("#RepairCondition").change(function (v) {
            app.selectrepair = $(this).val();
        });

    </script>
}
