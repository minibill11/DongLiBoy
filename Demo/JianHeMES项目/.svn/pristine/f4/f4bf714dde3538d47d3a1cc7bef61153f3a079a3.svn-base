
@{
    ViewBag.Title = "EquipmentRepairbill";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
<script src="~/Scripts/axios.min.js"></script>
<script src="~/Scripts/Bootstraps/Element-ui.js"></script>
<style>
    table tr th{
        text-align:center;
    }
    .el-date-editor{
        width:100% !important;
        height:100%;
    }
    .el-textarea{
        width:100% !important;
        height:100%;
    }
    textarea{
        max-width: 1112px !important;
    }
    input{
        max-width: 382px !important;
    }
    .el-radio-group{
        vertical-align:baseline !important;
    }
    .searchContainer{
        text-align:center;
    }
    .searchContainer .el-date-editor{
        
        width:150px !important;
    }
    .searchContainer .el-input__inner{
        width:150px !important;
    }
    .color{
        color:blue;
    }
</style>
<h4 style="text-align:center;">仪器设备保修单</h4>

<div id="app">
    @*<div class="searchContainer">
        <el-date-picker v-model="selectTime"
                        type="date"
                        size="small"
                        placeholder="选择日期">
        </el-date-picker>
        
    </div>*@
    <table style="width:100%;" border="1">
        <thead>
            <tr style="height:40px;">
                <th>设备名称</th>
                <th colspan="2">{{EquipmentName}}</th>
                <th>设备编号</th>
                <th colspan="2">{{assetNumber}}</th>
                <th>故障时间</th>
                <th colspan="2">
                    <el-date-picker v-model="guzhangtime"
                                    v-bind:disabled="disableOrNot.tr11"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </th>
                <th>紧急状态</th>
                <th colspan="3">
                    <el-input v-model="mergencyStatus" v-bind:disabled="disableOrNot.tr12" placeholder="请输入内容"></el-input>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr style="height:130px;">
                <td style="text-align:center;">故障描述:</td>
                <td colspan="11">
                    <el-input type="textarea" id="areaSelect" v-bind:disabled="disableOrNot.tr21" v-model="guzhangDiscri" v-bind:autosize="{ minRows: 5, maxRows: 6}"></el-input>
                </td>
            </tr>
            <tr style="height:35px;">
                <td>维修人员</td>
                <td>
                    <el-input v-model="repairWorker" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td colspan="1">
                    <el-date-picker v-model="repiarDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>主管经理审核</td>
                <td colspan="1">
                    <el-select id="tr33" v-bind:disabled="disableOrNot.tr33" v-model="jinglizhuguanOpinon" placeholder="请选择">
                        <el-option v-for="item in options"
                                   v-bind:key="item.value"
                                   v-bind:label="item.label"
                                   v-bind:value="item.value">
                        </el-option>
                    </el-select>
                </td>
                <td colspan="2">
                    <el-date-picker id="tr34" v-bind:disabled="disableOrNot.tr34" v-model="bumenpizhunate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>中心总监批准</td>
                <td colspan="1">
                    <el-select id="tr35" v-bind:disabled="disableOrNot.tr35" v-model="zhongxinzongjianOpinon" placeholder="请选择">
                        <el-option v-for="item in options"
                                   v-bind:key="item.value"
                                   v-bind:label="item.label"
                                   v-bind:value="item.value">
                        </el-option>
                    </el-select>
                </td>
                <td colspan="2">
                    <el-date-picker id="tr36" v-bind:disabled="disableOrNot.tr36" v-model="zhongxinpizhunDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
            </tr>

            <tr style="height:130px;">
                <td style="text-align:center;">技术部意见:</td>
                <td colspan="11">
                    <el-input type="textarea" id="tr41" v-bind:disabled="disableOrNot.tr41" v-model="jishubuOpinon" v-bind:autosize="{ minRows: 5, maxRows: 6}"></el-input>
                </td>
            </tr>
            <tr style="height:35px;">
                <td>ME工程师</td>
                <td colspan="1">
                    <el-input id="tr51" v-bind:disabled="disableOrNot.tr51" v-model="MEWorker" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td colspan="1">
                    <el-date-picker id="tr52" v-bind:disabled="disableOrNot.tr52" v-model="MEgivenOpinonDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>主管经理审核</td>
                <td colspan="1">
                    <el-select id="tr53" v-bind:disabled="disableOrNot.tr53" v-model="jinglizhuguanshenhe" placeholder="请选择">
                        <el-option v-for="item in options"
                                   v-bind:key="item.value"
                                   v-bind:label="item.label"
                                   v-bind:value="item.value">
                        </el-option>
                    </el-select>
                </td>
                <td colspan="2">
                    <el-date-picker id="tr54" v-bind:disabled="disableOrNot.tr54" v-model="jinglizhuguanshenheDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>中心总监批准</td>
                <td colspan="1">
                    <el-select id="tr55" v-bind:disabled="disableOrNot.tr55" v-model="zhongxinzongjianpizhun" placeholder="请选择">
                        <el-option v-for="item in options"
                                   v-bind:key="item.value"
                                   v-bind:label="item.label"
                                   v-bind:value="item.value">
                        </el-option>
                    </el-select>
                </td>
                <td colspan="2">
                    <el-date-picker id="tr56" v-bind:disabled="disableOrNot.tr56" v-model="zhongxinzongjianpizhunDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
            </tr>

            <tr style="height:130px;">
                <td style="text-align:center;">联建采购意见:</td>
                <td colspan="11">
                    <el-input type="textarea" id="tr61" v-bind:disabled="disableOrNot.tr61" v-model="jianliancaigoujianyi" v-bind:autosize="{ minRows: 5, maxRows: 6}"></el-input>
                </td>
            </tr>
            <tr style="height:35px;">
                <td>意见人</td>
                <td>
                    <el-input id="tr71" v-bind:disabled="disableOrNot.tr71" v-model="caigoujianyiren" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td>
                    <el-date-picker id="tr72" v-bind:disabled="disableOrNot.tr72" v-model="caigoujianyiDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>审核人</td>
                <td>
                    <el-input id="tr73" v-bind:disabled="disableOrNot.tr73" v-model="caogoushenheren" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td>
                    <el-date-picker id="tr74" v-bind:disabled="disableOrNot.tr74" v-model="caigoushenheDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>批准人</td>
                <td>
                    <el-input id="tr75" v-bind:disabled="disableOrNot.tr75" v-model="caigoupizhunren" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td>
                    <el-date-picker id="tr76" v-bind:disabled="disableOrNot.tr76" v-model="caigoupizhunriqi"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
            </tr>

            <tr style="height:40px;">
                <td colspan="2">维修时间</td>
                <td colspan="4">
                    <el-date-picker id="tr81" v-bind:disabled="disableOrNot.tr81" v-model="weixiuDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td colspan="2">维修人/厂家</td>
                <td colspan="4">
                    <el-input id="tr82" v-bind:disabled="disableOrNot.tr82" v-model="weixiuWorker" placeholder="请输入内容"></el-input>
                </td>
            </tr>
            <tr>
                <td colspan="6">维修后效果确认（维修需求部门）</td>
                <td colspan="6">维修后效果确认（技术部）</td>
            </tr>
            <tr style="height:120px;">
                <td colspan="6">
                    <el-input type="textarea" id="tr101" v-bind:disabled="disableOrNot.tr101" v-model="xuqiubumenWrite" v-bind:autosize="{ minRows: 5, maxRows: 6}"></el-input>
                </td>
                <td colspan="6">
                    <el-input type="textarea" id="tr102" v-bind:disabled="disableOrNot.tr102" v-model="jishubumenWrite" v-bind:autosize="{ minRows: 5, maxRows: 6}" ></el-input>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    保修问题是否解决
                </td>
                <td colspan="4">
                    <el-radio-group id="tr111" v-bind:disabled="disableOrNot.tr111" v-model="xuqiubumenComfirm">
                        <el-radio v-bind:label="true">是</el-radio>
                        <el-radio v-bind:label="false">否</el-radio>
                    </el-radio-group>
                </td>
                <td colspan="2">
                    保修问题是否解决
                </td>
                <td colspan="4">
                    <el-radio-group id="tr112" v-bind:disabled="disableOrNot.tr112" v-model="jishuubumenComfirm">
                        <el-radio v-bind:label="true">是</el-radio>
                        <el-radio v-bind:label="false">否</el-radio>
                    </el-radio-group>
                </td>
            </tr>
            <tr>
                <td>确认人</td>
                <td colspan="2">
                    <el-input id="tr121" v-bind:disabled="disableOrNot.tr121" v-model="xuqiubumenquerenren" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td colspan="2">
                    <el-date-picker id="tr122" v-bind:disabled="disableOrNot.tr122" v-model="xuqiubumenquerenDate"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
                <td>确认人</td>
                <td colspan="2">
                    <el-input id="tr123" v-bind:disabled="disableOrNot.tr123" v-model="jishubuquerenren" placeholder="请输入内容"></el-input>
                </td>
                <td>日期</td>
                <td colspan="3">
                    <el-date-picker id="tr124" v-bind:disabled="disableOrNot.tr124" v-model="jishubuquerenshijian"
                                    type="datetime"
                                    placeholder="选择日期时间">
                    </el-date-picker>
                </td>
            </tr>
        </tbody>
    </table>
    <div style="display:flex;justify-content:space-between;">
        <el-button style="margin-left:0;" size="small" type="primary" v-on:click="goback">返回</el-button>
        <el-button size="small" v-show="showChangeBtn" type="success" v-on:click="saveChange">保存修改</el-button>
        <el-button size="small" v-show="showAddBtn" type="success" v-on:click="addNewForm">新建报修单</el-button>
    </div>
</div>

<script>
    
    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
    }
    
    // 获取权限列表
    let rigths = JSON.parse(localStorage.getItem("rigths"));
    function checkRoles(list, roleName) {   //检测权限
        var flag = false
        if (list && roleName) {
            for (let item in list) {
                if (list[item] == roleName) {
                    flag = true
                }
            }
        }
        return flag
    }
    console.log(rigths)
    console.log(checkRoles(rigths, "故障简述"))
    


    let app = new Vue({
        el: "#app",
        data: {
            canChange: null,
            Times:null,
            showChangeBtn: false,
            showAddBtn: false,
            selectTime: null,
            radio2: null,

            assetNumber: null,
            EquipmentName: null,
            guzhangtime: null,
            mergencyStatus: null,
            guzhangDiscri: null,
            repairWorker: null,
            repiarDate: null,
            jinglizhuguanOpinon: null,
            zhongxinpizhunDate: null,
            zhongxinzongjianOpinon: null,
            bumenpizhunate: null,
            jishubuOpinon: null,
            MEgivenOpinonDate: null,
            jinglizhuguanshenhe: null,
            jinglizhuguanshenheDate: null,
            zhongxinzongjianpizhun: null,
            zhongxinzongjianpizhunDate: null,
            jianliancaigoujianyi: null,
            caigoujianyiren: null,
            MEWorker: null,
            caigoujianyiDate: null,
            caogoushenheren: null,
            caigoushenheDate: null,
            caigoupizhunren: null,
            caigoupizhunriqi: null,
            weixiuDate: null,
            weixiuWorker: null,
            xuqiubumenWrite: null,
            jishubumenWrite: null,
            xuqiubumenComfirm: null,
            jishuubumenComfirm: null,
            xuqiubumenquerenren: null,
            xuqiubumenquerenDate: null,
            jishubuquerenren: null,
            jishubuquerenshijian: null,
            input: null,

            options: [{
                value: '批准',
                label: '批准'
            }, {
                value: '驳回',
                label: '驳回'
            }],
            value: '',
            disableOrNot: {
                tr11: false,
                tr12: false,
                tr21: false,
                tr33: false,
                tr34: false,
                tr35: false,
                tr36: false,
                tr41: false,
                tr51: false,
                tr52: false,
                tr53: false,
                tr54: false,
                tr55: false,
                tr56: false,
                tr61: false,
                tr71: false,
                tr72: false,
                tr73: false,
                tr74: false,
                tr75: false,
                tr76: false,
                tr81: false,
                tr82: false,
                tr101: false,
                tr102: false,
                tr111: false,
                tr112: false,
                tr121: false,
                tr122: false,
                tr123: false,
                tr124: false,
            }
        },
        methods: {
            goback() {
                window.history.back();
            },
            saveChange() {
                axios.post("/Equipment/Modify_repairs", {
                    EquipmentNumber: this.assetNumber, EquipmentName: this.EquipmentName, FaultTime: this.guzhangtime, Emergency: this.mergencyStatus, FauDescription: this.guzhangDiscri, RepairName: this.repairWorker,
                    RepairDate: this.repiarDate, DeparAssessor: this.jinglizhuguanOpinon, DeparAssessedDate: this.bumenpizhunate, CenterApprove: this.zhongxinzongjianOpinon, CenterApprovedDate: this.zhongxinpizhunDate,
                    TecDepar_opinion: this.jishubuOpinon, MEName: this.MEWorker, MEDate: this.MEgivenOpinonDate, TecDeparAssessor: this.jinglizhuguanshenhe, TecDeparAssessedDate: this.jinglizhuguanshenheDate, CeApprove: this.zhongxinzongjianpizhun,
                    CeApprovedDate: this.zhongxinzongjianpizhunDate, Purchasing_opinion: this.jianliancaigoujianyi, OpinionName: this.caigoujianyiren, OpinionDate: this.caigoujianyiDate, OpinAssessor: this.caogoushenheren, OpinAssessedDate: this.caigoushenheDate,
                    OpinApprove: this.caigoupizhunren, OpinApprovedDate: this.caigoupizhunriqi, MaintenanceDate: this.weixiuDate, MainName: this.weixiuWorker, AfterMain: this.xuqiubumenWrite, RepairProblem: this.xuqiubumenComfirm,
                    ConfirmName: this.xuqiubumenquerenren, ConfirmDate: this.xuqiubumenquerenDate, TcAfterMin: this.jishubumenWrite, TcRepairProblem: this.jishuubumenComfirm, TcConfirmName: this.jishubuquerenren, TcConfirmDate: this.jishubuquerenshijian
                }).then(res=> {
                    console.log(res.data)
                    if (res.data == true) {
                        this.$message({
                            message: "保存成功！",
                            type: "success"
                        });
                        this.clearData();
                    } else {
                        this.$message({
                            message: "保存修改失败",
                            type: "warning"
                        })
                    }
                }).catch(err=> {
                    this.$message({
                        message: "连接失败",
                        type: "warning"
                    })
                })
            },

            // 定义一个清空数据的方法
            clearData() {
                //this.guzhangtime = null;
                this.mergencyStatus = null;
                this.guzhangDiscri = null
                this.repairWorker = null
                this.repiarDate = null;   // 维修日期
                this.jinglizhuguanOpinon = null;
                this.zhongxinpizhunDate = null;
                this.zhongxinzongjianOpinon = null;
                this.bumenpizhunate = null;
                this.jishubuOpinon = null;
                this.MEWorker = null;
                this.MEgivenOpinonDate = null;
                this.jinglizhuguanshenhe = null;
                this.jinglizhuguanshenheDate = null;
                this.zhongxinzongjianpizhun = null;
                this.zhongxinzongjianpizhunDate = null;
                this.jianliancaigoujianyi = null;
                this.caigoujianyiren = null;
                this.caigoujianyiDate = null;
                this.caogoushenheren = null
                this.caigoushenheDate = null
                this.caigoupizhunren = null
                this.caigoupizhunriqi = null
                this.weixiuDate = null
                this.weixiuWorker = null
                this.xuqiubumenWrite = null
                this.jishubumenWrite = null
                this.xuqiubumenComfirm = null
                this.jishuubumenComfirm = null
                this.xuqiubumenquerenren = null
                this.xuqiubumenquerenDate = null
                this.jishubuquerenren = null
                this.jishubuquerenshijian = null
            },
            //新建报修单
            addNewForm() {
                axios.post("/Equipment/ADDmaintenance", {
                    EquipmentNumber: this.assetNumber, EquipmentName: this.EquipmentName, FaultTime: this.guzhangtime, Emergency: this.mergencyStatus, FauDescription: this.guzhangDiscri, RepairName: this.repairWorker,
                    RepairDate: this.repiarDate, DeparAssessor: this.jinglizhuguanOpinon, DeparAssessedDate: this.bumenpizhunate, CenterApprove: this.zhongxinzongjianOpinon, CenterApprovedDate: this.zhongxinpizhunDate,
                    TecDepar_opinion: this.jishubuOpinon, MEName: this.MEWorker, MEDate: this.MEgivenOpinonDate, TecDeparAssessor: this.jinglizhuguanshenhe, TecDeparAssessedDate: this.jinglizhuguanshenheDate, CeApprove: this.zhongxinzongjianpizhun,
                    CeApprovedDate: this.zhongxinzongjianpizhunDate, Purchasing_opinion: this.jianliancaigoujianyi, OpinionName: this.caigoujianyiren, OpinionDate: this.caigoujianyiDate, OpinAssessor: this.caogoushenheren, OpinAssessedDate: this.caigoushenheDate,
                    OpinApprove: this.caigoupizhunren, OpinApprovedDate: this.caigoupizhunriqi, MaintenanceDate: this.weixiuDate, MainName: this.weixiuWorker, AfterMain: this.xuqiubumenWrite, RepairProblem: this.xuqiubumenComfirm,
                    ConfirmName: this.xuqiubumenquerenren, ConfirmDate: this.xuqiubumenquerenDate, TcAfterMin: this.jishubumenWrite, TcRepairProblem: this.jishuubumenComfirm, TcConfirmName: this.jishubuquerenren, TcConfirmDate: this.jishubuquerenshijian
                }).then(res=> {
                    if (res.data == true) {
                        this.$message({
                            message: "新增设备报修单成功",
                            type: "success"
                        });
                        this.clearData();
                    } else {
                        this.$message({
                            message: res.data,
                            type: "warning"
                        })
                    }
                }).catch(err=> {
                    this.$message({
                        message: "新建报修单时连接失败",
                        type: "warning"
                    })
                })
            }
        },
        mounted() {
            this.assetNumber = getUrlParam('num');
            this.guzhangtime = getUrlParam('time');
            this.canChange = getUrlParam('canchange');
            //console.log(this.canChange)
            if (this.guzhangtime == null) {
                this.showAddBtn = true;
            }
        },
        watch: {
            // 根据资产编号获取设备的信息
            assetNumber() {
                if (this.assetNumber != null) {
                    axios.post("/Equipment/Particulars", { assetnumber: this.assetNumber }).then(res=> {
                        console.log(res.data)
                        this.EquipmentName = res.data[0].EquipmentName
                        this.$message({
                            message: "获取设备详细成功",
                            type: "success"
                        });

                    }).catch(err=> {
                        this.$message({
                            message: "获取设备详细失败",
                            type: "warning"
                        })
                    })
                }
            },
            //选择框时间改变则请求对应报修单数据
            guzhangtime() {
                if (this.guzhangtime != null) {
                    //let dd = new Date(this.selectTime);
                    axios.post("/Equipment/EquipmentRepairbill_Query", { equnumber: this.assetNumber, equipname: this.EquipmentName, date: this.guzhangtime }).then(res=> {
                        console.log(res.data)
                        if (res.data.length > 0) {
                            if (this.canChange == "false") {
                                this.showChangeBtn = false;
                            } else {
                                this.showChangeBtn = true;
                            }
                            
                            this.showAddBtn = false;
                            //赋值
                            this.mergencyStatus = res.data[0].Emergency;
                            this.guzhangDiscri = res.data[0].FauDescription;
                            this.repairWorker = res.data[0].RepairName;
                            this.repiarDate = res.data[0].RepairDate;   // 维修日期
                            this.jinglizhuguanOpinon = res.data[0].DeparAssessor;
                            this.zhongxinpizhunDate = res.data[0].CenterApprovedDate;
                            this.zhongxinzongjianOpinon = res.data[0].CenterApprove;
                            this.bumenpizhunate = res.data[0].DeparAssessedDate;
                            this.jishubuOpinon = res.data[0].TecDepar_opinion;
                            this.MEWorker = res.data[0].MEName;
                            this.MEgivenOpinonDate = res.data[0].MEDate;
                            this.jinglizhuguanshenhe = res.data[0].TecDeparAssessor;
                            this.jinglizhuguanshenheDate = res.data[0].TecDeparAssessedDate;
                            this.zhongxinzongjianpizhun = res.data[0].CeApprovedDate;
                            this.zhongxinzongjianpizhunDate = res.data[0].Purchasing_opinion;
                            this.jianliancaigoujianyi = res.data[0].Purchasing_opinion;
                            this.caigoujianyiren = res.data[0].OpinionName;
                            this.caigoujianyiDate = res.data[0].OpinionDate;
                            this.caogoushenheren = res.data[0].OpinAssessor;
                            this.caigoushenheDate = res.data[0].OpinAssessedDate;
                            this.caigoupizhunren = res.data[0].OpinApprove;
                            this.caigoupizhunriqi = res.data[0].OpinApprovedDate;
                            this.weixiuDate = res.data[0].MaintenanceDate;
                            this.weixiuWorker = res.data[0].MainName;
                            this.xuqiubumenWrite = res.data[0].AfterMain;
                            this.jishubumenWrite = res.data[0].TcAfterMin;
                            this.xuqiubumenComfirm = res.data[0].RepairProblem;
                            this.jishuubumenComfirm = res.data[0].TcRepairProblem;
                            this.xuqiubumenquerenren = res.data[0].ConfirmName;
                            this.xuqiubumenquerenDate = res.data[0].ConfirmDate;
                            this.jishubuquerenren = res.data[0].TcConfirmName;
                            this.jishubuquerenshijian = res.data[0].TcConfirmDate;
                        } else {
                            this.$message({
                                message: "没有对应数据",
                                type: "warning"
                            });
                            this.showChangeBtn = false;
                            this.showAddBtn = true;
                            //this.disableOrNot.tr33 = false;
                            //this.disableOrNot.tr34 = false;
                            //this.disableOrNot.tr35 = false;
                            //this.disableOrNot.tr36 = false;
                            //this.disableOrNot.tr41 = false;
                            //this.disableOrNot.tr51 = false;
                            //this.disableOrNot.tr52 = false;
                            //this.disableOrNot.tr53 = false;
                            //this.disableOrNot.tr54 = false;
                            //this.disableOrNot.tr55 = false;
                            //this.disableOrNot.tr56 = false;
                            //this.disableOrNot.tr61 = false;
                            //this.disableOrNot.tr71 = false;
                            //this.disableOrNot.tr72 = false;
                            //this.disableOrNot.tr73 = false;
                            //this.disableOrNot.tr74 = false;
                            //this.disableOrNot.tr75 = false;
                            //this.disableOrNot.tr76 = false;
                            //this.disableOrNot.tr81 = false;
                            //this.disableOrNot.tr82 = false;
                            //this.disableOrNot.tr101 = false;
                            //this.disableOrNot.tr102 = false;
                            //this.disableOrNot.tr111 = false;
                            //this.disableOrNot.tr112 = false;
                            //this.disableOrNot.tr121 = false;
                            //this.disableOrNot.tr122 = false;
                            //this.disableOrNot.tr123 = false;
                            //this.disableOrNot.tr124 = false
                            this.clearData();
                        }


                    }).catch(err=> {
                        this.$message({
                            message: "获取报修单信息失败",
                            type: "warning"
                        })
                    })
                } else {
                    this.showAddBtn = true;
                    this.showChangeBtn = false;
                    this.clearData();
                }
            },

            showAddBtn() {
                if (this.showAddBtn) {
                    //this.disableOrNot.tr33 = true;
                    //this.disableOrNot.tr34= true;
                    //this.disableOrNot.tr35= true;
                    //this.disableOrNot.tr36= true;
                    //this.disableOrNot.tr41= true;
                    //this.disableOrNot.tr51= true;
                    //this.disableOrNot.tr52= true;
                    //this.disableOrNot.tr53= true;
                    //this.disableOrNot.tr54= true;
                    //this.disableOrNot.tr55= true;
                    //this.disableOrNot.tr56= true;
                    //this.disableOrNot.tr61= true;
                    //this.disableOrNot.tr71= true;
                    //this.disableOrNot.tr72= true;
                    //this.disableOrNot.tr73= true;
                    //this.disableOrNot.tr74= true;
                    //this.disableOrNot.tr75= true;
                    //this.disableOrNot.tr76= true;
                    //this.disableOrNot.tr81= true;
                    //this.disableOrNot.tr82= true;
                    //this.disableOrNot.tr101= true;
                    //this.disableOrNot.tr102= true;
                    //this.disableOrNot.tr111= true;
                    //this.disableOrNot.tr112= true;
                    //this.disableOrNot.tr121= true;
                    //this.disableOrNot.tr122= true;
                    //this.disableOrNot.tr123= true;
                    //this.disableOrNot.tr124= true
                    //$('#tr33').addClass("color")
                    //$('#tr33').attr("disabled", "disabled");
                    //alert("ss")
                } else {
                   // this.disableOrNot.tr33 = false;
                    //this.disableOrNot.tr33 = false;
                    //this.disableOrNot.tr34 = false;
                    //this.disableOrNot.tr35 = false;
                    //this.disableOrNot.tr36 = false;
                    //this.disableOrNot.tr41 = false;
                    //this.disableOrNot.tr51 = false;
                    //this.disableOrNot.tr52 = false;
                    //this.disableOrNot.tr53 = false;
                    //this.disableOrNot.tr54 = false;
                    //this.disableOrNot.tr55 = false;
                    //this.disableOrNot.tr56 = false;
                    //this.disableOrNot.tr61 = false;
                    //this.disableOrNot.tr71 = false;
                    //this.disableOrNot.tr72 = false;
                    //this.disableOrNot.tr73 = false;
                    //this.disableOrNot.tr74 = false;
                    //this.disableOrNot.tr75 = false;
                    //this.disableOrNot.tr76 = false;
                    //this.disableOrNot.tr81 = false;
                    //this.disableOrNot.tr82 = false;
                    //this.disableOrNot.tr101 = false;
                    //this.disableOrNot.tr102 = false;
                    //this.disableOrNot.tr111 = false;
                    //this.disableOrNot.tr112 = false;
                    //this.disableOrNot.tr121 = false;
                    //this.disableOrNot.tr122 = false;
                    //this.disableOrNot.tr123 = false;
                    //this.disableOrNot.tr124 = false
                }
            },

            // 区分是查看详细还是修改
            canChange() {
                if (this.canChange == "false") {  // 详细
                    this.disableOrNot.tr11 = true;
                    this.disableOrNot.tr12 = true;
                    this.disableOrNot.tr21 = true;
                    this.disableOrNot.tr33 = true;
                    this.disableOrNot.tr34 = true;
                    this.disableOrNot.tr35 = true;
                    this.disableOrNot.tr36 = true;
                    this.disableOrNot.tr41 = true;
                    this.disableOrNot.tr51 = true;
                    this.disableOrNot.tr52 = true;
                    this.disableOrNot.tr53 = true;
                    this.disableOrNot.tr54 = true;
                    this.disableOrNot.tr55 = true;
                    this.disableOrNot.tr56 = true;
                    this.disableOrNot.tr61 = true;
                    this.disableOrNot.tr71 = true;
                    this.disableOrNot.tr72 = true;
                    this.disableOrNot.tr73 = true;
                    this.disableOrNot.tr74 = true;
                    this.disableOrNot.tr75 = true;
                    this.disableOrNot.tr76 = true;
                    this.disableOrNot.tr81 = true;
                    this.disableOrNot.tr82 = true;
                    this.disableOrNot.tr101 = true;
                    this.disableOrNot.tr102 = true;
                    this.disableOrNot.tr111 = true;
                    this.disableOrNot.tr112 = true;
                    this.disableOrNot.tr121 = true;
                    this.disableOrNot.tr122 = true;
                    this.disableOrNot.tr123 = true;
                    this.disableOrNot.tr124 = true;
                    this.showChangeBtn = false;
                } else {    //  修改

                }
            }

        }
    });
    if (checkRoles(rigths, "故障简述")) {
        app.disableOrNot.tr21 = false
        app.disableOrNot.tr12 = false
    } else {
        app.disableOrNot.tr21 = true;
        app.disableOrNot.tr12 = true
    }
    if (checkRoles(rigths, "故障审核") && app.guzhangDiscri !=null) {
        app.disableOrNot.tr33 = false
        app.disableOrNot.tr34 = false
    } else {
        app.disableOrNot.tr33 = true;
        app.disableOrNot.tr34 = true
    }
    if (checkRoles(rigths, "故障批准") && app.jinglizhuguanOpinon != null) {
        app.disableOrNot.tr35 = false
        app.disableOrNot.tr36 = false
    } else {
        app.disableOrNot.tr35 = true;
        app.disableOrNot.tr36 = true
    }
    if (checkRoles(rigths, "技术部意见") && app.zhongxinzongjianOpinon != null) {
        app.disableOrNot.tr41 = false
    } else {
        app.disableOrNot.tr41 = true;
    }
    if (checkRoles(rigths, "技术部意见审核") && app.jishubuOpinon != null) {
        app.disableOrNot.tr53 = false
        app.disableOrNot.tr54 = false
    } else {
        app.disableOrNot.tr53 = true;
        app.disableOrNot.tr54 = true
    }
    if (checkRoles(rigths, "技术部意见批准") && app.jinglizhuguanshenhe != null) {
        app.disableOrNot.tr55 = false
        app.disableOrNot.tr56 = false
    } else {
        app.disableOrNot.tr55 = true;
        app.disableOrNot.tr56 = true
    }
    if (checkRoles(rigths, "联建采购意见") && app.zhongxinzongjianpizhun != null) {
        app.disableOrNot.tr61 = false
        
    } else {
        app.disableOrNot.tr61 = true;
    }
    if (checkRoles(rigths, "采购意见审核") && app.jianliancaigoujianyi != null) {
        app.disableOrNot.tr73 = false
        app.disableOrNot.tr74 = false
    } else {
        app.disableOrNot.tr73 = true;
        app.disableOrNot.tr74 = true
    }
    if (checkRoles(rigths, "采购意见批准") && app.caogoushenheren != null) {
        app.disableOrNot.tr75 = false
        app.disableOrNot.tr76 = false
    } else {
        app.disableOrNot.tr75 = true;
        app.disableOrNot.tr76 = true
    }
    if (checkRoles(rigths, "维修人/厂家") && app.caigoupizhunren != null) {
        app.disableOrNot.tr81 = false
        app.disableOrNot.tr82 = false
    } else {
        app.disableOrNot.tr81 = true;
        app.disableOrNot.tr82 = true
    }
    if (checkRoles(rigths, "维修部门确认")) {
        app.disableOrNot.tr101 = false
        app.disableOrNot.tr111 = false
        app.disableOrNot.tr121 = false
        app.disableOrNot.tr122 = false
        //app.disableOrNot.tr82 = false
    } else {
        app.disableOrNot.tr101 = true;
        app.disableOrNot.tr111 = true;
        app.disableOrNot.tr121 = true;
        app.disableOrNot.tr122 = true;
        //app.disableOrNot.tr82 = true
    }
    if (checkRoles(rigths, "维修后技术部确认")) {
        app.disableOrNot.tr102 = false
        app.disableOrNot.tr112 = false
        app.disableOrNot.tr123 = false
        app.disableOrNot.tr124 = false
        //app.disableOrNot.tr82 = false
    } else {
        app.disableOrNot.tr102 = true;
        app.disableOrNot.tr112 = true
        app.disableOrNot.tr123 = true;
        app.disableOrNot.tr124 = true;
        //app.disableOrNot.tr82 = true
    }
</script>