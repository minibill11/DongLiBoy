@model IEnumerable<JianHeMES.Models.Personnel_Quality_objectives>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Scripts/Bootstraps/Element-ui.css" rel="stylesheet" />
<script src="~/Scripts/Bootstraps/Element-ui.js"></script>
<script src="~/Scripts/axios.min.js"></script>
<h2>Index</h2>
<style>
    .titleContainer{
        display:flex;
        justify-content:center;
    }
    .titletext{
        margin-top:5px;
    }
    .el-input{
        width:150px !important;
    }
    table .cell,table td {
        text-align: center;
        padding:2px !important;
    }
</style>
<p>
    @Html.ActionLink("Create New", "Create")
</p>

<div id="app">
    <div class="titleContainer">
        <el-select size="mini" v-model="departments" placeholder="请选择部门">
            <el-option v-for="item in deparList"
                       v-bind:key="item.value"
                       v-bind:label="item.value"
                       v-bind:value="item.value">
            </el-option>
        </el-select>
        <span class="titletext">
            提供
        </span>
        <el-date-picker size="mini"
                        v-model="times"
                        type="month"
                        placeholder="选择月">
        </el-date-picker>
        <span class="titletext">
            月份质量目标达成状况统计表
        </span>
    </div>
    @* "其他部门的表格模板" *@
    <el-table v-bind:data="tableData"
              size="small"
              v-show="others"
              v-bind:span-method="objectSpanMethod"
              style="width: 100%;margin-top:15px;"
              max-height="550"
              border>
        <el-table-column type="index"
                         label="序号"
                         width="44"
                         v-bind:index="indexMethod">
        </el-table-column>
        <el-table-column prop="status"
                         label="部门"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="班组"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="项目"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="指标名称"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="目标值"
                         width="99">
        </el-table-column>
        <el-table-column v-bind:label=`${year}年实际完成值统计`>
            <el-table-column prop="orderSon" width="50" label="1月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="2月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="3月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="4月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="5月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="6月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="7月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="8月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="9月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="10月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="11月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="12月"></el-table-column>
        </el-table-column>
    </el-table>

    @* 行政后勤部的表格模板 *@

    <el-table v-bind:data="tableData"
              size="small"
              v-show="xingzheng"
              v-bind:span-method="objectSpanMethod"
              style="width: 100%;margin-top:15px;"
              max-height="550"
              border>
        <el-table-column type="index"
                         label="序号"
                         width="44"
                         v-bind:index="indexMethod">
        </el-table-column>
        <el-table-column prop="status"
                         label="部门"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="班组"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="7S所属区域"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="指标名称"
                         width="99">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="指标公式/定义"
                         width="99">
        </el-table-column>
        <el-table-column v-bind:label=`${year}年实际完成值统计`>
            <el-table-column prop="orderSon" width="50" label="1月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="2月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="3月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="4月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="5月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="6月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="7月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="8月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="9月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="10月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="11月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="12月"></el-table-column>
        </el-table-column>
    </el-table>

    @* 人力资源部的表格模板 *@

    <el-table v-bind:data="tableData"
              size="small"
              v-show="renli"
              v-bind:span-method="objectSpanMethod"
              style="width: 100%;margin-top:15px;"
              max-height="550"
              border>
        <el-table-column type="index"
                         label="序号"
                         width="59"
                         v-bind:index="indexMethod">
        </el-table-column>
        <el-table-column prop="status"
                         label="部门"
                         width="120">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="班组"
                         width="120">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="项目"
                         width="120">
        </el-table-column>
        <el-table-column prop="warehousenum"
                         label="指标名称"
                         width="120">
        </el-table-column>
        <el-table-column v-bind:label=`${year}年实际完成值统计`>
            <el-table-column prop="orderSon" width="50" label="1月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="2月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="3月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="4月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="5月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="6月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="7月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="8月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="9月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="10月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="11月"></el-table-column>
            <el-table-column prop="orderSon" width="50" label="12月"></el-table-column>
        </el-table-column>
    </el-table>
    {{times}}
</div>

<script>
    function getyear(time){
        if(time !=''){
            tt = new Date(time)
            year = tt.getFullYear()
            return year
        }else{
            return ''
        }
    }

    let vm = new Vue({
        el: "#app",
        data: {
            tableData:[],
            others:false,
            xingzheng:false,
            renli:false,
            deparList: [{
                value: '装配一部',
                label: '装配一部'
            }, {
                value: '装配二部',
                label: '装配二部'
            }, {
                value: 'SMT部',
                label: 'SMT部'
            }, {
                value: '配套加工部',
                label: '配套加工部'
            }, {
                value: 'PC部&MC部',
                label: 'PC部&MC部'
            },{
                value: '品质部',
                label: '品质部'
            },{
            value: '行政后勤部',
            label: '行政后勤部'
            },{
                value: '人力资源部',
                label: '人力资源部'
            }],
            departments: '',
            times:'',
            year:""
        },
        mounted(){
            // 获取部门列表

            // 加载时触发部门选择框改变
            this.departments = '人力资源部'
        },
        watch:{
            times(){
                if(this.times !=null){
                    dates = new Date(this.times)
                    
                    this.year = getyear(this.times)
                }else{
                    this.year = ''
                }

            },
            departments(){
                if(this.departments=="人力资源部"){
                    this.renli = true;
                    this.others = false;
                    this.xingzheng = false;
                }else if(this.departments=="行政后勤部"){
                    this.renli = false;
                    this.others = false;
                    this.xingzheng = true;
                }else{
                    this.renli = false;
                    this.others = true;
                    this.xingzheng = false;
                }
            }
        },
        methods: {
            indexMethod(index) {
                return index+1;
            },
            
            objectSpanMethod({row,column,rowIndex,columnIndex}) {
                if (columnIndex === 0) {
                    
                }
                if (columnIndex === 1) {
                    
                }
                if (columnIndex === 2) {
                    //if (this.spanArrss[rowIndex]) { // [3,0,0,2,0,3,0,0]
                    //    return {
                    //        rowspan:this.spanArrss[rowIndex],
                    //        colspan:1
                    //    }
                    //} else {
                    //    return {
                    //        rowspan:0,
                    //        colspan:0
                    //    }
                    //}
                }
            }
        }
    })
</script>

@*<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Department)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DP_Group)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Project)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.IndexName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Target)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Actual_completion)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DepartmentData)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CreateDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Creator)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Year)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Month)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Department)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DP_Group)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Project)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IndexName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Target)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Actual_completion)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DepartmentData)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CreateDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Creator)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Year)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Month)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
            @Html.ActionLink("Details", "Details", new { id=item.Id }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.Id })
        </td>
    </tr>
}

</table>*@
