
@{
    ViewBag.Title = "printTest";
    Layout = null;
}
<script src="~/Scripts/vue.js"></script>
<script src="~/Scripts/jquery-1.11.3.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/printJS/JsBarcode.all.min.js"></script>
<script src="~/Scripts/printJS/LodopFuncs.js"></script>
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<style>
    * {
        margin: 0;
        padding: 0;
    }

    .printhide {
        margin-top: 50px;
        padding: 20px 0;
    }

    body {
        padding: 0;
    }

    .mo {
        font-size: 80px;
        line-height: 70px;
    }

    .printContent {
        width: 420px;
        height: 200px;
        margin: 0 auto;
    }
    .form-control{
        max-width:280px;
    }
</style>


<div id="app" class="text-center container body-content">
    <div class="printhide">
        模组：<input v-model.trim="printMo" class="form-control" style="display:inline-block;text-transform:uppercase" /><br />
        条码：<input v-model.trim="printVal" onKeyUp="value = value.replace(/[^A-Za-z0-9]/g, '')" class="form-control" style="display:inline-block;text-transform:uppercase" /><br />
        <button v-on:click="print" class="btn btn-primary">打印pdf</button>
    </div>
    <div class="printContent text-center">
        <b class="mo">{{printMo}}</b><br />
        <svg id="barcode"></svg>
        @*<canvas id="barcode"></canvas>
            <img id="barcode" />*@
    </div>

    @*<object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
            <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0></embed>
        </object>

        <a href="javascript:bai_print1()">打印预览1</a>
        <a href="javascript:bai_print2()">打印预览2</a>
        <a href="javascript:bai_print3()">打印预览3</a>
        <a href="javascript:bai_print4()">打印预览4</a>

        <div id="printcontent" style="display: none;">
            <img border="0" src="aaa-png.png">
        </div>*@
</div>
<script>
    var app = new Vue({
        el: "#app",
        data: {
            printVal: "",
            printMo: "",
        },
        watch: {
            printVal: (val) => {
                if (val != "") {
                    JsBarcode("#barcode", val.toUpperCase(), {
                        format: "code128",
                        lineColor: "#000",
                    });
                } else {
                    $(".printContent").html('<svg id="barcode"></svg>');
                };
            },
            printMo: (val) => {
            }
        },
        mounted: function () {

        },
        methods: {
            print: () => {
                $(".printhide").hide();
                window.print();
                $(".printhide").show();
                //LODOP.SET_PRINT_PAGESIZE(2, 0, 0, "A4");//设置为A4纸 // 表格表头（循环）
                //LODOP.SET_PRINT_STYLE("FontSize", 12); LODOP.SET_PRINT_STYLE("Bold", 1);
                //LODOP.ADD_PRINT_TEXT("8mm", "10mm", "50mm", "10mm", "领料人：" + "x");
                //LODOP.SET_PRINT_STYLE("FontSize", 15); LODOP.SET_PRINT_STYLE("Bold", 1);
                //LODOP.ADD_PRINT_TEXT("5mm", "120mm", "100mm", "20mm", "通用部件领用单"); //top left width high // 表格数据
                //LODOP.SET_PRINT_STYLE("Bold", 0); LODOP.ADD_PRINT_TABLE("16mm", "8mm", "280mm", "160mm", $("#printContent").html()); LODOP.SET_SHOW_MODE("LANDSCAPE_DEFROTATED", 2);//横向打印预览正向显示
                //LODOP.PREVIEW();//预览 //
                //LODOP.PRINT();//打印 //----------------------结束打印-------------------
            }
        }
    });


    ////定义一个变量
    //var lodop;
    ////程序加载有个加载过程，进页面立即初始化的话，会提示未加载完成
    //setTimeout(Init, 500);
    //function Init() {
    //    //需要打印的内容
    //    var html = "";
    //    //初始化变量 str1 str2默认不填 ，是注册正版时的验证账号密码
    //    lodop = getLodop(str1, str2);
    //    //设置打印页面大小，这里3表示纵向打印且纸高“按内容的高度”；48表示纸宽48mm；20表示页底空白2.0mm
    //    lodop.SET_PRINT_PAGESIZE(3, 48, 20, "");
    //    //设置打印页面内容  10为上边距 0为左边距 100%为宽度 ""为高度，发现不填也没事，html是打印内容
    //    lodop.ADD_PRINT_HTM(10, 0, "100%", "", html);
    //}

    ////执行lodop_print()即可直接打印
    //function lodop_print() {
    //    //打印操作
    //    lodop.PRINT();
    //}
</script>

<script language="javascript" type="text/javascript">
    var LODOP; //声明为全局变量
    function bai_print1() {
        LODOP = getLodop();
        LODOP.PRINT_INIT("打印常用证明1");
        LODOP.ADD_PRINT_HTM(0, 0, "100%", "100%", document.getElementById("printcontent").innerHTML);
        //LODOP.PREVIEW();
        LODOP.PRINT();
    };
    function bai_print2() {
        var LODOP = getLodop();
        LODOP.PRINT_INIT("打印常用证明2");
        var strHTML = "<body style='margin:0;background-color: white'>" + document.getElementById("printcontent").innerHTML + "</body>";
        LODOP.ADD_PRINT_HTM("0mm", 0, "RightMargin:0.1cm", "BottomMargin:1mm", strHTML);
        LODOP.PREVIEW();
    };
    function bai_print3() {
        LODOP = getLodop();
        LODOP.PRINT_INIT("打印常用证明3");
        LODOP.ADD_PRINT_IMAGE(0, 0, "100%", "100%", document.getElementById("printcontent").innerHTML);
        LODOP.SET_PRINT_STYLEA(0, "Stretch", 2);//按原图比例(不变形)缩放模式
        LODOP.PREVIEW();
    };
    function bai_print4() {
        LODOP = getLodop();
        LODOP.PRINT_INIT("打印常用证明3");
        LODOP.ADD_PRINT_IMAGE(0, 0, "100%", "100%", document.getElementById("printcontent").innerHTML);
        LODOP.SET_PRINT_STYLEA(0, "Stretch", 2);//按原图比例(不变形)缩放模式
        LODOP.SET_PRINT_COPIES(5);
        //LODOP.PREVIEW();
        LODOP.PRINT();
    };
</script>