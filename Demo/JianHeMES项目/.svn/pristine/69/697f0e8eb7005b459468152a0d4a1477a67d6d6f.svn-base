using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Web.Http;

namespace JianHeMES.Controllers
{
    public class CRM_QueryController : ApiController
    {
        [HttpPost]
        public string OrderInfo(string parameter)
        {
            //var prepare = JsonConvert.DeserializeObject(parameter);//字符串转成json
            //建立本地存储表
            //1.按订单读本地存储记录，检查记录存储时间，如果订单号为空，则返回生产管控看板JSON文件的记录；
            //2.有订单号，如果存储时间到现在>5分钟，按订单查询（写一个独立的查询方法），本地存储一份查询结果，返回查询结果； 
            //3.有订单号，如果存储时间到现在 <5分钟，如果本地存储有记录，则返回取本地存储记录，如果没有，按订单查询，本地存储一份查询结果，返回查询结果；
            string result = "MES接收到的内容是：" + parameter ;

            return result;
        }

        [HttpPost]
        [Authorize]
        public string OrderInfo2(string parameter)
        {
            //var prepare = JsonConvert.DeserializeObject(parameter);//字符串转成json

            string result = "MES接收到的内容是：" + parameter;

            return result;
        }

        // GET: api/CRM_Query
        public IEnumerable<string> Get()
        {
            return new string[] { "value1", "value2" };
        }

        // GET: api/CRM_Query/5
        public string Get(int id)
        {
            return "value";
        }

        // POST: api/CRM_Query
        public void Post([FromBody]string value)
        {
        }

        // PUT: api/CRM_Query/5
        public void Put(int id, [FromBody]string value)
        {
        }

        // DELETE: api/CRM_Query/5
        public void Delete(int id)
        {
        }
    }
}
