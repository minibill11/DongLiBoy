@model IEnumerable<JianHeMES.Models.Small_Sample>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/styleFile/packaging/index.css" rel="stylesheet" />
<script src="~/Content/styleFile/packaging/index.js"></script>
<script src="~/Scripts/axios.min.js"></script>
<style>
    .searchContainer{
        /*display:flex;
        justify-content:space-around;*/
        text-align:center;
    }
    .el-input{
        width:209px !important;
    }
</style>
<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

<div id="app">
    <div class="searchContainer">
        <el-input placeholder="请输入内容"
                  v-model="customerName"
                  size="small"
                  clearable>
        </el-input>
        <el-select v-model="orderNum" size="small" filterable clearable placeholder="请选择">
            <el-option v-for="item in options"
                       v-bind:key="item.value"
                       v-bind:label="item.label"
                       v-bind:value="item.value">
            </el-option>
        </el-select>
        <el-input placeholder="请输入内容"
                  size="small"
                  v-model="mo1"
                  clearable>
        </el-input>
        <el-input placeholder="请输入内容"
                  size="small"
                  v-model="mo2"
                  clearable>
        </el-input>
        <el-button id="searchinfos" size="small" type="success" v-on:click="searchInfos">查询</el-button>
    </div>
    <div class="bottomContainer">
        <el-table v-bind:data="tableData"
                  style="width: 100%">
            <el-table-column prop="date"
                             label="日期"
                             width="180">
            </el-table-column>
            <el-table-column prop="name"
                             label="姓名"
                             width="180">
            </el-table-column>
            <el-table-column prop="address"
                             label="地址">
            </el-table-column>
        </el-table>
    </div>
</div>

<script>
    let app = new Vue({
        el: "#app",
        data: {
            customerName: null,
            mo1: null,
            mo2: null,
            orderNum: null,
            options: [],
            tableData: [{
                date: '2016-05-02',
                name: '王小虎',
                address: '上海市普陀区金沙江路 1518 弄'
            }, {
                date: '2016-05-04',
                name: '王小虎',
                address: '上海市普陀区金沙江路 1517 弄'
            }, {
                date: '2016-05-01',
                name: '王小虎',
                address: '上海市普陀区金沙江路 1519 弄'
            }, {
                date: '2016-05-03',
                name: '王小虎',
                address: '上海市普陀区金沙江路 1516 弄'
            }]
        }, methods: {
            searchInfos() {
                
                if (this.customerName != null || this.orderNum != null || this.mo1 != null || this.mo2 != null) {
                    axios.post("/Small_Sample/Index", { customer: this.customerName, ordernum: this.orderNum, mo1: this.mo1, mo2: this.mo2 }).then(res=> {
                        console.log(res.data)
                    }).catch(err=> {
                        this.$message({
                            message: "连接失败",
                            type: "warning"
                        })
                    })
                } else {
                    this.$message({
                        message: "请输入需要查询的内容",
                        type: "warning"
                    });
                }
            },
            getOrderList() {
                axios.post("/Commonality/GetOrderNumListJSON").then(res=> {
                    for (let item in res.data) {
                        let obj = { label: res.data[item], value: res.data[item] }
                        this.options.push(obj)
                    }
                }).catch(err=> {
                    alert("clicked!")
                    this.$message({
                        message: "连接失败",
                        type: "warning"
                    })
                })
            }
        },
        mounted() {
            this.getOrderList();
        }
    });
    document.onkeydown = function (event) {
        var e = event || window.event;    // 兼容IE
        if (e && e.keyCode == 13) { //回车键的键值为13
            $("#searchinfos").click();
        }
    };
</script>

