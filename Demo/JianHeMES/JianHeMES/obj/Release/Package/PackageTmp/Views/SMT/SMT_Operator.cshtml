
@{
    ViewBag.Title = "SMT_Operator";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>SMT_Operator</h2>


<!DOCTYPE html>
<style>
    /** {
        background-color: dodgerblue;
        color: white;
    }*/

    html, body, .SMT {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    .SMTLineTitle {
        width: 100%;
        height: 20%;
    }

        .SMTLineTitle > div {
            float: left;
            width: 33.3%;
            height: 100%;
        }

    .Line, .Line > span {
        color: yellow;
        font-size: 80px;
        margin: 30px 0 0 0;
        text-align: center;
    }

    .lineInfo {
        height: 80px;
        width: 200px;
        margin-left: 200px;
        margin-top: 100px;
        z-index: -1;
    }

    .SMTContent {
        border-top: 2px solid red;
        width: 100%;
        height: 79%;
    }

    .leftContent {
        float: left;
        border-right: 2px solid red;
        width: 39%;
        height: 100%;
    }

        .leftContent > ul {
            margin: 10% 10%;
            list-style: none;
        }

            .leftContent > ul > li {
                line-height: 45px;
                font-size: 20px;
            }

    .rightContent {
        float: left;
        width: 60%;
        height: 100%;
    }

        .rightContent > div {
            margin: 5% 10%;
        }

    .colorG {
        color: #31ec31;
    }

    .colorR {
        color: red;
    }

    .colorY {
        color: yellow;
    }
</style>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>SMT</title>
</head>
<body>
    <div id="app" class="SMT container">
        <div class="SMTLineTitle form-group">
            <div></div>
            <div><p class="Line">SMT-<span>1</span>线</p></div>
            <div>
                <div class="lineInfo">
                    <p>日期：2018-9-27</p>
                    <p>班组：白班   组长：张三</p>
                </div>
            </div>
        </div>
        <div class="SMTContent form-group">
            <div class="leftContent">
                <ul>
                    <li>今天计划生产订单：</li>
                    <li>2018-YA363-1   1000个   LY   中国</li>
                    <li>2018-YA363-1   1000个   LY   中国</li>
                    <li>2018-YA363-1   1000个   LY   中国</li>
                    <li>2018-YA363-1   1000个   LY   中国</li>
                </ul>
            </div>
            <div class="rightContent">
                <div>
                    <h1 class="colorG">正在生产订单：<span>2018-YA363-1</span></h1>
                    <h1 class="colorY">今天生产数量汇总：50个</h1>
                    <h3 class="colorG">合格品：47个</h3>
                    <p class="colorR">不良品：3个</p>
                    <p class="colorR">不良率：5.45%</p>
                    <p>订单累计生产数量：234个</p>
                    <p>订单完成率：23.40%</p>
                    <br />
                    <p>产线状态：<span class="colorR">待料中。。。</span></p>
                </div>
            </div>
        </div>
    </div>
    <script>
        var app = new Vue({
            el: "#app",
            data: {

            },
            methods: {

            },
            watch: {

            },
            computed: {

            }
        })
    </script>
</body>
</html>




@{
    ViewBag.Title = "SMT生产操作员";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .table > tbody > tr > th, .table > tbody > tr > td {
        text-align: center;
        vertical-align: middle;
    }

        .rowTitle1 > th:nth-child(-n+4), .rowTitle2 > th:nth-child(-n+2), .table > tbody > tr > td:nth-child(-n+5) {
            border: 1px solid red;
        }

        .rowTitle1 > th:nth-child(n+5), .rowTitle2 > th:nth-child(n+3), .table > tbody > tr > td:nth-child(n+6) {
            border: 1px solid blue;
        }

        .rowTitle1 > th:nth-child(4), .rowTitle2 > th:nth-child(2), .table > tbody > tr > td:nth-child(5) {
            border-right: 1px solid blue;
        }

        .table > tbody > tr > td:nth-child(n+7), .table > tbody > tr > td:nth-child(1) {
            cursor: pointer;
        }

    .table > tbody > tr:nth-child(n+3):hover {
        background-color: rgba(77, 72, 72, 0.15);
    }
</style>
<h2 class="text-center">SMT生产操作员 </h2>

<br />
<div id="app" class="form-group">
    <table class="table table-bordered">
        <colgroup>
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
            <col width="80 ">
        </colgroup>
        <tr class="rowTitle1">
            <th rowspan="2">订单号</th>
            <th rowspan="2">订单数量</th>
            <th rowspan="2">平台型号</th>
            <th colspan="2">生产排期</th>
            <th rowspan="2">实际开始生产时间</th>
            <th colspan="2">组装工序</th>
            <th colspan="2">调试老化</th>
            <th colspan="2">校正</th>
            <th colspan="2">包装</th>
        </tr>
        <tr class="rowTitle2">
            <th>起始日期</th>
            <th>出货时间</th>
            <th>完成率</th>
            <th>合格率</th>
            <th>完成率</th>
            <th>合格率</th>
            <th>完成率</th>
            <th>合格率</th>
            <th>完成率</th>
            <th>合格率</th>
        </tr>
        <tr v-for="(item, index) in marqueeList">
            <td v-on:click="orderDetail(item.OrderNum,item.Id)">{{item.OrderNum}}</td>
            <td>{{item.Quantity}}个</td>
            <td>{{item.PlatformType}}</td>
            <td>{{item.PlanInputTime.split(" ")[0]}}</td>
            <td>{{item.PlanCompleteTime.split(" ")[0]}}</td>
            <td>{{item.ActualProductionTime}}</td>
            <td v-on:click="Detail(item.OrderNum,'Assemble')">{{item.Assemble_Finish_Rate}}<span v-show="item.AssembleRecord_Count"><br />({{item.Assemble_Finish}}/{{item.Quantity}})</span> </td>
            <td v-on:click="Detail(item.OrderNum,'Assemble')">{{item.Assemble_Pass_Rate}}<span v-show="item.AssembleRecord_Count"><br />({{item.Assemble_Finish}}/{{item.AssembleRecord_Count}})</span></td>
            <td v-on:click="Detail(item.OrderNum,'Burn_in')">{{item.Burn_in_Finish_Rate}}<span v-show="item.Burn_in_Count"><br />({{item.Burn_in_Finish}}/{{item.Quantity}})</span></td>
            <td v-on:click="Detail(item.OrderNum,'Burn_in')">{{item.Burn_in_Pass_Rate}}<span v-show="item.Burn_in_Count"><br />({{item.Burn_in_Finish}}/{{item.Burn_in_Count}})</span></td>
            <td v-on:click="Detail(item.OrderNum,'Calibration')">{{item.Calibration_Finish_Rate}}<span v-show="item.Calibration_Count"><br />({{item.Calibration_Finish}}/{{item.Quantity}})</span></td>
            <td v-on:click="Detail(item.OrderNum,'Calibration')">{{item.Calibration_Pass_Rate}}<span v-show="item.Calibration_Count"><br />({{item.Calibration_Finish}}/{{item.Calibration_Count}})</span></td>
            <td v-on:click="Detail(item.OrderNum,'Appearance')">{{item.Appearances_Finish_Rate}}<span v-show="item.Appearances_Count"><br />({{item.Appearances_Finish}}/{{item.Quantity}})</span></td>
            <td v-on:click="Detail(item.OrderNum,'Appearance')">{{item.Appearances_Pass_Rate}}<span v-show="item.Appearances_Count"><br />({{item.Appearances_Finish}}/{{item.Appearances_Count}})</span></td>
        </tr>
    </table>
</div>
<div id="setForm"></div>

<script>
    var app = new Vue({
        el: "#app",
        data: {
            //animate: false,
            marqueeList: []
        },
        created: function () {
            //setInterval(this.showMarquee, 5000)
        },
        methods: {
            Detail: function (val, station) {
                this.$options.methods.postForm("/ProductionControl/" + station, val);
                //$.ajax({
                //    type: 'post',
                //    url: "/ProductionControl/" + station,
                //    data: {
                //        OrderNum: val
                //    },
                //    success: function (data) {
                //        console.log(data);
                //    },
                //    error: function (XMLHttpRequest, textStatus, errorThrown) {
                //        console.log("POST失败")
                //    }
                //});
            },
            orderDetail: function (val, station) {
                this.$options.methods.postForm("/OrderMgms/Details/" + station, val);
            },
            postForm: function (url, params) {
                var newForm = $("<form action=" + url + " target='_blank' method='post' style='display:none' ><input name='OrderNum' value=" + params + " ></form>");
                $("#setForm").append(newForm);
                newForm.submit();
                newForm.remove();
            }
            //showMarquee: function () {
            //    this.animate = true;
            //    setTimeout(() => {
            //        this.marqueeList.push(this.marqueeList[0]);
            //        this.marqueeList.shift();
            //        this.animate = false;
            //    }, 1000);
            //}
        }
    })
</script>

@section scripts {
    <script src="~/Scripts/jquery-1.11.3.js"></script>
    <script src="~/Scripts/jquery.signalR-2.3.0.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <script>
        $(function () {
            var mypush = $.connection.SMT;
            mypush.client.sendSMT_Operator = function (SMT_Operator) {
                console.log(SMT_Operator)
                app.marqueeList = [];
                console.log(Object.keys(SMT_Operator).length)
                for (index in SMT_Operator) {
                    app.marqueeList.push({
                        Id: SMT[index].Id,
                        OrderNum: SMT[index].OrderNum,
                        Quantity: SMT[index].Quantity,
                        PlatformType: SMT[index].PlatformType,
                        PlanInputTime: SMT[index].PlanInputTime,
                        PlanCompleteTime: SMT[index].PlanCompleteTime,
                        ActualProductionTime: SMT[index].ActualProductionTime,
                        Assemble_Finish_Rate: SMT[index].Assemble_Finish_Rate,
                        Assemble_Pass_Rate: SMT[index].Assemble_Pass_Rate,
                        Burn_in_Finish_Rate: SMT[index].Burn_in_Finish_Rate,
                        Burn_in_Pass_Rate: SMT[index].Burn_in_Pass_Rate,
                        Calibration_Finish_Rate: SMT[index].Calibration_Finish_Rate,
                        Calibration_Pass_Rate: SMT[index].Calibration_Pass_Rate,
                        Appearances_Finish_Rate: SMT[index].Appearances_Finish_Rate,
                        Appearances_Pass_Rate: SMT[index].Appearances_Pass_Rate,
                        Assemble_Finish: SMT[index].Assemble_Finish,
                        AssembleRecord_Count: SMT[index].AssembleRecord_Count,
                        Burn_in_Finish: SMT[index].Burn_in_Finish,
                        Burn_in_Count: SMT[index].Burn_in_Count,
                        Calibration_Finish: SMT[index].Calibration_Finish,
                        Calibration_Count: SMT[index].Calibration_Count,
                        Appearances_Finish: SMT[index].Appearances_Finish,
                        Appearances_Count: SMT[index].Appearances_Count
                    });
                }
            };
            //启动
            $.connection.hub.start();
        });

    </script>
}
