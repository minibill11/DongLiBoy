
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>PutOutData</title>
</head>
<body>
    <div>

        @using (Html.BeginForm("THExportToExcel", "ClassBirthInfoes", FormMethod.Post, new { id = "searchForm", @class = "text-center" }))
        {
            //@Html.AntiForgeryToken()
            <form asp-controller="ClassBirthInfo" asp-action="Index" method="post" class="text-center">
                <p class="text-center">
                    班级: @Html.DropDownList("ClassName", ViewBag.ClassNameList as IEnumerable<SelectListItem>)
                    <input type="hidden" id="PageIndex" name="PageIndex" value="0" />
                    &nbsp; &nbsp; &nbsp;<input type="submit" id="searchButton" value="导出数据为Excel文件" />
                </p>
            </form>
            <br />
        }


    </div>
</body>
</html>
@section scripts {
    <script>
        function submitForm(pagenumber) {
            pagenumber = parseInt(pagenumber, 10);
            $('#PageIndex').val(pagenumber - 1);
            $('#searchForm').submit();
        }

        $(function () {

            $('#searchButton').click(function () {
                submitForm($('#pagebar .currentpagenumber').text());
            });

            $('#pagebar .pagenumber').click(function () {
                submitForm($(this).text());
            });

        });
    </script>
}
