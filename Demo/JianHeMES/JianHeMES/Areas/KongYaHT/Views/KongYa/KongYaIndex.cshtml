@{
    ViewBag.Title = "空压机房运行状况";
    Layout = "~/Views/Shared/_Layout.cshtml";

}
<style>
    .modal-dialog{
        left:0;
    }
    #word,#word2,#word3,#word4,#word5,#word6,#word7,#word8,#word13,#word14{
        position: absolute;
        width:100px;
    }
        #box {
            position: absolute;
            margin: 130px;
            padding: 50px;
            height: 800px;
            top: -90px;
        }
        fieldset {
            position: absolute;
            margin: auto;
            width: 160px;
            top: 315px;
            left: 375px;
        }
        #word {
            top: 180px;
            left: -130px;
        }
        #word2 {
            top: 345px;
            left: -130px;
        }
        #word3 {
            top: 515px;
            left: -130px;
        }

        #word4 {
            top: 130px;
            left: 80px;
        }

        #word5 {
            top: 355px;
            left: 80px;
        }

        #word6 {
            top: 558px;
            left: 80px;
        }

        #word7 {
            top: 530px;
            left: 370px;
        }

        #word8 {
            top: 135px;
            left: 410px;
        }
        #word13 {
            top: 235px;
            left: 875px;
        }
        #word14 {
            top: 380px;
            left: 875px;
        }
        #run1,#run2,#run3{
            width: 30px;
            text-align:center;
            font-size: 11px; 
            padding: 2px;
        }
        font{
            color:red;
            position: absolute;
        }
        #box input{
            position: absolute;
            border:1px;
            height:20px;
            padding:0;
            right: 0px;
            color:#000000;
        }
</style>
<h2 class="text-center" style="color:#006FBD;font-weight: bold;">@ViewBag.Title</h2>
<head>
    <meta charset="utf-8">
    <title>空压机房运行状况信息界面</title>
</head>
<body style="background-color: #9D9D9D;">
    <embed src="~/Areas/KongYaHT/image/kybg.svg">
    <div id="box" style="margin-left: 190px">
        <p id="nowtime" style="margin:0px;position: absolute;width:135px;top:70px;left:730px;"></p>
        <a href="~/KongYaHT/KongYa/KY_COMP_Charts?point=空压机1" title="点击查看空压机1详情" target="_blank">
            <div id="word">
                <font>1#空压机状态：</font><br>
                <font style="TOP:17px;">运行信息：</font>
                <input id="run1" disabled="disabled" value="#" style="top:17px;" type="text"><br>
                <font style="TOP:34px;">排气压力：</font>
                <input id="discharge" disabled="disabled" value="#" style="width:30px;TOP:34px;" type="text">
                <font style="right: -30px;TOP:34px;">Mpa</font>
                <font style="TOP:50px;">排气温度：</font>
                <input id="Temper" disabled="disabled" value="#" style="width:30px;TOP:50px;" type="text">
                <font style="right: -30px;TOP:50px;">℃</font>
                <font style="TOP:67px;">U相电流：</font>
                <input id="current_u" disabled="disabled" value="#" style="width:30px;TOP:67px;" type="text">
                <font style="right: -30px; TOP:67px;">A</font>
            </div>
        </a>
        <a href="~/KongYaHT/KongYa/KY_COMP_Charts?point=空压机2" title="点击查看空压机2详情" target="_blank">
            <div id="word2">
                <font>2#空压机状态：</font><br>
                <font style="TOP:17px;">运行信息：</font>
                <input id="run2" disabled="disabled" value="#" style="top:17px;" type="text"><br>
                <font style="TOP:34px;">排气压力：</font>
                <input id="discharge2" disabled="disabled" value="#" style="width:30px;  TOP:34px;" type="text">
                <font style="right: -30px; TOP:34px;">Mpa</font>
                <font style="TOP:50px;">排气温度：</font>
                <input id="Temper2" disabled="disabled" value="#" style="width:30px;  TOP:50px;" type="text">
                <font style="right: -30px; TOP:50px;">℃</font>
                <font style="TOP:67px;">U相电流：</font>
                <input id="current_u2" disabled="disabled" value="#" style="width:30px; TOP:67px;" type="text">
                <font style="right: -30px; TOP:67px;">A</font>
            </div>
        </a>
        <a href="~/KongYaHT/KongYa/KY_COMP_Charts?point=空压机3" title="点击查看空压机3详情" target="_blank">
            <div id="word3">
                <font style="top:25px">3#空压机状态：</font><br>
                <font style="TOP:43px;">运行信息：</font>
                <input id="run3" disabled="disabled" style="top:43px;" type="text"><br>
                <font style="TOP:63px;">排气压力：</font>
                <input id="discharge3" disabled="disabled" value="#" style="width:30px;  TOP:63px;" type="text">
                <font style="right: -30px; TOP:63px;">Mpa</font>
                <font style="TOP:80px;">排气温度：</font>
                <input id="Temper3" disabled="disabled" value="#" style="width:30px;  TOP:80px;" type="text">
                <font style="right: -30px; TOP:80px;">℃</font>
                <font style="TOP:97px;">U相电流：</font>
                <input id="current_u3" disabled="disabled" value="#" style="width:30px;  TOP:97px;" type="text">
                <font style="right: -30px; TOP:97px;">A</font>
            </div>
        </a>
        <a href="~/KongYaHT/KongYa/KY_Charts?point=气罐2" title="点击查看气罐2详情" target="_blank">
            <div id="word6">
                <font>2#气罐出口：</font><br>
                <font style="TOP:16px;">压力：</font>
                <input id="Pressure" disabled="disabled" value="#" style="width:36px; left: 38px; TOP:16px;" type="text">
                <font style="right: 0px;  TOP:14px;">Mpa</font>
                <font style="TOP:32px;">温度：</font>
                <input id="Temperature" disabled="disabled" value="#" style="width:36px; left: 38px; TOP:32px;" type="text">
                <font style="right: 10px; TOP:32px;">℃</font>
            </div>
        </a>
        <a href="~/KongYaHT/KongYa/KY_Charts?point=气罐3" title="点击查看气罐3详情" target="_blank">
            <div id="word5">
                <font>3#气罐出口：</font><br>
                <font style="TOP:16px;">压力：</font>
                <input id="Pressure2" disabled="disabled" value="#" style="width:36px; left: 38px; TOP:16px;" type="text">
                <font style="right: 0px;  TOP:14px;">Mpa</font>
                <font style="TOP:32px;">温度：</font>
                <input id="Temperature2" disabled="disabled" value="#" style="width:36px; left: 38px; TOP:32px;" type="text">
                <font style="right: 10px; TOP:32px;">℃</font>
            </div>
        </a>
        <a href="~/KongYaHT/KongYa/KY_Charts?point=气罐1" title="点击查看气罐1详情" target="_blank">
            <div id="word4">
                <font>1#气罐出口：</font><br>
                <font style="TOP:16px;">压力：</font>
                <input id="Pressure3" disabled="disabled" value="#" style="width:36px; left: 38px; TOP:15px;" type="text">
                <font style="right: 0px;  TOP:14px;">Mpa</font>
                <font style="TOP:32px;">温度：</font>
                <input id="Temperature3" disabled="disabled" value="#" style="width:36px; left: 38px; TOP:31px;" type="text">
                <font style="right: 10px; TOP:32px;">℃</font>
            </div>
        </a>
        <a href="~/KongYaHT/KongYa/KY_Charts?point=冷干机1" title="点击查看冷干机1详情" target="_blank">
            <div id="word8">
                <font>1#冷干机出口：</font><br>
                <font style="TOP:16px;">压力：</font>
                <input id="Pressure4" disabled="disabled" value="#" style="width:36px;TOP:16px;left:35px;" type="text">
                <font style="TOP:14px;left:72px;">Mpa</font>
                <font style="TOP:32px;">温度：</font>
                <input id="Temperature4" disabled="disabled" value="#" style="width:36px;TOP:33px;left:35px;" type="text">
                <font style="TOP:32px;left:72px;">℃</font>
                <font style="TOP:48px;">湿度：</font>
                <input id="Humidity4" disabled="disabled" value="#" style="width:36px;TOP:48px;left:35px;" type="text">
                <font style="TOP:48px;left:72px;">RH%</font>
            </div>
        </a>     
        <a href="~/KongYaHT/KongYa/KY_Charts?point=冷干机2" title="点击查看冷干机2详情" target="_blank">
            <div id="word7">
                <font>2#冷干机出口：</font><br>
                <font style="TOP:16px;">压力：</font>
                <input id="Pressure5" disabled="disabled" value="#" style="width:36px;TOP:17px;left:35px;" type="text">
                <font style="TOP:14px;left:72px;">Mpa</font>
                <font style="TOP:32px;">温度：</font>
                <input id="Temperature5" disabled="disabled" value="#" style="width:36px;TOP:33px;left:35px;" type="text">
                <font style="TOP:32px;left:72px;">℃</font>
                <font style="TOP:48px;">湿度：</font>
                <input id="Humidity5" disabled="disabled" value="#" style="width:36px;TOP:48px;left:35px;" type="text">
                <font style="TOP:48px;left:72px;">RH%</font>
            </div>
        </a>
                    <a href="~/KongYaHT/KongYa/KY_Charts?point=3寸气管出口" title="点击查看3寸气管出口详情" target="_blank">
                        <div id="word13">
                            <font>3寸管出口：</font><br>
                            <font style="TOP:16px;">压力：</font>
                            <input id="Pressure10" disabled="disabled" value="#" style="width:40px;TOP:17px;left:40px;" type="text">
                            <font style="TOP:14px;left:85px;">Mpa</font>
                            <font style="TOP:32px;">温度：</font>
                            <input id="Temperature10" disabled="disabled" value="#" style="width:40px;TOP:33px;left:40px;" type="text">
                            <font style="TOP:32px;left:85px;">℃</font>
                            <font style="TOP:48px;">湿度：</font>
                            <input id="Humidity10" disabled="disabled" value="#" style="width:40px;TOP:48px;left:40px;" type="text">
                            <font style="TOP:48px;left:85px;">RH%</font>
                        </div>
                    </a>
                    <a href="~/KongYaHT/KongYa/KY_Charts?point=4寸气管出口" title="点击查看4寸气管出口详情" target="_blank">
                        <div id="word14">
                            <font>4寸管出口：</font><br>
                            <font style="TOP:16px;">压力：</font>
                            <input id="Pressure12" disabled="disabled" value="#" style="width:40px; TOP:17px;left:40px;" type="text">
                            <font style="TOP:14px;left:85px;">Mpa</font>
                            <font style="TOP:32px;">温度：</font>
                            <input id="Temperature12" disabled="disabled" value="#" style="width:40px;TOP:33px;left:40px;" type="text">
                            <font style="TOP:32px;left:85px;">℃</font>
                            <font style="TOP:48px;">湿度：</font>
                            <input id="Humidity12" disabled="disabled" value="#" style="width:40px;TOP:48px;left:40px;" type="text">
                            <font style="TOP:48px;left:85px;">RH%</font>
                        </div>
                    </a>
                    <a href="~/KongYaHT/KongYa/KY_Charts?point=空压房内温湿度" title="点击查看空压房内温湿度详情" target="_blank">
                        <fieldset>
                            &nbsp;&nbsp;&nbsp;空压房温湿度信息
                            <table style="font-size: 16px; border:2px solid blue;">
                                <tbody>
                                    <tr><th style="color: blue;">&nbsp;温度&nbsp;&nbsp;:<tt id="thtem">#</tt>℃</th></tr>
                                    <tr><th style="color: blue;">&nbsp;湿度&nbsp;&nbsp;:<tt id="thhum">#</tt>RH%</th></tr>
                                </tbody>
                            </table>
                        </fieldset>
                    </a>
    </div>

    @section scripts {
        <script src="~/Scripts/jquery.signalR-2.3.0.min.js"></script>
        <script src="~/signalr/hubs"></script>
        <script>
        $(function () {
            var mypush = $.connection.myHub;
            mypush.client.sendKY = function (KY_json) {
                var aircomp1 = JSON.parse(KY_json.aircomp1);
                var aircomp2 = JSON.parse(KY_json.aircomp2);
                var aircomp3 = JSON.parse(KY_json.aircomp3);
                var airbottle1 = JSON.parse(KY_json.airbottle1);
                var airbottle2 = JSON.parse(KY_json.airbottle2);
                var airbottle3 = JSON.parse(KY_json.airbottle3);
                var dryer1 = JSON.parse(KY_json.dryer1);
                var dryer2 = JSON.parse(KY_json.dryer2);
                var headerpipe3inch = JSON.parse(KY_json.headerpipe3inch);
                var headerpipe4inch = JSON.parse(KY_json.headerpipe4inch);
                var room = JSON.parse(KY_json.room);
                //空压机1
                $("#discharge").val(aircomp1.pressure);
                $("#Temper").val(aircomp1.temperature);
                $("#current_u").val(aircomp1.current_u);
                if (aircomp1.current_u > 40) {
                    $("#run1").val("运行").css("background", "rgb(0, 250, 154)");
                } else if (aircomp1.pressure == 0 && aircomp1.temperature == 0 && aircomp1.current_u == 0) {
                    $("#run1").val("断电").css({ background: "red", color: "white" });
                } else {$("#run1").val("停机").css("background", "yellow");}
                //空压机2
                $("#discharge2").val(aircomp2.pressure);
                $("#Temper2").val(aircomp2.temperature);
                $("#current_u2").val(aircomp2.current_u);
                if (aircomp2.current_u > 40) {
                    $("#run2").val("运行").css("background", "rgb(0, 250, 154)");
                } else if (aircomp2.pressure == 0 && aircomp2.temperature == 0 && aircomp2.current_u == 0) {
                    $("#run2").val("断电").css({ background: "red",color:"white"});
                } else { $("#run2").val("停机").css("background", "yellow"); }
                //空压机3
                $("#discharge3").val(aircomp3.pressure);
                $("#Temper3").val(aircomp3.temperature);
                $("#current_u3").val(aircomp3.current_u);
                if (aircomp3.current_u > 40) {
                    $("#run3").val("运行").css("background", "rgb(0, 250, 154)");
                } else if (aircomp3.pressure == 0 && aircomp3.temperature == 0 && aircomp3.current_u == 0) {
                    $("#run3").val("断电").css({ background: "red", color: "white" });
                } else { $("#run3").val("停机").css("background", "yellow"); }
                //气罐1
                $("#Pressure3").val(airbottle1.pressure);
                $("#Temperature3").val(airbottle1.temperature);
                //气罐3
                $("#Pressure2").val(airbottle3.pressure);
                $("#Temperature2").val(airbottle3.temperature);
                //气罐2
                $("#Pressure").val(airbottle2.pressure);
                $("#Temperature").val(airbottle2.temperature);
                //冷干机1
                $("#Pressure4").val(dryer1.pressure);
                $("#Temperature4").val(dryer1.temperature);
                $("#Humidity4").val(dryer1.humidity);
                //冷干机2
                $("#Pressure5").val(dryer2.pressure);
                $("#Temperature5").val(dryer2.temperature);
                $("#Humidity5").val(dryer2.humidity);
                //3寸管出口
                $("#Pressure10").val(headerpipe3inch.pressure);
                $("#Temperature10").val(headerpipe3inch.temperature);
                $("#Humidity10").val(headerpipe3inch.humidity);
                //4寸管出口
                $("#Pressure12").val(headerpipe4inch.pressure);
                $("#Temperature12").val(headerpipe4inch.temperature);
                $("#Humidity12").val(headerpipe4inch.humidity);
                //room
                $("#thtem").html(room.temperature);
                $("#thhum").html(room.humidity);
            };
            $.connection.hub.start();

            setInterval(function () {
                $("#nowtime").text(new Date().Format("yyyy-MM-dd hh:mm:ss"));
            }, 1000);
        });
        Date.prototype.Format = function (fmt) {
            var o = {
                "M+": this.getMonth() + 1,
                "d+": this.getDate(),
                "h+": this.getHours(),
                "m+": this.getMinutes(),
                "s+": this.getSeconds(),
                "q+": Math.floor((this.getMonth() + 3) / 3),
                "S": this.getMilliseconds()
            };
            if (/(y+)/.test(fmt))
                fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt))
                    fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        }
        </script>
    }
</body>
