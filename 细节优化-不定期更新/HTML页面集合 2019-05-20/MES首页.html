<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MES首页 - 健和光电MES</title>

    <script src="MES%E9%A6%96%E9%A1%B5_files/jquery"></script>

    <script src="MES%E9%A6%96%E9%A1%B5_files/jqueryval"></script>

    
    
    
    
    <script src="MES%E9%A6%96%E9%A1%B5_files/bootstrap"></script>

    <script src="MES%E9%A6%96%E9%A1%B5_files/vue"></script>

    
    <link href="MES%E9%A6%96%E9%A1%B5_files/easyuicss.css" rel="stylesheet">

    <link href="MES%E9%A6%96%E9%A1%B5_files/css.css" rel="stylesheet">

    <style>
        .navbar-toggle {
            float: left;
            margin-left: 20px;
            margin-right: 0;
        }

        .navbar-fixed-top .navbar-collapse {
            max-height: 450px;
        }

        @media(max-width:768px) {
            .navbar-nav > li > a {
                padding-top: 6px;
                padding-bottom: 6px;
            }

            .dropdown-menu .divider {
                margin: 2px 0;
            }

            .navbar-nav .open .dropdown-menu > li > a {
                padding: 3px;
            }

            .navbar-nav .open .dropdown-menu li{
                text-align:left;
                padding:0 25px
            }
        }

        @media (min-width:768px) and (max-width: 992px) {
            .navbar .dropdownToolbarButton a {
                font-size: 13px;
                padding: 15px 10px;
            }
        }

        @media (min-width: 768px) {
            .titleul {
                width: 718px;
            }
            .navbar > .container .navbar-brand{
                margin-left:0;
            }
        }

        @media (min-width: 992px) {
            .titleul {
                width: 930px;
            }

            .loginlabel {
                text-align: right;
            }
        }

        @media (min-width: 1200px) {
            .titleul {
                width: 1000px;
            }
        }
        .navbar-nav{
            float:none;
        }
    </style>
</head>


<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <img src="MES%E9%A6%96%E9%A1%B5_files/CompanyLogo1.png" class="navbar-brand" style="padding:15px 0; ">
                <a class="navbar-brand" href="http://172.16.6.145/" style="padding:15px 5px; ">健和光电MES</a>
            </div>
            <div class="navbar-collapse collapse">
                <div class="dropdownToolbarButton">
                    <ul class="nav navbar-nav titleul">
                        



                        
                            <li><a href="http://172.16.6.145/Users">用户管理</a></li>
                        

                        
                            <li class="dropdown navbar-right">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <span class="glyphicon glyphicon-user"></span>  郑振彪
                                    <b class="caret"></b>
                                </a>

                                <ul class="dropdown-menu collapse" style="min-width: 104px;">
                                    <li>
                                        <a href="http://172.16.6.145/Users/Modifypwd/11">修改密码</a>
                                    </li>
                                    <li>
                                        <a href="http://172.16.6.145/Users/Logoff">退出</a>
                                    </li>
                                </ul>
                            </li>
                    </ul>
                    
                </div>
            </div>
        </div>
    </div>
    <div class="container body-content">
        





<script src="MES%E9%A6%96%E9%A1%B5_files/axios.js"></script>
<style type="text/css">
    * {
        margin: 0;
        padding: 0;
    }

    .divContent {
        width: 50%;
        height: 300px;
        float: left;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 15px;
    }

    #MES_Plans, #HR, #MES_Excution, #Environment {
        width: 300px;
        cursor: pointer;
    }
</style>

    <div id="app" class="container"><div class="divContent text-center"><a><img id="MES_Plans" src="MES%E9%A6%96%E9%A1%B5_files/MES_Plans.jpg" class="img-responsive center-block"></a></div> <div class="divContent text-center"><a><img id="MES_Excution" src="MES%E9%A6%96%E9%A1%B5_files/MES_Excution.jpg" class="img-responsive center-block"></a></div> <div class="divContent text-center"><a><img id="HR" src="MES%E9%A6%96%E9%A1%B5_files/HR.jpg" class="img-responsive center-block"></a></div> <div class="divContent text-center"><a><img id="Environment" src="MES%E9%A6%96%E9%A1%B5_files/Environment.jpg" class="img-responsive center-block"></a></div></div>

<script>
    var app = new Vue({
        el: "#app",
        data: {

        },
        methods: {
            skipGoing: (e, name) => {
                e.preventDefault();
                if (app.$options.methods.JudgeLoginStatus()) {
                    switch (name) {
                        case "MES_Plans":
                            app.$options.methods.JudgeLoginPermissions("MES_Plans")
                            app.$options.methods.MES_Plans();
                            break;
                        case "MES_Excution":
                            app.$options.methods.JudgeLoginPermissions("MES_Excution")
                            app.$options.methods.MES_Excution();
                            break;
                        case "HR":
                            app.$options.methods.JudgeLoginPermissions("HR")
                            app.$options.methods.HR();
                            break;
                        case "Environment":
                            app.$options.methods.JudgeLoginPermissions("Environment")
                            app.$options.methods.Environment();
                            break;
                        default:
                            return false;
                    };
                };
            },
            MES_Plans: () => {
                sessionStorage.setItem("isselect", "true");
                sessionStorage.setItem("MES_Plans", "true");
            },
            MES_Excution: () => {
                sessionStorage.setItem("isselect", "true");
                sessionStorage.setItem("MES_Excution", "true");
            },
            HR: () => {
                sessionStorage.setItem("isselect", "true");
                sessionStorage.setItem("HR", "true");
            },
            Environment: (e) => {
                sessionStorage.setItem("isselect", "true");
                sessionStorage.setItem("Environment", "true");
            },
            JudgeLoginStatus: () => {
                if ("System.Data.Entity.DynamicProxies.Users_BFD932747F7D64207E1399BC309A5F21CA1CD604C6F9AAFC746AFF3AFF35C6D7" == "") {
                    $("#login").modal();
                    return false;
                } else {
                    return true;
                };
            },
            JudgeLoginPermissions: (address) => {
                axios.get("/Home/" + address).then(res=> {
                    if (res.data == false) {
                        alert("没有查看此系统权限");
                    } else {
                        window.open(address);
                    };
                }).catch(err=> {
                    console.log(err);
                });
            },
        }
    });
</script>
        
        <footer class="footer hidden-xs hidden-sm text-center">
            <hr>
            <p align="center">© 2019 - 健和光电MES</p>
        </footer>
    </div>

    <div id="login" class="modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" data-dismiss="modal" aria-hidden="true" class="close">
                        ×
                    </button> <h3 id="myModalLabel" class="modal-title text-center">
                        登录
                    </h3></div> <div class="modal-body"><div class="form-group"><div class="col-md-3 loginlabel" style="padding: 8px;"><label for="UserNum">员工编号</label></div> <input autofocus="autofocus" id="UserNum" placeholder="请输入员工编号" type="text" value="15893" class="form-control"></div> <div class="form-group "><div class="col-md-3 loginlabel" style="padding: 8px;"><label for="PassWord">密码</label></div> <input id="PassWord" placeholder="请输入密码" type="password" class="form-control"></div> <div class="form-group"><div class="col-md-3 hidden-xs hidden-sm" style="padding: 8px;"><label></label></div> <span class="text-danger"></span></div> <div class="form-group"><input id="nowfocus" type="button" value="登录" class="btn btn-primary"> <button data-dismiss="modal" class="btn btn-danger">取消</button></div></div></div></div></div>
    <script>
        var login = new Vue({
            el: "#login",
            data: {
                UserNum: "",
                PassWord: "",
                clickAddress: "",
                loginPrompt: ""
            },
            mounted: function () {
                $("#UserNum").keypress(function (e) {
                    if (e.which == 13) {// 判断所按是否回车键
                        $("#PassWord").focus(); // 设置焦点
                        return false;// 取消默认的提交行为
                    };
                });
                $("#PassWord").keypress(function (e) {
                    if (e.keyCode == 13) {// 判断所按是否回车键
                        login.$options.methods.userlogin();
                    };
                });
                $('.dropdown').mouseover(function () {
                    $(this).addClass('open');
                }).mouseout(function () { $(this).removeClass('open'); });

                $(".checkstatus").click(function () {
                    if ("System.Data.Entity.DynamicProxies.Users_BFD932747F7D64207E1399BC309A5F21CA1CD604C6F9AAFC746AFF3AFF35C6D7" == "") {
                        login.clickAddress = $(this).attr("href");
                        $("#login").modal();
                        return false;
                    } else {
                        return true;
                    }
                });

                $('#login').on('show.bs.modal', function () {
                    login.loginPrompt = "";
                    if (login.clickAddress == "") {
                        login.clickAddress = window.location.pathname == "/Users/Login" ? "" : window.location.pathname;
                    };
                });
                $('#login').on('shown.bs.modal', function () {
                    if ($("#UserNum").val() == "") {
                        $("#UserNum").focus();
                    } else if ($("#PassWord").val() == "") {
                        $("#PassWord").focus();
                    } else {
                        $("#nowfocus").focus();
                    }
                });
                $('#login').on('hide.bs.modal', function () {
                    login.clickAddress = "";
                    login.loginPrompt = "";
                });
            },
            methods: {
                userlogin: function () {
                    login.loginPrompt = "";
                    $.ajax({
                        url: "/Users/loginCheck",
                        type: "post",
                        data: {
                            user: {
                                UserNum: login.UserNum,
                                PassWord: login.PassWord,
                            }
                        },
                        success: function (returnVal) {
                            if (returnVal == "success") {
                                window.location.href = "http://" + window.location.host + login.clickAddress;
                            } else if (returnVal == "error") {
                                login.loginPrompt = "登录失败，请检查员工编号及密码是否有误！";
                            }
                        },
                        error: function (err) {
                            alert("登录出错！");
                        }
                    });
                }
            }
        });
    </script>



<!----></body></html>