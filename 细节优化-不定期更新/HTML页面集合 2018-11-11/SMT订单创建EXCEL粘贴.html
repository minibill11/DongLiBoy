<!DOCTYPE html>
<html style="" class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients no-cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMT_订单创建 - 健和光电MES</title>
    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/jquery"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/jqueryform"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/jqueryval"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/jqueryvalAll"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/home"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/common"></script>

    <link href="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/easyui" rel="stylesheet">

    <link href="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/easyuicss.css" rel="stylesheet">

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/modernizr"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/bootstrap"></script>

    <link href="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/css.css" rel="stylesheet">

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/echarts"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/vue"></script>

    <script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/highcharts.html"></script>

</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                
                <a class="navbar-brand" href="http://localhost:18863/">健和光电MES</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            全厂温湿度
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu collapse" style="text-align: center; min-width: 114px;">
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/FirstFloor">一楼</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/ThirdFloor">三楼</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/FourthFloor">四楼</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/FifthFloor">五楼</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/Sixthfloor">六楼</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/FloorDataShow">汇总表</a></li>
                        </ul>
                    </li>
                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            空压机房
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu collapse" style="text-align: center; min-width: 114px;">
                            <li><a href="http://localhost:18863/KongYaHT/KongYa">空压机房</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/KongYaHT/KongYa/KYDataShow">汇总表</a></li>
                        </ul>
                    </li>
                    
                    <li><a href="http://localhost:18863/ProductionControl">生产管控</a></li>
                    
                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            订单
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu collapse" style="text-align: center; min-width: 114px;">
                            <li><a href="http://localhost:18863/OrderMgms">订单管理</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/BarCodes">条码管理</a></li>
                        </ul>
                    </li>

                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            装配一部
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu collapse" style="text-align: center; min-width: 114px;">
                            <li><a href="http://localhost:18863/Assembles/AssembleIndex">组装产线</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/CalibrationRecords">校正信息</a></li>
                        </ul>
                    </li>

                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            品质部
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu collapse" style="text-align: center; min-width: 114px;">
                            <li><a href="http://localhost:18863/Assembles/AssembleIndex">组装PQC</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/Burn_in">老化OQC</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/Appearances">外观包装</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/IQCReports">IQC管理</a></li>
                        </ul>
                    </li>
                    

                    

                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            SMT部
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu collapse" style="text-align: center; min-width: 114px;">
                            <li><a href="http://localhost:18863/SMT/SMT_Mangage">看板管理</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/SMT/SMT_ProductionInfo">生产信息</a></li>
                            <li class="divider"></li>
                            <li><a href="http://localhost:18863/SMT/SMT_Operator">产线操作</a></li>
                        </ul>
                    </li>
                        <li><a href="http://localhost:18863/Users">用户管理</a></li>
                </ul>

                <div class="collapse navbar-collapse">
                    <ul class="nav navbar navbar-nav navbar-right">
                        <li>

                            
                            </li><li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    郑振彪
                                    <b class="caret"></b>
                                </a>
                                <ul class="dropdown-menu collapse" style="text-align: center; min-width: 100px;">
                                    <li>
                                        <a href="http://localhost:18863/Users/Modifypwd/11">修改密码</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
<a href="http://localhost:18863/Users/Logoff">退出</a>                            </li>
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="container body-content">
            

<style>
    .table > tbody > tr > th{
        text-align:center;
        vertical-align:middle;
    }
</style>
<script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/jquery-1.js"></script>
<script src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/vue.js"></script>
<h2>SMT_订单创建</h2>

<div id="app" class="form-horizontal"><hr> <table class="table"><tbody><tr><td colspan="6" style="border-top: medium none; color: green;"><span>Excel内容粘贴在此处</span><textarea class="form-control" style="width: 130px; height: 35px; resize: none;"></textarea></td></tr></tbody></table> <table id="para_table" class="table table-bordered"><tbody><tr><th>订单号</th> <th>数量</th> <th>平台类型</th> <th>客户</th> <th>交货时间</th> <th align="center"><button type="button" onclick="emptytable()" class="btn btn-link">清空</button></th></tr> <tr class="orderNum"><td><input class="form-control" value="2018-TEST-001"></td> <td><input onkeyup="value=value.replace(/[^\d]/g,'')" class="form-control" value="1111" type="number"></td> <td><input class="form-control" value="xxx"></td> <td><input class="form-control" value="xxx"></td> <td><input class="form-control" value="2018/9/11" type="datetime"></td> <td align="center"><button type="button" onclick="emptytr(this)" class="btn btn-link">清除</button></td></tr> <tr class="orderNum"><td><input class="form-control" value="2018-Ya-02"></td> <td><input onkeyup="value=value.replace(/[^\d]/g,'')" class="form-control" value="2222" type="number"></td> <td><input class="form-control" value="sss"></td> <td><input class="form-control" value="sss"></td> <td><input class="form-control" value="2018/9/22" type="datetime"></td> <td align="center"><button type="button" onclick="deletetr(this)" class="btn btn-link">移除</button></td></tr><tr class="orderNum"><td><input class="form-control" value="2018-TEST-222"></td><td><input class="form-control" onkeyup="value=value.replace(/[^\d]/g,'')" value="3333" type="number"></td><td><input class="form-control" value="vvv"></td><td><input class="form-control" value="vvv"></td><td><input class="form-control" value="2018/9/11" type="datetime"></td><td align="center"><button type="button" class="btn btn-link" onclick="deletetr(this)">移除</button></td></tr><tr class="orderNum"><td><input class="form-control" value="2018-Ya-04"></td><td><input class="form-control" onkeyup="value=value.replace(/[^\d]/g,'')" value="4444" type="number"></td><td><input class="form-control"><p style="color:red">内容不能为空</p></td><td><input class="form-control" value="qqq"></td><td><input class="form-control" value="2018/9/11" type="datetime"></td><td align="center"><button type="button" class="btn btn-link" onclick="deletetr(this)">移除</button></td></tr><tr class="orderNum"><td><input class="form-control" value="2018-Ya-05"></td><td><input class="form-control" onkeyup="value=value.replace(/[^\d]/g,'')" value="5555" type="number"></td><td><input class="form-control" value="www"></td><td><input class="form-control" value="www"></td><td><input class="form-control" value="2018/9/11" type="datetime"></td><td align="center"><button type="button" class="btn btn-link" onclick="deletetr(this)">移除</button></td></tr><tr class="orderNum"><td><input class="form-control" value="2018-Ya-06"></td><td><input class="form-control" onkeyup="value=value.replace(/[^\d]/g,'')" value="6666" type="number"></td><td><input class="form-control" value="jjj"></td><td><input class="form-control" value="jjj"></td><td><input class="form-control" value="2018/9/11" type="datetime"></td><td align="center"><button type="button" class="btn btn-link" onclick="deletetr(this)">移除</button></td></tr></tbody></table> <table class="table"><tbody><tr><td colspan="5" style="text-align: center; border-top: medium none;"><button id="addtrdiv" onclick="addtr()" class="btn btn-primary">增加一行</button></td></tr></tbody></table> <div id="setForm"></div> <div class="form-group"><div class="col-md-12"><input value="检查订单信息" class="btn btn-default" type="button"> <input value="创建" class="btn btn-default" style="display: none;" type="button"></div></div></div>
<div>
    <a href="http://localhost:18863/SMT/SMT_OrderMangage">返回</a>
</div>

<script>
    function addtr() {
        app.okCreate = false;
        var table = $("#para_table");
        var tr = $("<tr class=\"orderNum\">" +
            "<td><input class=\"form-control\"></td>" +
            "<td><input class=\"form-control\" type=\"number\" onkeyup=\"value=value.replace(/[^\\d]/g,'')\"></td>" +
            "<td><input class=\"form-control\"></td>" +
            "<td><input class=\"form-control\"></td>" +
            "<td><input class=\"form-control\" type=\"datetime\"></td>" +
            "<td  align=\"center\"><button type=\"button\" class=\"btn btn-link\" onclick=\"deletetr(this)\">移除</button></td></tr>");
        table.append(tr);
    };
    function deletetr(tdobject) {
        app.okCreate = false;
        var td = $(tdobject);
        td.parents("tr").remove();
    };
    function emptytable() {
        app.okCreate = false;
        var tr = $(".orderNum")
        tr.each(function (index, val) {
            $(val).children("td").each(function (i, v) {
                v.firstChild.value = "";
            })
        });
    };
    function emptytr(tdobject) {
        app.okCreate = false;
        var td = $(tdobject);
        td.parents("tr").children("td").each(function (index, val) {
            val.firstChild.value = "";
        })
    };
</script>
<script type="text/javascript">
    var app = new Vue({ //创建Vue对象实例
        el: "#app", //挂载DOM元素的ID
        data: {
            recordsArray: [],
            recordsJson: {},
            okNum: 0,
            emptyNum: 0,
            pasteExcel: "",
            okCreate: false
        },
        methods: {
            checkPost: function (event) {
                //event.preventDefault();
                app.recordsArray = [];
                app.recordsJson = {};
                app.okNum = 0;
                app.emptyNum = 0;
                app.okCreate = false;
                $(".orderNum").each(function (index, val) {
                    if (val.children[0].firstChild.value != ""
                        || val.children[1].firstChild.value != ""
                        || val.children[2].firstChild.value != ""
                        || val.children[3].firstChild.value != ""
                        || val.children[4].firstChild.value != "") {
                        if (val.children[0].firstChild.value != ""
                        && val.children[1].firstChild.value != ""
                        && val.children[2].firstChild.value != ""
                        && val.children[3].firstChild.value != ""
                        && val.children[4].firstChild.value != "") {
                            app.recordsJson['OrderNum'] = val.children[0].firstChild.value;
                            app.recordsJson['Quantity'] = val.children[1].firstChild.value;
                            app.recordsJson['PlatformType'] = val.children[2].firstChild.value;
                            app.recordsJson['Customer'] = val.children[3].firstChild.value;
                            app.recordsJson['DeliveryDate'] = val.children[4].firstChild.value;
                            //app.recordsJson['Status'] = val.children[5].firstChild.checked;
                            app.recordsArray.push(app.recordsJson);
                            app.recordsJson = {};
                            $(val.children).each(function (i, v) {
                                $(v.firstChild).next().remove("p");
                            });
                            app.okNum++;
                        } else {
                            $(val.children).each(function (i, v) {
                                $(v.firstChild).next().remove("p");
                                if (v.firstChild.value == "" && v.firstChild.type != "button") {
                                    $(v).append($("<p style=\"color:red\">内容不能为空</p>"));
                                }
                            });
                        };
                    } else {
                        app.emptyNum++;
                        $(val.children).each(function (i, v) {
                            $(v.firstChild).next().remove("p");
                        });
                    };
                });
                if (($(".orderNum").length - app.emptyNum) == app.okNum && app.okNum != 0) {
                    //alert("ok");
                    //console.log(app.recordsArray)
                    $.ajax({
                        type: 'post',
                        url: "/SMT/SMT_OrderInfoCheck/",
                        data: {
                            records: JSON.stringify(app.recordsArray)
                        },
                        success: function (data) {
                            returnData = JSON.parse(data);
                            console.log(returnData);
                            var i = 0;
                            for (var val in returnData) {
                                if (returnData[val] == "订单已存在") {
                                    $(".orderNum").each(function (index) {
                                        if ($(".orderNum")[index].firstChild.firstChild.value == val) {
                                            $($(".orderNum")[index].firstChild).append($("<p class=\"unqualified\" style=\"color:red\">此订单已存在</p>"));
                                        };
                                    });
                                };
                                i++;
                            };
                            if ($(".unqualified").length == 0) {
                                app.okCreate = true;
                            };
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            alert("POST失败")
                        }
                    });
                };
            },
            createPost: function (event) { //提交post内容
                this.$options.methods.postForm("/SMT/SMT_OrderInfoCreate", JSON.stringify(app.recordsArray));
            },
            postForm: function (url, params) {
                var newForm = $("<form action=" + url + " method='post' style='display:none' ><input name='records' value=" + params + " ></form>");
                $("#setForm").append(newForm);
                newForm.submit();
                newForm.remove();
            }
        },
        computed: {

        },
        watch: {
            pasteExcel: function (val) {
                if (val == "") {
                    return false;
                };
                app.okCreate = false;
                var pasteQuantity = val.split("\n");
                pasteQuantity.pop();
                pasteQuantity.forEach(function (value, index) {
                    var cutPasteQuantity = value.split("\t")
                    pasteQuantity[index] = cutPasteQuantity;
                    //console.log(cutPasteQuantity);
                });
                //console.log(pasteQuantity);
                var tableLength = $(".orderNum").length;
                var pasteLength = pasteQuantity.length;
                if (tableLength < pasteQuantity.length) {
                    for (var i = 0; i < (pasteLength - tableLength) ; i++) {
                        addtr();
                    };
                    $(".orderNum").each(function (index, val) {
                        if (index < pasteLength) {
                            val.children[0].firstChild.value = pasteQuantity[index][0];
                            val.children[1].firstChild.value = pasteQuantity[index][1];
                            val.children[2].firstChild.value = pasteQuantity[index][2];
                            val.children[3].firstChild.value = pasteQuantity[index][3];
                            val.children[4].firstChild.value = pasteQuantity[index][4];
                        };
                    });
                } else {
                    emptytable();
                    $(".orderNum").each(function (index, val) {
                        if (index < pasteLength) {
                            val.children[0].firstChild.value = pasteQuantity[index][0];
                            val.children[1].firstChild.value = pasteQuantity[index][1];
                            val.children[2].firstChild.value = pasteQuantity[index][2];
                            val.children[3].firstChild.value = pasteQuantity[index][3];
                            val.children[4].firstChild.value = pasteQuantity[index][4];
                        };
                    });
                };
                app.pasteExcel = "";
            }
        }
    });
</script>
            
            <hr>
            <footer>
                <p align="center">© 2018 - 健和光电MES</p>
            </footer>
        </div>

    
<!-- Visual Studio Browser Link -->
<script type="application/json" id="__browserLink_initializationData">
    {"appName":"Firefox","requestId":"582cb8355c8f47ae85410cbe04a71f59"}
</script>
<script type="text/javascript" src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/browserLink" async="async"></script>
<!-- End Browser Link -->



<div id="translate-man-app" class="content-3WfBL_0" style="background-color: rgb(255, 255, 255); display: none;"><div data-v-ea0bd11e="" class="outputBox-qe9A4_0"><div data-v-ea0bd11e="" class="outputBox-3oESn_0"><span data-v-ea0bd11e="" class="outputBox-13Ovx_0"></span><!----></div><div data-v-ea0bd11e="" class="outputBox-1GLb__0"><!----><div data-v-ea0bd11e="" class="outputBox-onVZH_0"><img src="SMT%E8%AE%A2%E5%8D%95%E5%88%9B%E5%BB%BAEXCEL%E7%B2%98%E8%B4%B4_files/sound.svg" class="icon-tprjJ_0"></div></div><div data-v-ea0bd11e="" class="outputBox-2sJgr_0"></div><div data-v-ea0bd11e="" class="outputBox-17RAm_0" style="display: none;"><!----><!----><!----><div data-v-ea0bd11e=""></div></div></div></div></body></html>